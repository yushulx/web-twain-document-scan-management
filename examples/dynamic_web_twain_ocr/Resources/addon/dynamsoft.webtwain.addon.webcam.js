/*! 20251201182703
* Dynamsoft JavaScript Library
* Product: Dynamic Web TWAIN
* Web Site: https://www.dynamsoft.com
*
* Copyright 2025, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: Webcam
* Version: 19.3
* 
*/
var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{},Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(e){Dynamsoft.aryAddonReadyFun.push(e)},Dynamsoft.WebcamVerForActiveX="15.0.0.0625",Dynamsoft.WebcamVerInName="19.2.0.0826",function(){for(var e=[Dynamsoft.DWT],t=0;t<1;t++){var n=e[t];n.EnumDWT_VideoRotateMode={VRM_NONE:0,VRM_90_DEGREES_CLOCKWISE:1,VRM_180_DEGREES_CLOCKWISE:2,VRM_270_DEGREES_CLOCKWISE:3,VRM_FLIP_VERTICAL:4,VRM_FLIP_HORIZONTAL:5},n.EnumDWT_VideoProperty={VP_BRIGHTNESS:0,VP_CONTRAST:1,VP_HUE:2,VP_SATURATION:3,VP_SHARPNESS:4,VP_GAMMA:5,VP_COLORENABLE:6,VP_WHITEBALANCE:7,VP_BACKLIGHTCOMPENSATION:8,VP_GAIN:9},n.EnumDWT_CameraControlProperty={CCP_PAN:0,CCP_TILT:1,CCP_ROLL:2,CCP_ZOOM:3,CCP_EXPOSURE:4,CCP_IRIS:5,CCP_FOCUS:6}}}(),function(){Dynamsoft.Lib.WebcamErrors={InvalidParameter:function(e){e._errorCode=-10001,e._errorString="The parameter is invalid."},VideoNotPlayingWhenCapture:function(e){e._errorCode=-10002,e._errorString="To capture an image, the video must be playing."},VideoNotPlayingWhenGetURL:function(e){e._errorCode=-10003,e._errorString="To get the url for the current frame, the video must be playing."},Success:function(e){e._errorCode=0,e._errorString="Successful."}}}(),function(n){function t(e){var t=this;t._Count=0,t._resultlist=[],t._stwain=e}t.prototype.GetCount=function(){return n.WebcamErrors.Success(this._stwain),this._Count-1},t.prototype.Get=function(e){var t=this;return t._resultlist.length-1<=e||e<0?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(t._stwain,"Get"),""):(n.WebcamErrors.Success(t._stwain),t._resultlist[e])},t.prototype.GetCurrent=function(){var e=this,t=e._resultlist.length;return 0==t?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,"GetCurrent"),""):(n.WebcamErrors.Success(e._stwain),e._resultlist[t-1])},n.NewWebcamValue=function(e){return new t(e)}}(Dynamsoft.Lib),function(t){function n(e){var t=this;t._Count=0,t._resultlist=[],t._stwain=e}n.prototype.GetValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),""):(t.WebcamErrors.Success(e._stwain),e._resultlist[0].current)},n.prototype.GetIfAuto=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),!1):(t.WebcamErrors.Success(e._stwain),"true"==e._resultlist[0].auto)},t.NewWebcamSetting=function(e){return new n(e)}}(Dynamsoft.Lib),function(e){function t(e){var t=this;t._Count=0,t._resultlist=[],t._stwain=e}t.prototype.GetMinValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),""):e._resultlist[0].min},t.prototype.GetMaxValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),""):e._resultlist[0].max},t.prototype.GetSteppingDelta=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),0):e._resultlist[0].step},t.prototype.GetDefaultValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),0):e._resultlist[0].defaultValue},t.prototype.GetIfAuto=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),!1):"true"==e._resultlist[0].auto},e.NewWebcamMoreSetting=function(e){return new t(e)}}(Dynamsoft.Lib),Dynamsoft.AddonReady(function(r,e){r.DynamicLoadAddonFuns&&r.DynamicLoadAddonFuns.push(function(n){n._innerSetWebcamValue=function(e){var t=r.NewWebcamValue(n);return e&&r.isArray(e)&&(t._resultlist=e,t._Count=e.length),t},n._innerSetWebcamSetting=function(e){var t=r.NewWebcamSetting(n);return e&&r.isArray(e)&&(t._resultlist=e,t._Count=e.length),t},n._innerSetWebcamMoreSetting=function(e){var t=r.NewWebcamMoreSetting(n);return e&&r.isArray(e)&&(t._resultlist=e,t._Count=e.length),t}}),r.Addon_Events.push("OnFrameCaptured"),r.Addon_Events.push("OnCaptureSuccess"),r.Addon_Events.push("OnCaptureError"),r.Addon_Events.push("OnVideoStopped")}),Dynamsoft.AddonReady(function(n,e){n.product.bHTML5Edition&&n.DynamicLoadAddonFuns&&n.DynamicLoadAddonFuns.push(function(m){var e,s=n.html5.Funs,t=n.env.bMac?"DynamicWebcam_"+Dynamsoft.WebcamVerInName+".dylib":n.env.bLinux?"DynamicWebcam_"+Dynamsoft.WebcamVerInName+".so":m._b64bit?"DynamicWebcamx64_"+Dynamsoft.WebcamVerInName+".dll":"DynamicWebcam_"+Dynamsoft.WebcamVerInName+".dll";try{m._innerSend("GetAddOnVersion",s.makeParams("webcam",t),!0,!1,!1)}catch(e){}m.__frameCapturedId=-1,(e=m)._innerWebcamValueFunction=function(e,t){e=this._innerFunRaw(e,t,!1,!1);return this._innerSetWebcamValue(e)},e._innerWebcamSettingFunction=function(e,t){e=this._innerFunRaw(e,t,!1,!1);return this._innerSetWebcamSetting(e)},e._innerWebcamMoreSettingFunction=function(e,t){e=this._innerFunRaw(e,t,!1,!1);return this._innerSetWebcamMoreSetting(e)},e._OnCaptureSuccess=function(e){Dynamsoft.Lib.isFunction(this.__OnCaptureSuccess)&&this.__OnCaptureSuccess()},e._OnCaptureError=function(e){var t=e[1],e=e[2];Dynamsoft.Lib.isFunction(this.__OnCaptureError)&&this.__OnCaptureError(t,e)},e._OnFrameCaptured=function(e){var t=this,n=t.__videoQuality,r=!1,n=n||60;t.__videoDest&&Dynamsoft.Lib.isFunction(t.__videoDest.GetIfShowVideoContainer)&&t.__videoDest.GetIfShowVideoContainer()&&(Dynamsoft.navInfoSync.bIE||!e||e&&e.length<=1||e&&1<e.length&&t.__frameCapturedId!=e[1])&&(e&&1<e.length&&t.__frameCapturedId!=e[1]&&(r=t.__frameCapturedId!=e[1]),t.__frameCapturedId=e[1],t._videoSrc=t.GetImageURL(-1,-1,-1,0,n),Dynamsoft.Lib.isFunction(t.__videoDest.UpdateVideoContainer))&&t.__videoDest.UpdateVideoContainer(t._videoSrc),Dynamsoft.Lib.isFunction(t.__OnFrameCaptured)&&setTimeout(function(){Dynamsoft.Lib.isFunction(t.__OnFrameCaptured)&&t.__OnFrameCaptured(r,e)},200)},e._OnVideoStopped=function(e){var t=e[1],e=e[2];Dynamsoft.Lib.isFunction(this.__OnVideoStopped)&&this.__OnVideoStopped(t,e)},e={Webcam:{IsModuleInstalled:function(){var e=m;return e._resetErr(),""!=e._innerFun("GetAddOnVersion",s.makeParams("webcam",t))},GetSourceList:function(){var e,t=m;return t._resetErr(),n.License.checkProductKey(t,{Webcam:!0},!0)?(e=t._innerFunRaw("GetWebcamSourceList"),0==t.ErrorCode&&e&&1<e.length&&e.splice(e.length-1,1),e):[]},SelectSource:function(e){var t=m;return t._resetErr(),!!n.License.checkProductKey(t,{Webcam:!0},!0)&&(t.__videoDest&&this._isPlaying()&&""!=t._videoSrc&&Dynamsoft.Lib.isFunction(t.__videoDest.UpdateVideoContainer)&&t.__videoDest.UpdateVideoContainer(t._videoSrc),t._innerFun("SelectWebcam",s.makeParams(e)))},CloseSource:function(){var e=m;return e._resetErr(),this._clear(),e._innerFun("StopCapture")},GetFramePartURL:function(){var e=m;return e._resetErr(),this._isPlaying()?e.GetImageURL(-1,-1,-1,!0,e.__videoQuality):(n.WebcamErrors.VideoNotPlayingWhenGetURL(e),"")},GetFrameURL:function(){var e=m;return e._resetErr(),this._isPlaying()?e.GetImageURL(-1,-1,-1,0,e.__videoQuality):(n.WebcamErrors.VideoNotPlayingWhenGetURL(e),"")},PlayVideo:function(e,t,n,r,i){function o(){return Dynamsoft.Lib.isFunction(i)&&i(m._errorCode,m._errorString),!1}var a=m,u=60;return Dynamsoft.DWT.UseDefaultViewer?e?Dynamsoft.Lib.isFunction(e.ShowVideoContainer)&&Dynamsoft.Lib.isFunction(e.UpdateVideoContainer)&&Dynamsoft.Lib.isFunction(e.GetIfShowVideoContainer)?Dynamsoft.Lib.License.checkProductKey(m,{Webcam:!0},!0)?(a._resetErr(),a.__videoDest=e,m.__videoQuality=t?u=(u=+t)<1?60:u:u,Dynamsoft.Lib.isFunction(a.__videoDest.ShowVideoContainer)&&a.__videoDest.ShowVideoContainer(!0),Dynamsoft.Lib.isFunction(n)&&(m.__OnFrameCaptured=n),m._innerSend("PlayVideo",s.makeParams("play",u),!0,r,o),!0):o():(Dynamsoft.Lib.Errors.ParameterNotDWTObject(m),o()):(Dynamsoft.Lib.Errors.ParameterCannotEmpty(m),o()):(Dynamsoft.Lib.Errors.CannotDoWhenNoViewerJS(m),!1)},PauseVideo:function(e,t){return m._resetErr(),m._innerSend("PlayVideo",s.makeParams("pause"),!0,e,function(){return Dynamsoft.Lib.isFunction(t)&&t(m._errorCode,m._errorString),!1}),!0},_clear:function(){var e=m;e.__OnFrameCaptured=!1,e.__videoQuality=60,e.__videoDest&&Dynamsoft.Lib.isFunction(e.__videoDest.UpdateVideoContainer)&&Dynamsoft.Lib.isFunction(e.__videoDest.ShowVideoContainer)&&(e.__videoDest.UpdateVideoContainer("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAANSURBVBhXY/j///9/AAn7A/0FQ0XKAAAAAElFTkSuQmCC"),e._videoSrc="",e.__videoDest.ShowVideoContainer(!1))},_isPlaying:function(){var e=m;return!(!e.__videoDest||!Dynamsoft.Lib.isFunction(e.__videoDest.GetIfShowVideoContainer))&&e.__videoDest.GetIfShowVideoContainer()},StopVideo:function(){var e=m,t=(e._resetErr(),this._clear(),e._innerFun("PlayVideo",s.makeParams("stop"))),n=e._errorCode,r=e._errorString;return e._innerFun("StopCapture"),e._errorCode=n,e._errorString=r,t},CaptureImage:function(e,t){var n=m;if(n._resetErr(),!Dynamsoft.Lib.License.checkProductKey(n,{Webcam:!0},!0))return Dynamsoft.Lib.isFunction(t)&&t(n._errorCode,n._errorString),!1;function r(){s.hideMask(i),Dynamsoft.Lib.isFunction(t)&&t(n._errorCode,n._errorString)}var i="CaptureImage";s.showMask(i),n.__OnCaptureError=r,n._innerSend(i,s.makeParams(!1),!0,function(){s.hideMask(),0==n.ErrorCode?(s.hideMask(i),Dynamsoft.Lib.isFunction(e)&&setTimeout(e,0),Dynamsoft.Lib.License.isLTS()&&Dynamsoft.DWT.lcvrf(m)):r(n.ErrorCode,n.ErrorString)},r)},GetMediaType:function(){var e=m;return e._resetErr(),e._innerWebcamValueFunction("GetMediaType")},SetMediaType:function(e){var t=m;return t._resetErr(),n.isString(e)?t._innerFun("SetMediaType",s.makeParams(e)):(n.Errors.InvalidValue(t),!1)},GetResolution:function(){var e=m,e=(e._resetErr(),e._innerWebcamValueFunction("GetResolution"));if(e&&e._resultlist){var t,n,r=e._resultlist,i=[],o=[];for(""==(n=0<r.length?r[r.length-1]:n)&&0<r.length&&(n=r[0]),t=0;t<r.length-1;t++){for(var a,u=(a=r[t]).toLowerCase().split("x"),s=(_=c=s=void 0,{value:a,p1:parseInt(u[0]),p2:parseInt(u[1])}),c=i,_=c.length-1;0<=_&&c[_].p1>=s.p1&&!(c[_].p1==s.p1&&c[_].p2<s.p2);)c[_+1]=c[_],_--;c[_+1]=s}for(t=0;t<i.length;t++)a=i[t].value,o.push(a);n&&o.push(n),e._resultlist=o,o=i=null}return e},SetResolution:function(e){var t=m;return t._resetErr(),n.isNumber(e)||n.isString(e)?t._innerFun("SetResolution",s.makeParams(e)):(n.Errors.InvalidValue(t),!1)},GetFrameRate:function(){var e=m;return e._resetErr(),e._innerWebcamValueFunction("GetFrameRate")},SetFrameRate:function(e){var t=m;return t._resetErr(),n.isNumber(e)?m._innerFun("SetFrameRate",s.makeParams(e)):(n.Errors.InvalidValue(t),!1)},GetVideoPropertySetting:function(e){var t=m;return t._resetErr(),t._innerWebcamSettingFunction("GetWebcamVideoPropertySetting",s.makeParams(e))},GetVideoPropertyMoreSetting:function(e){var t=m;return t._resetErr(),t._innerWebcamMoreSettingFunction("GetWebcamVideoPropertyMoreSetting",s.makeParams(e))},SetVideoPropertySetting:function(e,t,n){var r=m;return r._resetErr(),r._innerFun("SetWebcamVideoPropertySetting",s.makeParams(e,t,n))},SetVideoRotateMode:function(e){var t=m;return t._resetErr(),t._innerFun("SetVideoRotateMode",s.makeParams(e))},GetCameraControlPropertySetting:function(e){var t=m;return t._resetErr(),t._innerWebcamSettingFunction("GetWebcamCameraControlSetting",s.makeParams(e))},GetCameraControlPropertyMoreSetting:function(e){var t=m;return t._resetErr(),t._innerWebcamMoreSettingFunction("GetWebcamCameraControlMoreSetting",s.makeParams(e))},SetCameraControlPropertySetting:function(e,t,n){var r=m;return r._resetErr(),r._innerFun("SetWebcamCameraControlPropertySetting",s.makeParams(e,t,n))}}},m.__addon=m.__addon||{},n.mix(m.__addon,e)})}),Dynamsoft.AddonReady(function(l,e){var n;l.product.bActiveXEdition&&l.DynamicLoadAddonFuns&&l.DynamicLoadAddonFuns.push(function(m){var d,e,t;if(!m.getSWebTwain()||!m.getSWebTwain().Addon)return!1;Dynamsoft.navInfoSync.bWin&&(t=!Dynamsoft.navInfo.bOSx64||Dynamsoft.navInfo.bWOW64,n=t?"DynamicWebcam_"+Dynamsoft.WebcamVerForActiveX+".dll":"DynamicWebcamx64_"+Dynamsoft.WebcamVerForActiveX+".dll"),d=m.getSWebTwain();try{d.GetAddOnVersion("webcam",n)}catch(e){}(t=m)._innerRead=function(e){var t;try{t=Dynamsoft.Lib.parse(e)}catch(e){}return t.result},t._innerWebcamValueFunctionPlugin=function(e){e=this._innerRead(e);return this._innerSetWebcamValue(e)},t._innerWebcamSettingFunctionPlugin=function(e){e=this._innerRead(e);return this._innerSetWebcamSetting(e)},t._innerWebcamMoreSettingFunctionPlugin=function(e){e=this._innerRead(e);return this._innerSetWebcamMoreSetting(e)},e={Webcam:{IsModuleInstalled:function(){var e=d.GetAddOnVersion("webcam",n);return l.setErrorString(m),""!=e},GetSourceList:function(){var e,t;return l.License.checkProductKey(m,{Webcam:!0},!0)?(e=d.GetWebcamSourceList(),t=[],l.setErrorString(m),0==m._errorCode&&(t=m._innerRead(e))&&1<t.length&&t.splice(t.length-1,1),t):[]},SelectSource:function(e){return!!l.License.checkProductKey(m,{Webcam:!0},!0)&&(e=d.SelectWebcam(e),l.setErrorString(m),e)},CloseSource:function(){m._playVideoDWT=null;var e=d.StopCapture();return l.setErrorString(m),e},GetFramePartURL:function(){var e;return this._isPlaying()?(e=d.GetDIB(-1),l.setErrorString(m),e):(l.WebcamErrors.VideoNotPlayingWhenGetURL(m),"")},GetFrameURL:function(){return""},PlayVideo:function(e,t,n,r,i){function o(){return m._playVideoDWT=null,Dynamsoft.Lib.isFunction(i)&&i(m.ErrorCode,m.ErrorString),!1}var a;return e&&e.getSWebTwain()?l.License.checkProductKey(m,{Webcam:!0},!0)?(a=e.getSWebTwain().CurrentHWND)?(m._playVideoDWT=e,setTimeout(function(){var e=d.RunWebcamCmd("PlayVideo",a,null,null,n);l.wrapperRet(m,e,r,o)},0),!0):(l.WebcamErrors.InvalidParameter(m),o()):o():(Dynamsoft.Lib.WebcamErrors.InvalidParameter(m),o())},PauseVideo:function(){return!0},StopVideo:function(){m._playVideoDWT=null;var e=d.RunWebcamCmd("StopVideo",0,null,null,null);return l.setErrorString(m),d.StopCapture(),e},CaptureImage:function(e,t){function n(){return Dynamsoft.Lib.isFunction(t)&&t(m.ErrorCode,m.ErrorString),!1}var r;return l.License.checkProductKey(m,{Webcam:!0},!0)?(r=d.RunWebcamCmd("Capture",0,function(){Dynamsoft.Lib.isFunction(e)&&setTimeout(e,0),l.License.isLTS()&&Dynamsoft.DWT.lcvrf(m)},n,null),l.setErrorString(m),r):n()},GetMediaType:function(){var e=m._innerWebcamValueFunctionPlugin(d.GetMediaType());return l.setErrorString(m),e},SetMediaType:function(e){return l.isString(e)?(e=d.SetMediaType(e),l.setErrorString(m),e):(l.Errors.InvalidValue(m),!1)},GetResolution:function(){var e=m._innerWebcamValueFunctionPlugin(d.GetResolution());if(l.setErrorString(m),e&&e._resultlist){var t,n,r=e._resultlist,i=[],o=[];for(0<r.length&&(n=r[r.length-1]),t=0;t<r.length-1;t++){for(var a,u=(a=r[t]).toLowerCase().split("x"),s=(_=c=s=void 0,{value:a,p1:parseInt(u[0]),p2:parseInt(u[1])}),c=i,_=c.length-1;0<=_&&c[_].p1>=s.p1&&!(c[_].p1==s.p1&&c[_].p2<s.p2);)c[_+1]=c[_],_--;c[_+1]=s}for(t=0;t<i.length;t++)a=i[t].value,o.push(a);n&&o.push(n),e._resultlist=o,o=i=null}return e},SetResolution:function(e){return l.isNumber(e)||l.isString(e)?(e=d.SetResolution(e),l.setErrorString(m),e):(l.Errors.InvalidValue(m),!1)},GetFrameRate:function(){var e=m._innerWebcamValueFunctionPlugin(d.GetFrameRate());return l.setErrorString(m),e},SetFrameRate:function(e){return l.isNumber(e)?(e=d.SetFrameRate(e),l.setErrorString(m),e):(l.Errors.InvalidValue(m),!1)},GetVideoPropertySetting:function(e){e=d.GetWebcamVideoPropertySetting(e);return l.setErrorString(m),m._innerWebcamSettingFunctionPlugin(e)},GetVideoPropertyMoreSetting:function(e){e=d.GetWebcamVideoPropertyMoreSetting(e);return l.setErrorString(m),m._innerWebcamMoreSettingFunctionPlugin(e)},SetVideoPropertySetting:function(e,t,n){e=d.SetWebcamVideoPropertySetting(e,t,n);return l.setErrorString(m),e},SetVideoRotateMode:function(e){e=d.SetVideoRotateMode(e);return l.setErrorString(m),e},GetCameraControlPropertySetting:function(e){e=d.GetWebcamCameraControlSetting(e);return l.setErrorString(m),m._innerWebcamSettingFunctionPlugin(e)},GetCameraControlPropertyMoreSetting:function(e){e=d.GetWebcamCameraControlMoreSetting(e);return l.setErrorString(m),m._innerWebcamMoreSettingFunctionPlugin(e)},SetCameraControlPropertySetting:function(e,t,n){e=d.SetWebcamCameraControlPropertySetting(e,t,n);return l.setErrorString(m),e},_isPlaying:function(){return!!m._playVideoDWT}}},m.Addon=m.Addon||{},l.mix(m.Addon,e)})});