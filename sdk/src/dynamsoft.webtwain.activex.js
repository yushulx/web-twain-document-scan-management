/*! 20240919191727 - 20230504
* Dynamsoft JavaScript Library
* Product: Dynamic Web TWAIN
* Web Site: https://www.dynamsoft.com
*
* Copyright 2024, Dynamsoft Corporation
* Author: Dynamsoft Support Team
* Version: 18.5.1
*/
!function(e){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function a(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}var u={exports:{}},c={exports:{}};!function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports["default"]=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports["default"]=e.exports}(c);var l=c.exports;!function(e){var t=l["default"];function r(){e.exports=r=function(){return o},e.exports.__esModule=!0,e.exports["default"]=e.exports;var n,o={},i=Object.prototype,a=i.hasOwnProperty,s=Object.defineProperty||function(e,t,r){e[t]=r.value},u="function"==typeof Symbol?Symbol:{},c=u.iterator||"@@iterator",l=u.asyncIterator||"@@asyncIterator",f=u.toStringTag||"@@toStringTag";function h(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(n){h=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,i=Object.create(o.prototype),a=new x(n||[]);return s(i,"_invoke",{value:P(e,r,a)}),i}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}o.wrap=d;var g="suspendedStart",m="suspendedYield",T="executing",v="completed",y={};function b(){}function S(){}function _(){}var w={};h(w,c,(function(){return this}));var I=Object.getPrototypeOf,E=I&&I(I(N([])));E&&E!==i&&a.call(E,c)&&(w=E);var C=_.prototype=b.prototype=Object.create(w);function A(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function W(e,r){function n(o,i,s,u){var c=p(e[o],e,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==t(f)&&a.call(f,"__await")?r.resolve(f.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):r.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}var o;s(this,"_invoke",{value:function(e,t){function i(){return new r((function(r,o){n(e,t,r,o)}))}return o=o?o.then(i,i):i()}})}function P(e,t,r){var o=g;return function(i,a){if(o===T)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:n,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var u=L(s,r);if(u){if(u===y)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===g)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=T;var c=p(e,t,r);if("normal"===c.type){if(o=r.done?v:m,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(o=v,r.method="throw",r.arg=c.arg)}}}function L(e,t){var r=t.method,o=e.iterator[r];if(o===n)return t.delegate=null,"throw"===r&&e.iterator["return"]&&(t.method="return",t.arg=n,L(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=p(o,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,y;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,y):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,y)}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function t(){for(;++o<e.length;)if(a.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=n,t.done=!0,t};return i.next=i}}throw new TypeError(t(e)+" is not iterable")}return S.prototype=_,s(C,"constructor",{value:_,configurable:!0}),s(_,"constructor",{value:S,configurable:!0}),S.displayName=h(_,f,"GeneratorFunction"),o.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,h(e,f,"GeneratorFunction")),e.prototype=Object.create(C),e},o.awrap=function(e){return{__await:e}},A(W.prototype),h(W.prototype,l,(function(){return this})),o.AsyncIterator=W,o.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var a=new W(d(e,t,r,n),i);return o.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(C),h(C,f,"Generator"),h(C,c,(function(){return this})),h(C,"toString",(function(){return"[object Generator]"})),o.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function o(){for(;r.length;){var e=r.pop();if(e in t)return o.value=e,o.done=!1,o}return o.done=!0,o}},o.values=N,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,o){return s.type="throw",s.arg=e,t.next=r,o&&(t.method="next",t.arg=n),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=a.call(i,"catchLoc"),c=a.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),y}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:N(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),y}},o}e.exports=r,e.exports.__esModule=!0,e.exports["default"]=e.exports}(u);var f=(0,u.exports)(),h=f;try{regeneratorRuntime=f}catch(mu){"object"===("undefined"==typeof globalThis?"undefined":t(globalThis))?globalThis.regeneratorRuntime=f:Function("r","regeneratorRuntime = r")(f)}var d,p,g=s(h);function m(e){var t=e?new Date(e):new Date,r="yyyy-MM-dd HH:mm:ss.SSSZ",n={"M+":t.getUTCMonth()+1,"d+":t.getUTCDate(),"H+":t.getUTCHours(),"h+":t.getUTCHours()%12||12,"m+":t.getUTCMinutes(),"s+":t.getUTCSeconds(),"q+":Math.floor((t.getUTCMonth()+3)/3),"S+":t.getUTCMilliseconds()};for(var o in/(y+)/.test(r)&&(r=r.replace(RegExp.$1,(t.getUTCFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+o+")").test(r)&&(r=r.replace(RegExp.$1,1==RegExp.$1.length?n[o]:("000"+n[o]).substr(("000"+n[o]).length-RegExp.$1.length)));return r}function T(e){return e===p}function v(e){return e!==p}function y(e){return null===e}d="object"===("undefined"==typeof window?"undefined":n(window))?window:{};var b={"[object Function]":"function","[object AsyncFunction]":"function","[object String]":"string","[object Object]":"object","[object Boolean]":"boolean","[object Number]":"number","[object Array]":"array"};function S(e){return y(e)||T(e)?String(e):b[{}.toString.call(e)]||"object"}function _(e){return"function"===S(e)}function w(e){return"string"===S(e)}function I(e){return"object"===S(e)}function E(e){return"boolean"===S(e)}function C(e){return"number"===S(e)}function A(e){return Array.isArray?Array.isArray(e):"array"===S(e)}function W(e){if(null==e)return[];if(A(e))return e;var t=n(e.length),r=n(e);if("number"!==t||e.alert||"string"===r||"function"===r&&(!("item"in e)||"number"!==t))return[e];for(var o=[],i=0,a=e.length;i<a;i++)o[i]=e[i];return o}var P,L,D={debug:!1,showConsoleError:!1};function O(){return P}function x(e){P=e}function N(e,t,r,n){if(D.debug&&L&&_(L.log)){var o=m((new Date).getTime()),i=W(arguments);L.log(["[",o,"] ",i].join(""))}}function R(e,t,r,n){if((D.debug||D.showConsoleError)&&L&&_(L.error)){var o=m((new Date).getTime()),i=W(arguments);L.error(["[",o,"] ",i].join(""))}}function k(e,t,r,n){if(D.debug&&L&&_(L.warn)){var o=m((new Date).getTime()),i=W(arguments);L.warn(["[",o,"] ",i].join(""))}}function F(e,t,r,n){if(D.debug&&L&&_(L.info)){var o=m((new Date).getTime()),i=W(arguments);L.info(["[",o,"] ",i].join(""))}}d&&v(d.console)&&(_((L=d.console).log)&&_(L.error)?P={log:N,error:R,info:F,warn:k,debug:function(e,t,r,n){if(D.debug&&L&&_(L.debug)){var o=m((new Date).getTime()),i=W(arguments);L.debug(["[",o,"] ",i].join(""))}}}:(L=!1,P=!1));var M={queue:[],doNextStarted:!1,timer:null,pushToDo:function(e,t,r){M.queue.push({obj:e,method:t,args:r})},doNext:function(){if(M.doNextStarted)if(0!=M.queue.length){var e=M.queue[0],t=e.obj,r=e.method,n=e.args;if(M.queue.splice(0,1),t&&_(t[r])){var o=!1;if(n.length>2){var i=n[n.length-2],a=n[n.length-1];_(i)&&_(a)&&(n[n.length-2]=function(){try{i.apply(t,arguments)}catch(e){}M.timer=setTimeout(M.doNext,0)},n[n.length-1]=function(){try{a.apply(t,arguments)}catch(e){}M.timer=setTimeout(M.doNext,0)},o=!0)}try{t[r].apply(t,n)}catch(s){}o||(M.timer=setTimeout(M.doNext,0))}else if(null===t&&_(r)){try{r.apply(null,n)}catch(u){}M.timer=setTimeout(M.doNext,0)}else N("not invoke a function: "+r),M.timer=setTimeout(M.doNext,0)}else M.stop();else M.stop()},start:function(){M.doNextStarted||(M.doNextStarted=!0,M.timer=setTimeout(M.doNext,0))},stop:function(){clearTimeout(M.timer),M.timer=null,M.doNextStarted=!1,M.queue=[]}},G=!0,B=!1;function U(e,t,r){if(e){var n,o,i,a=0,s=e.length;if(r=r||null,T(s)||_(e))for(i=Object.keys(e);a<i.length&&(n=i[a],t.call(r,e[n],n,e)!==B);a++);else for(o=e[0];a<s&&t.call(r,o,a,e)!==B;o=e[++a]);}return e}var j,H={fire:function(e){var t,r=this;r.exec=r.exec||{},e=e.toLowerCase(),t=Array.prototype.slice.call(arguments,1),U(r.exec[e]||[],(function(e){var n=e.f,o=e.c||r;try{n.apply(o,t)}catch(i){N(i)}}))},on:function(e,t,r){var n=this;n.exec=n.exec||{},e=e.toLowerCase(),n.exec[e]=n.exec[e]||[],n.exec[e].push({f:t,c:r})},off:function(e,t,r){var n=this.exec;if(n)if(e)if(e=e.toLowerCase(),t)for(var o=n[e]||[],i=o.length-1;i>=0;i--)o[i]===t&&o.splice(i,1);else n[e]=null;else this.exec=null}},V="";var K,X,Y,J,z=navigator,q=!0;if("userAgentData"in z){var Q=z.userAgentData,Z=[];Q.platform&&""!=Q.platform&&("brands"in Q&&Array.isArray(Q.brands)&&Q.brands.length>0?Z=Q.brands:"uaList"in Q&&Array.isArray(Q.uaList)&&Q.uaList.length>0&&(Z=Q.uaList),Z.length>0&&(q=!1,X=Q.platform.toLowerCase(),K=function(e,t,r){var n,o,i,a,s,u,c,l,f,h=!1,d=!1,p=!1,g=e.mobile,m=!1,T=V,v=navigator.maxTouchPoints||0;for(o=t.length,n=0;n<o;n++){var y=t[n].brand.toLowerCase();if(y.indexOf("chrome")>=0){p=!0,T=t[n].version;break}if(y.indexOf("edge")>=0){h=!0,T=t[n].version;break}if(y.indexOf("opera")>=0){d=!0,T=t[n].version;break}}return p||h||d||(p=!0,T="100"),i=/windows/g.test(r),a=/mac/g.test(r),s=/linux/g.test(r),u=/android/g.test(r),c=/harmony/g.test(r),l=/(chromeos|chrome\sos)/g.test(r),f=/iphone/g.test(r),i||u||s||f||(m=/macintel/g.test(r)&&v>1),(u||c||f||m)&&(g=!0),{bUseUserAgent:!1,bWin:i,bMac:a,bLinux:s,bAndroid:u,bHarmonyOS:c,bChromeOS:l,bIE:!1,bEdge:h,bUC:!1,bPlaybook:!1,bBlackBerry:!1,bHuaWeiBrowser:!1,bOpera:d,bFirefox:!1,bChrome:p,bJSDom:!1,biPhone:f,biPad:m,bPad:u&&!e.mobile,bSafari:!1,bMobile:g,strBrowserVersion:T,bHTML5Edition:!0,IEVersion:0,IEMode:0}}(Q,Z,X)))}q&&(Y||(Y=z.userAgent.toLowerCase()),J||(J=z.platform.toLowerCase()),K=function(e,t){var r,n=e.toLowerCase(),o=t.toLowerCase(),i=/harmonyos/g.test(n);"linux"==o&&n.indexOf("windows nt")>=0&&(o="harmonyos",i=!0);var a=!i&&/cros/.test(n),s=!i&&/android/g.test(n)||/android/g.test(o),u=/iphone/g.test(n)||/iphone/g.test(o),c=/macintosh/.test(n),l=navigator.maxTouchPoints||0,f=/ipad/g.test(n)||(c||"macintel"==o)&&l>1,h=/ucweb|ucbrowser/g.test(n),p=!h&&/nexus/g.test(n)&&/version\/[\d.]+.*safari\//g.test(n),g=/playbook/g.test(n),m=/hp-tablet/g.test(n),T=/blackberry|bb10/g.test(n),v=/symbian/g.test(n),y=/windows phone/g.test(n),b=/mobile/g.test(n),S=/arm64|aarch64/g.test(n),_=/mips64/g.test(n),w=/huaweibrowser/g.test(n),I=/jsdom/g.test(n),E=g||f||m,C=!E&&!a&&(u||p||T||v||y||s||i||b),A=!C&&!E&&!a,W=A&&/win32|win64|windows/.test(o),P=W&&/win64|x64/.test(n),L=A&&/mac68k|macppc|macintosh|macintel/.test(n),D=A&&/linux/.test(o),O="win64"==o||/wow64|x86_64|win64|x64/.test(n)||S||_,x=/wow64/g.test(n),N=B,R=/opera|opr/g.test(n),k=/360se/g.test(n),F=/maxthon/g.test(n),M=/tencenttraveler|qqbrowser/g.test(n),U=/the world/g.test(n),j=/metasr/g.test(n),H=/avant/g.test(n),K=/firefox|fxios/g.test(n),X=/gecko/g.test(n),Y=!(K||w)&&/edge\/|edga\/|edgios\/|edg\//g.test(n),J=!(T||g||h||R||Y||w||I)&&/chrome|crios/g.test(n),z=!1,q=V,Q=0,Z=0,$=V;if(W&&!Y&&!K&&!J){var ee=n.indexOf("msie "),te=n.indexOf("trident"),re=n.indexOf("rv:");z=-1!=ee||-1!=te||-1!=re}if(!(L||u||f||W||T||g||p)||h||R||Y||z||K||(r=n.match(/version\/([\d.]+).*safari\//))&&(T||g||p||(N=G,J=B),$=r[1]),Y){var ne=n.indexOf("edge/");ne>-1?ne+=5:(ne=n.indexOf("edg/"))>-1?ne+=4:(ne=n.indexOf("edga/"))>-1?ne+=5:(ne=n.indexOf("edgios/"))>-1&&(ne+=7),ne>-1&&(r=($=n.slice(ne)).indexOf(" "))>-1&&($=$.slice(0,r))}else if(K)if((r=n.indexOf("firefox/"))>-1){var oe=(r=n.slice(r+8)).indexOf(" ");oe>-1&&(r=r.slice(0,oe)),$=r,(oe=r.indexOf("."))>-1&&(r=$.slice(0,oe))}else(u||f)&&(r=n.indexOf("fxios/"))>-1&&($=r=(r=n.slice(r+6)).slice(0,r.indexOf(" ")));else if(z){var ie=n.indexOf("msie "),ae=n.indexOf("trident"),se=n.indexOf("rv:");-1!=ie?q=r=(r=n.slice(ie+5)).slice(0,r.indexOf(";")):-1!=se?q=r=(r=(r=n.slice(se+3)).slice(0,r.indexOf(";"))).slice(0,r.indexOf(")")):-1!=ae&&(q=r=(r=n.slice(ae+7)).slice(0,r.indexOf(";"))),$=r}else if(N)(r=$.indexOf("."))>-1&&(r=$.slice(0,r));else if(h)(r=n.indexOf("ucweb"))>-1?$=n.slice(r+5):(r=n.indexOf("ucbrowser/"))>-1&&(r=($=n.slice(r+10)).indexOf(" "))>-1&&($=$.slice(0,r));else if(R)(r=n.indexOf("version/"))>-1?$=n.slice(r+8):(r=n.indexOf("opr/"))>-1&&($=n.slice(r+4));else if(v)(r=n.indexOf("browserng/"))>-1&&($=n.slice(r+10));else if(y)(r=n.indexOf("iemobile/"))>-1&&($=n.slice(r+9));else if(J){var ue=n.indexOf("chrome/");ue>-1?(r=($=n.slice(ue+7)).indexOf(" "))>-1&&($=$.slice(0,r)):(ue=n.indexOf("crios/"))>-1&&(r=($=n.slice(ue+6)).indexOf(" "))>-1&&($=$.slice(0,r)),(r=$.indexOf("."))>-1&&(r=$.slice(0,r))}else if(w){var ce=n.indexOf("huaweibrowser");ce>-1&&(r=($=n.slice(ce+14)).indexOf(" "))>-1&&($=$.slice(0,r))}else if(I){var le=n.indexOf("jsdom");le>-1&&(r=($=n.slice(le+6)).indexOf(" "))>-1&&($=$.slice(0,r))}if(Y||z){var fe=window.document;fe&&fe.documentMode?Q=fe.documentMode:(Q=5,fe.compatMode&&"CSS1Compat"==fe.compatMode&&(Q=7)),z&&(Z=parseInt($))}(L||D)&&(O=!0,L&&(r=n.match(/mac os x (\d+)(_|\.)(\d+)/))&&r.length>3&&(10==r[1]&&r[3]<14||r[1]<10)&&(O=!1)),W||L||D||S||_||(C=!0);var he=!0;if(z)if(""===q||parseInt(q)>=10){var de=d.Dynamsoft;de&&de.DWT&&de.DWT.IfUseActiveXForIE10Plus&&(he=B)}else he=B;return{bUseUserAgent:!0,bWin:W,bMac:L,bLinux:D,bMobile:C,bPad:E,bChromeOS:a,bHarmonyOS:i,bArm64:S,bMips64:_,bEmbed:S||_,bAndroid:s,biPhone:u,biPad:f,bWin64:P,bWOW64:x,bOSx64:O,bIE:z,bEdge:Y,bChrome:J,bFirefox:K,bSafari:N,bOpera:R,bNexus:p,bUC:h,b360SE:k,bMaxthon:F,bTencentTraveler:M,bTheWorld:U,bMetaSr:j,bAvant:H,bHuaWeiBrowser:w,bJSDom:I,bGecko:X,bHTML5Edition:he,strBrowserVersion:$,IEVersion:Z,IEMode:Q}}(Y,J));var $=null===(j=null===document||void 0===document?void 0:document.location)||void 0===j?void 0:j.protocol;function ee(e){return K.bGecko&&"mousewheel"===e?"DOMMouseScroll":e}function te(e,t,r){var n=ee(t);e&&e.addEventListener(n,r,!1)}function re(e,t,r){var n=ee(t);e&&e.removeEventListener(n,r,!1)}function ne(e){var t=e||d.event;t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.returnValue=!1,t.cancelBubble=!0}function oe(e,t){var r=d.document.createEvent("HTMLEvents");r.initEvent(e,G,G),t.dispatchEvent&&t.dispatchEvent(r)}$||($="https:"),K.protocol=$,K.bSSL="https:"===$,K.bFileSystem="https:"!==$&&"http:"!==$;var ie,ae,se,ue,ce=d.document,le=[],fe=le.push,he=le.slice,de=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,pe=function(){ae()};function ge(e,t,r,n){var o,i,a,s=t&&t.ownerDocument,u=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==u&&9!==u&&11!==u)return r;if(!n&&((t?t.ownerDocument||t:ce)!==se&&ae(t),t=t||se,11!==u&&(a=de.exec(e))))if(o=a[1]){if(9===u){if(!(i=t.getElementById(o)))return r;if(i.id===o)return r.push(i),r}else if(s&&(i=s.getElementById(o))&&ue(t,i)&&i.id===o)return r.push(i),r}else{if(a[2])return fe.apply(r,t.getElementsByTagName(e)),r;if((o=a[3])&&t.getElementsByClassName)return fe.apply(r,t.getElementsByClassName(o)),r}return r}fe.apply(he.call(ce.childNodes),ce.childNodes),ae=ge.setDocument=function(e){var t,r=e?e.ownerDocument||e:ce;return r!==se&&9===r.nodeType&&r.documentElement?(ce!==(se=r)&&(t=se.defaultView)&&t.top!==t&&(t.addEventListener?t.addEventListener("unload",pe,!1):t.attachEvent&&t.attachEvent("onunload",pe)),ue=function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},se):se},ge.contains=function(e,t){return(e.ownerDocument||e)!==se&&ae(e),ue(e,t)},ge.error=function(e){throw new Error("Syntax error: "+e)},ie=ge.getText=function(e){var t,r="",n=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)r+=ie(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[n++];)r+=ie(t);return r},ae();var me={encodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeChars:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1]},Te={UTF16ToUTF8:function(e){for(var t,r,n=[],o=e.length,i=0;i<o;i++){var a=e.charCodeAt(i);if(a>0&&a<=127)n.push(e.charAt(i));else if(a>=128&&a<=2047)t=192|a>>6&31,r=128|63&a,n.push(String.fromCharCode(t),String.fromCharCode(r));else if(a>=2048&&a<=65535){t=224|a>>12&15,r=128|a>>6&63;var s=128|63&a;n.push(String.fromCharCode(t),String.fromCharCode(r),String.fromCharCode(s))}}return n.join("")},UTF8ToUTF16:function(e){var t,r,n,o,i=[],a=e.length;for(t=0;t<a;t++)(r=e.charCodeAt(t))>>7&255?6==(r>>5&255)?(o=(31&r)<<6|63&(n=e.charCodeAt(++t)),i.push(String.fromCharCode(o))):14==(r>>4&255)&&(o=(255&(r<<4|(n=e.charCodeAt(++t))>>2&15))<<8|((3&n)<<6|63&e.charCodeAt(++t)),i.push(String.fromCharCode(o))):i.push(e.charAt(t));return i.join("")},encode:function(e){for(var t,r,n,o=this.UTF16ToUTF8(e),i=[],a=0,s=o.length;a<s;){if(t=255&o.charCodeAt(a++),a==s){i.push(me.encodeChars.charAt(t>>2)),i.push(me.encodeChars.charAt((3&t)<<4)),i.push("==");break}if(r=o.charCodeAt(a++),a==s){i.push(me.encodeChars.charAt(t>>2)),i.push(me.encodeChars.charAt((3&t)<<4|(240&r)>>4)),i.push(me.encodeChars.charAt((15&r)<<2)),i.push("=");break}n=o.charCodeAt(a++),i.push(me.encodeChars.charAt(t>>2)),i.push(me.encodeChars.charAt((3&t)<<4|(240&r)>>4)),i.push(me.encodeChars.charAt((15&r)<<2|(192&n)>>6)),i.push(me.encodeChars.charAt(63&n))}return i.join("")},encodeArray:function(e){for(var t,r,n,o=[],i=0,a=e.length;i<a;){if(t=255&e[i++],i==a){o.push(me.encodeChars.charAt(t>>2)),o.push(me.encodeChars.charAt((3&t)<<4)),o.push("==");break}if(r=255&e[i++],i==a){o.push(me.encodeChars.charAt(t>>2)),o.push(me.encodeChars.charAt((3&t)<<4|(240&r)>>4)),o.push(me.encodeChars.charAt((15&r)<<2)),o.push("=");break}n=255&e[i++],o.push(me.encodeChars.charAt(t>>2)),o.push(me.encodeChars.charAt((3&t)<<4|(240&r)>>4)),o.push(me.encodeChars.charAt((15&r)<<2|(192&n)>>6)),o.push(me.encodeChars.charAt(63&n))}return o.join("")},decode:function(e,t){for(var r,n,o,i,a=this,s=[],u=0,c=e.length;u<c;){do{r=me.decodeChars[255&e.charCodeAt(u++)]}while(u<c&&-1==r);if(-1==r)break;do{n=me.decodeChars[255&e.charCodeAt(u++)]}while(u<c&&-1==n);if(-1==n)break;t?s.push(r<<2|(48&n)>>4):s.push(String.fromCharCode(r<<2|(48&n)>>4));do{if(61==(o=255&e.charCodeAt(u++)))return t?s:a.UTF8ToUTF16(s.join(""));o=me.decodeChars[o]}while(u<c&&-1==o);if(-1==o)break;t?s.push((15&n)<<4|(60&o)>>2):s.push(String.fromCharCode((15&n)<<4|(60&o)>>2));do{if(61==(i=255&e.charCodeAt(u++)))return t?s:a.UTF8ToUTF16(s.join(""));i=me.decodeChars[i]}while(u<c&&-1==i);if(-1==i)break;t?s.push((3&o)<<6|i):s.push(String.fromCharCode((3&o)<<6|i))}return t?s:a.UTF8ToUTF16(s.join(""))}},ve={fromUTF16:function(e){for(var t,r=[],n=0,o=e.length;n<o;)(t=e.charCodeAt(n))>=1&&t<=127?r.push(e.charAt(n)):t>2047?(r.push(String.fromCharCode(224|t>>12&15)),r.push(String.fromCharCode(128|t>>6&63)),r.push(String.fromCharCode(128|63&t))):(r.push(String.fromCharCode(192|t>>6&31)),r.push(String.fromCharCode(128|63&t))),n++;return r.join("")},toUTF16:function(e){for(var t,r,n,o=[],i=0,a=e.length;i<a;)switch((t=e.charCodeAt(i++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o.push(e.charAt(i-1));break;case 12:case 13:r=e.charCodeAt(i++),o.push(String.fromCharCode((31&t)<<6|63&r));break;case 14:r=e.charCodeAt(i++),n=e.charCodeAt(i++),o.push(String.fromCharCode((15&t)<<12|(63&r)<<6|63&n))}return o.join("")}},ye="undefined"!=typeof self?self:global,be=ye.btoa?function(e){return ye.btoa(e)}:function(e){for(var t,r,n=String(e),o=0,i=me.encodeChars,a="";n.charAt(0|o)||(i="=",o%1);a+=i.charAt(63&t>>8-o%1*8)){if((r=n.charCodeAt(o+=3/4))>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|r}return a},Se=ye.atob?function(e){return ye.atob(e)}:function(e){var t=String(e).replace(/[=]+$/,"");if(t.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,o=0,i=0,a="";n=t.charAt(i++);~n&&(r=o%4?64*r+n:n,o++%4)?a+=String.fromCharCode(255&r>>(-2*o&6)):0)n=me.encodeChars.indexOf(n);return a};function _e(e){if(null==e||"object"!=n(e))return e;var t,r,o;if(e instanceof Date)return(t=new Date).setTime(e.getTime()),t;if(e instanceof Array){for(t=[],o=e.length,r=0;r<o;r++)t[r]=_e(e[r]);return t}if(e instanceof Object){for(r in t={},e)e.hasOwnProperty(r)&&(t[r]=_e(e[r]));return t}return 0}function we(e){return Math.random().toString(16).substring(2,2+e)}function Ie(e){var t=[we(8),"-",we(4),"-",we(4),"-",we(4),"-",we(8)];return e&&t.unshift(e),t.join("")}var Ee=Date.now||function(){return+new Date},Ce=function(){return""+Ee()};function Ae(){for(var e,t=Ee()%1e4,r=[],n=0;n<5;n++)e=Math.floor(10*Math.random()),0!=n||0!=e?r.push(e):n=-1;return t<10?r.push("000"):t<100?r.push("00"):t<1e3&&r.push("0"),r.push(t),r.join("")}function We(e,t){var r;for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function Pe(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(t){i(t)}}function s(e){try{u(n["throw"](e))}catch(t){i(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;var Le=!1;"wakeLock"in navigator&&(Le=!0);var De=null;function Oe(){Le&&(null==De?function(){Pe(this,void 0,void 0,g.mark((function e(){return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.wakeLock.request("screen");case 3:De=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),De=null;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))}():De.release().then((function(){De=null})))}function xe(){return De}var Ne=Array.prototype;function Re(e,t,r){return Ne.filter.call(e,t,r||this)}function ke(e,t){return Ne.indexOf.call(t,e)}function Fe(e){var t,r,n=[],o=e.length;for(t=0;t<o;t++){for(r=t+1;r<o;r++)e[t]===e[r]&&(r=++t);n.push(e[t])}return n}var Me=/^(\/?)([\s\S]+\/(?!$)|\/)?((?:\.{1,2}$|[\s\S]+?)?(\.[^.\/]*)?)$/;function Ge(e,t){var r,n=[];for(r=0;r<e.length;r++){var o=e[r];o&&"."!==o&&(".."===o?n.length&&".."!==n[n.length-1]?n.pop():t&&n.push(".."):n.push(o))}return n}function Be(e){var t="/"===e.charAt(0),r="/"===e.slice(-1);return(e=Ge(Re(e.split("/"),(function(e){return!!e})),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e}var Ue=function(){return a((function e(){r(this,e)}),[{key:"resolve",value:function(){var e,t,r="",n=arguments,o=!1;for(e=n.length-1;e>=0&&!o;e--)w(t=n[e])&&t&&(r=t+"/"+r,o="/"===t.charAt(0));return(o?"/":"")+Ge(Re(r.split("/"),(function(e){return!!e})),!o).join("/")||"."}},{key:"join",value:function(){return Be(Re(W(arguments),(function(e){return e&&w(e)})).join("/"))}},{key:"relative",value:function(e,t){e=Be(e),t=Be(t);var r,n,o=Re(e.split("/"),(function(e){return!!e})),i=[],a=Re(t.split("/"),(function(e){return!!e})),s=Math.min(o.length,a.length);for(r=0;r<s&&o[r]===a[r];r++);for(n=r;r<o.length;)i.push(".."),r++;return(i=i.concat(a.slice(n))).join("/")}},{key:"basename",value:function(e,t){var r;return r=(e.match(Me)||[])[3]||"",t&&r&&r.slice(-1*t.length)===t&&(r=r.slice(0,-1*t.length)),r}},{key:"dirname",value:function(e){var t=e.match(Me)||[],r=t[1]||"",n=t[2]||"";return r||n?(n&&(n=n.substring(0,n.length-1)),r+n):"."}},{key:"extname",value:function(e){return(e.match(Me)||[])[4]||""}}])}(),je={}.hasOwnProperty;function He(e){if(!e||"object"!==S(e)||e.nodeType||e.window==e)return B;var t,r;try{if((r=e.constructor)&&!je(e,"constructor")&&!je(r.prototype,"isPrototypeOf"))return B}catch(n){return B}for(t in e);return T(t)||je(e,t)}var Ve="object"===("undefined"==typeof HTMLElement?"undefined":n(HTMLElement));function Ke(e){return Ve?e instanceof HTMLElement:e&&"object"===n(e)&&(1===e.nodeType||9===e.nodeType)&&"string"==typeof e.nodeName}function Xe(e){var t=e;if(Ke(e))for(;!t&&t!=document.body;)t=t.parentNode;else t=0;return!!t}function Ye(e,t){return 0===e.lastIndexOf(t,0)}function Je(e,t){var r=e.length-t.length;return r>=0&&e.indexOf(t,r)===r}function ze(e){return null==e?V:String.prototype.trim.call(e)}function qe(e){var t;if(e)for(t in e)if(!T(t))return!1;return!0}function Qe(e){return w(e)?e.replace(/[^\x20-\x7E]/g,""):e}function Ze(e,t,r){return e.replace(new RegExp(t,"gi"),r)}function $e(e){return e.charAt(0).toUpperCase()+e.substr(1)}var et,tt="none",rt={getOffset:function(e,t,r){var n,o;e=e||d.event;for(var i,a,s=r||e.target,u=0,c=0,l=0,f=0,h=!1,p=d.document;s&&!isNaN(s.offsetLeft)&&!isNaN(s.offsetTop);)a=s.scrollLeft,i=s.scrollTop,"BODY"===s.tagName?h?(a=0,i=0):(a|=null===(n=p.documentElement)||void 0===n?void 0:n.scrollLeft,i|=null===(o=p.documentElement)||void 0===o?void 0:o.scrollTop):"fixed"===s.style.position&&(h=!0),u+=s.offsetLeft-a,c+=s.offsetTop-i,s=s.offsetParent;return t&&(l=t.Left,f=t.Top),{x:u=e.clientX-u-l,y:c=e.clientY-c-f}},getElDimensions:function(e,t){var r,n;return e?(r=e.style.display,e.style.display="",n=t?{offsetTop:e.offsetTop,offsetLeft:e.offsetLeft,offsetWidth:e.offsetWidth,offsetHeight:e.offsetHeight}:{clientTop:e.clientTop,clientLeft:e.clientLeft,clientWidth:e.clientWidth?e.clientWidth:parseInt(e.style.width)?parseInt(e.style.width):0,clientHeight:e.clientHeight?e.clientHeight:parseInt(e.style.height)?parseInt(e.style.height):0},e.style.display=r,n):{offsetTop:0,offsetLeft:0,offsetWidth:0,offsetHeight:0}}};function nt(e){return document.getElementById(e)}function ot(e){var t=w(e)?nt(e):e;t&&(t.length>0&&(t=t[0]),t.style.display=tt)}function it(e){var t=w(e)?nt(e):e;t&&(t.length>0&&(t=t[0]),t.style.display=V)}function at(e){var t=w(e)?nt(e):e;t&&(t.length>0&&(t=t[0]),t.style.display===tt?t.style.display=V:t.style.display=tt)}function st(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}function ut(e){return encodeURIComponent(String(e))}function ct(e){return decodeURIComponent(e.replace(/\+/g," "))}if(window.trustedTypes){try{et=window.trustedTypes.createPolicy("d-create-script",{createScriptURL:function(e){return e}})}catch(Tu){}}function lt(e){return et?et.createScriptURL(e):e}var ft=!0,ht=document,dt=ht&&ht.documentElement,pt=ht.getElementsByTagName("head")[0]||dt,gt=ht.createElement("script").readyState?function(e,t){var r=e.onreadystatechange;e.onreadystatechange=function(){var n=e.readyState;if("loaded"===n||"complete"===n){e.onreadystatechange=null,r&&r();t.call(this,{type:"load",path:[e]})}else"loading"===n||t.call(this,{type:"error",path:[e]})}}:function(e,t){e.addEventListener("load",t,B),e.addEventListener("error",t,B)};function mt(e,t,r){return Tt(e,t,!1,r)}function Tt(e,t,r,n){var o,i,a=n;if(_(a)||(a=function(){}),w(e)&&e!=V)return o=ht.createElement("script"),i=["",e].join(V),o.src=lt(i),t&&(o.async=ft),o.charset="utf-8",gt(o,a),r?pt.appendChild(o):pt.insertBefore(o,pt.firstChild),o;a()}function vt(e,t,r){return yt(e,t,!1,r)}function yt(e,t,r,n){var o=n;if(_(o)||(o=function(){}),K.bJSDom)o("ok");else if(A(e)){var i=e.length,a=function(e){e&&"load"==e.type?i--:(e&&"error"==e.type&&R(["Failed to load resource: ",e.target.src,"."].join("")),o()),i<=0&&o("ok")};i<=0?o("ok"):U(e,(function(e){Tt(e,t,r,a)}))}else o()}function bt(e,t){return St(e,!1,t)}function St(e,t,r){var n,o=r;if(_(o)||(o=!1),w(e)&&e!=V){if(!K.bJSDom)return(n=ht.createElement("link")).href=lt(e),n.rel="stylesheet",n.async=ft,o&&gt(n,o),t?pt.appendChild(n):pt.insertBefore(n,pt.firstChild),n;o&&o()}else o&&o()}function _t(e,t){return wt(e,!1,t)}function wt(e,t,r){if(K.bJSDom)r&&r("ok");else if(A(e)){var n=e.length,o=function(e){e&&"load"==e.type&&n--,e&&"load"!=e.type&&(e&&"error"==e.type&&R(["Failed to load resource: ",e.target.href,"."].join("")),r()),n<=0&&r("ok")};U(e,(function(e){St(e,t,o)}))}else r&&r()}function It(e){var t,r;if(!K.bJSDom){var n=document;if(n&&w(r=e.body)&&r!=V){(t=n.createElement("script")).charset="utf-8",K.bIE?t.text=r:t.appendChild(n.createTextNode(r)),e.language?t.language=e.language:t.language="javascript",e.type?t.type=e.type:t.type="text/javascript";var o=n&&n.documentElement,i=n.getElementsByTagName("head")[0]||o;i.insertBefore(t,i.firstChild)}}}function Et(e){It({body:e})}function Ct(e){It({body:e,language:"vbscript",type:"text/vbscript"})}function At(e){return null!=e&&e==e.window}var Wt=new(function(){return a((function e(){r(this,e),this.nil=undefined,this.bNode=!1,this.noop=function(){},this.mix=We,this.clone=_e,this.keys=Object.keys,this.now=Ce,this.getFormatedNow=m,this.getRandom=Ae,this.guid=Ie,this.get=nt,this.show=it,this.hide=ot,this.toggle=at,this.empty=st,this.stringify=d.JSON.stringify,this.parse=d.JSON.parse,this.isDef=v,this.isUndef=T,this.isUndefined=T,this.isNull=y,this.isNaN=isNaN,this.isFunction=_,this.isString=w,this.isObject=I,this.isBoolean=E,this.isNumber=C,this.isArray=A,this.type=S,this.isPlainObject=He,this.isDOM=Ke,this.isDOMInBody=Xe,this.each=U,this.getLogger=O,this.setLogger=x,this.log=N,this.error=R,this.warn=k,this.info=F,this.filter=Re,this.indexOf=ke,this.uniq=Fe,this.startsWith=Ye,this.endsWith=Je,this.replaceAll=Ze,this.upperCaseFirst=$e,this.removeNonPrintableChar=Qe,this.trim=ze,this.makeArray=W,this.isEmptyObject=qe,this.Path=new Ue,this.DOM=rt,this.isWindow=At,this.obj={customEvent:H},this.addEventListener=te,this.removeEventListener=re,this.stopPropagation=ne,this.fireEvent=oe,this.base64=Te,this.utf8=ve,this.btoa=be,this.atob=Se,this.asyncQueue=M,this.sizzle=ge,this.toggleWakeLock=Oe,this.getWakeLock=xe,this.urlEncode=ut,this.urlDecode=ct,this.scriptOnload=gt,this.addAllCss=wt,this.getAllCss=_t,this.addCss=St,this.getCss=bt,this.addScripts=yt,this.getScripts=vt,this.addScript=Tt,this.getScript=mt,this.addJS=Et,this.addVBS=Ct}),[{key:"debug",get:function(){return D.debug},set:function(e){D.debug=e}},{key:"showConsoleError",get:function(){return D.debug},set:function(e){D.showConsoleError=e}}])}());function Pt(e){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pt(e)}var Lt,Dt,Ot=!!("object"==("undefined"==typeof global?"undefined":Pt(global))&&global.process&&global.process.release&&global.process.release.name&&"undefined"==typeof HTMLCanvasElement)?global:self||{},xt=Ot.Dynamsoft;xt?xt.Lib||(xt.Lib={}):(xt={Lib:{},DWT:{}},Ot&&(Ot.Dynamsoft=xt)),xt.navInfoSync=K,Lt=Wt.mix(xt.Lib,Wt),(Dt=xt).DWT||(Dt.DWT={}),Dt.DWT.LTS||(Dt.DWT.LTS={}),Dt.Lib.UI||(Dt.Lib.UI={}),Dt.Lib.html5||(Dt.Lib.html5={});var Nt="18",Rt="5",kt="1",Ft="".concat(Nt,",").concat(Rt,",").concat(kt,",").concat("0828"),Mt="".concat(Nt,",").concat("5",",").concat("1",",").concat("0828");function Gt(e){return Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gt(e)}function Bt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jt(n.key),n)}}function Ut(e,t,r){return(t=jt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jt(e){var t=function(e,t){if("object"!=Gt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Gt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Gt(t)?t:t+""}var Ht=function(e){return e.NONE=0,e.TRACE=1,e.DEBUG=2,e.INFO=4,e.WARN=8,e.ERROR=16,e}({}),Vt=Wt.getLogger(),Kt=function(){return e=function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)},r=[{key:"LogLevel",get:function(){return this._logLevel},set:function(e){this._logLevel=e}},{key:"LogFunc",set:function(e){this._logFunc=e}},{key:"all",value:function(e,t){if((this._logLevel&e)==e)if(this._logFunc)this._logFunc(t,e);else switch(e){case Ht.DEBUG:Vt.debug(t);break;case Ht.ERROR:Vt.error(t);break;case Ht.INFO:Vt.info(t);break;case Ht.WARN:Vt.warn(t);break;case Ht.TRACE:Vt.trace(t)}}},{key:"trace",value:function(e){this.all(Ht.TRACE,e)}},{key:"debug",value:function(e){this.all(Ht.DEBUG,e)}},{key:"info",value:function(e){this.all(Ht.INFO,e)}},{key:"warn",value:function(e){this.all(Ht.WARN,e)}},{key:"error",value:function(e){this.all(Ht.ERROR,e)}}],(t=null)&&Bt(e.prototype,t),r&&Bt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function Xt(e){var t;window.console&&(e instanceof Error||Wt.isString(e)?(t=e,xt.navInfoSync.bIE&&(t=Wt.stringify(e))):t=Wt.stringify(e),window.console.error(t))}Ut(Kt,"_logLevel",Ht.ERROR),Ut(Kt,"_logFunc",undefined);K.bAndroid&&K.bSSL;var Yt={JSVersion:Mt,ServerVersionInfo:Ft,ServerLinuxVersionInfo:Ft,ServerMacVersionInfo:Ft,ServerAndroidVersionInfo:Ft,ActiveXVersion:"18,0,0,1025",ActiveXPdfVersion:"11.5.2.0312",PdfVersion:"11.5.2.0312",PdfLinuxVersion:"11.5.2.0312",PdfMacVersion:"11.5.2.0312"},Jt=function(e){return e.enumUnknown=-1,e.enumChrome=1,e.enumFirefox=2,e.enumEdge=3,e.enumSafari=4,e.enumIE=5,e.enumOpera=6,e.enumHuaWeiBrowser=7,e}({}),zt=function(e){return e.enumUnknown=-1,e.enumWindow=0,e.enumMac=1,e.enumLinux=2,e.enumEmbed=3,e.enumChromeOS=4,e.enumHarmonyOS=5,e.enumAndroid=6,e.enumiOS=7,e}({});function qt(){var e=xt.DWT.ServiceInstallerLocation;return Wt.isString(e)&&e.length>0?("/"!=e[e.length-1]&&(e+="/"),e):(e=xt.DWT.ResourcesPath,Wt.isString(e)&&e.length>0?"/"!=e[e.length-1]&&(e+="/"):e="Resources/",e+"dist/")}var Qt={getDSPath:function(e){var t=qt(),r=e;return r||(r=K.bWin?".msi":K.bMac?".pkg":xt.navInfo.bArm64?"-arm64.deb":xt.navInfo.bMips64?"-mips64el.deb":xt.navInfo.bAndroid?".apk":K.bLinux||K.bChromeOS||K.bHarmonyOS?".deb":".msi"),[t,"DynamsoftServiceSetup",r].join("")},getLinuxHTML5DebPath:function(){return Qt.getDSPath(".deb")},getLinuxHTML5RpmPath:function(){return Qt.getDSPath(".rpm")},getEnumPlatform:function(){return K.bAndroid?zt.enumAndroid:K.bMac?zt.enumMac:K.bChromeOS?zt.enumChromeOS:K.bHarmonyOS?zt.enumHarmonyOS:xt.navInfo.bEmbed?zt.enumEmbed:K.bLinux?zt.enumLinux:K.biPhone||K.biPad?zt.enumiOS:zt.enumWindow},getEnumBrowser:function(){return K.bEdge?Jt.enumEdge:K.bChrome?Jt.enumChrome:K.bFirefox?Jt.enumFirefox:K.bIE?Jt.enumIE:K.bSafari?Jt.enumSafari:K.bHuaWeiBrowser?Jt.enumHuaWeiBrowser:K.bOpera?Jt.enumOpera:Jt.enumUnknown}},Zt=!0,$t=!1,er=K.bHTML5Edition,tr=0,rr=$t;K.bIE&&(""===(tr=K.IEVersion)||tr>=10?xt.DWT.IfUseActiveXForIE10Plus?(er=$t,rr=Zt,K.bHTML5Edition=er):er=Zt:(er=$t,tr>=9&&(rr=Zt))),rr||er||(er=Zt);var nr={name:"Dynamic Web TWAIN",bHTML5Edition:er,bActiveXEdition:rr,_iImageCaptureDriverType:3,_iBrokerProcessType:1,getChromeEditionPath:Qt.getDSPath,getPKGPath:function(){return qt()+"DynamicWebTWAINMacEdition.pkg"},getMSIPath:function(){return qt()+"DynamicWebTWAINPlugIn.msi"},getActiveXCABx86Path:function(){return qt()+"DynamicWebTWAIN.cab"},getActiveXCABx64Path:function(){return qt()+"DynamicWebTWAINx64.cab"},onlineResources:"https://demo.dynamsoft.com/DWT/Resources/",strMIMEType:"Application/DynamicWebTwain-Plugin",strFullClassID:"E7DA7F8D-27AB-4EE9-8FC0-3FEC9ECFE758",scripts:{},dwtConfigLoaded:!1,dwtConfigLoading:!1,getServerVersionInfo:function(e){var t=Yt.ServerVersionInfo;return K.bWin||(K.bMac?t=Yt.ServerMacVersionInfo:K.bAndroid?t=Yt.ServerAndroidVersionInfo:(K.bLinux||K.bChromeOS||K.bHarmonyOS)&&(t=Yt.ServerLinuxVersionInfo)),e?t:Wt.replaceAll(t,",","")},getDWTPrefix:function(){return!0===xt.DWT.CustomMode?"dwtc_":"dwt_"},loadResourcePath:!1,loadingResourcePath:!1,handshakeCode:undefined,organizationID:undefined,licenseServer:undefined,sessionPassword:"",bPublicLTS:!0,refProductKey:undefined,ltsDebug:!1,bDWTLoading:!1,bDWTUnloading:!1,bAndroidConnected:!1,unloadQueue:[],appendBrowserLicenseWhenServiceMode:function(){},bDCPChecked:!1,bDWTChecked:!1,bUseDynamsoftLicenseManager:!1,bChromeEdition:er};K.bSSL,K.bSSL;var or=!0,ir=!1;function ar(e){var t=e.toLowerCase().replace(nr.name.toLowerCase()+" ","");return(t=Wt.replaceAll(t,"[.]",",")).split(",")}var sr=!1,ur=!0;var cr=function(e){return e.TWAINSCANNER=16,e.WIASCANNER=32,e.TWAINX64SCANNER=64,e.ICASCANNER=128,e.SANESCANNER=256,e.ESCLSCANNER=512,e.WIFIDIRECTSCANNER=1024,e.WIATWAINSCANNER=2048,e}(cr||{}),lr=cr.TWAINSCANNER|cr.WIASCANNER|cr.TWAINX64SCANNER|cr.ICASCANNER|cr.SANESCANNER|cr.ESCLSCANNER|cr.WIFIDIRECTSCANNER|cr.WIATWAINSCANNER;cr.TWAINSCANNER,cr.WIASCANNER,cr.TWAINX64SCANNER,cr.ICASCANNER,cr.SANESCANNER,cr.TWAINSCANNER,cr.WIATWAINSCANNER,cr.TWAINX64SCANNER,cr.ICASCANNER,cr.SANESCANNER;var fr=cr.TWAINSCANNER|cr.WIASCANNER|cr.WIATWAINSCANNER;function hr(e){return hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hr(e)}function dr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gr(n.key),n)}}function pr(e,t,r){return t&&dr(e.prototype,t),r&&dr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gr(e){var t=function(e,t){if("object"!=hr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=hr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==hr(t)?t:t+""}cr.ESCLSCANNER,cr.WIFIDIRECTSCANNER,cr.TWAINSCANNER,cr.WIATWAINSCANNER;var mr=pr((function vu(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,vu)}));function Tr(e){return Tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tr(e)}function vr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,br(n.key),n)}}function yr(e,t,r){return t&&vr(e.prototype,t),r&&vr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function br(e){var t=function(e,t){if("object"!=Tr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Tr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Tr(t)?t:t+""}var Sr=yr((function yu(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,yu)}));function _r(e,t){var r,n=e.name,o="",i=e.deviceType;i==cr.TWAINSCANNER?r="":i==cr.TWAINX64SCANNER?r="Twain64-":i==cr.WIASCANNER?r="WIA-":i==cr.WIATWAINSCANNER?(n=Wt.replaceAll(n,"WIA-",""),r="WIATWAIN-"):r=i==cr.ICASCANNER?"ICA-":i==cr.SANESCANNER?"Sane-":i==cr.ESCLSCANNER?"eSCL-":(cr.WIFIDIRECTSCANNER,""),t&&t.attrs&&t.attrs.ty&&(o=" on ["+t.attrs.ty+"]"),e.displayName=[r,n,o].join("")}function wr(e){if(e.ProductName){var t=e.ProductName;e.ProductName=Wt.base64.decode(t)}if(e.ProductFamily){var r=e.ProductFamily;e.ProductFamily=Wt.base64.decode(r)}if(e.Manufacturer){var n=e.Manufacturer;e.Manufacturer=Wt.base64.decode(n)}if(e.Version&&e.Version.Info){var o=e.Version.Info;e.Version.Info=Wt.base64.decode(o)}}function Ir(e){var t=new Sr;return t.strDevice=Wt.stringify(e),e.deviceInfo&&(t.deviceInfo=Wt.clone(e.deviceInfo)),e.deviceType&&(t.deviceType=Wt.clone(e.deviceType)),e.displayName&&(t.displayName=Wt.clone(e.displayName)),e.name&&(t.name=Wt.clone(e.name)),e.serviceInfo&&(t.serviceInfo=function(e){var t=new mr;return t.server=e.server,t.normal=!0,e.attrs&&(t.attrs=Wt.clone(e.attrs)),t}(e.serviceInfo)),Wt.isBoolean(e.isSystemDefaultPrinter)?t.isSystemDefaultPrinter=e.isSystemDefaultPrinter:t.isSystemDefaultPrinter=!1,t}function Er(e){return Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Er(e)}function Cr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ar(n.key),n)}}function Ar(e){var t=function(e,t){if("object"!=Er(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Er(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Er(t)?t:t+""}Lt.removeNonPrintableChar;var Wr=function(){return e=function n(e,t,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var i=this;i._md5=r,i._length=t,i._content=o},(t=[{key:"getLength",value:function(){return this._length}},{key:"getMD5",value:function(){return this._md5}},{key:"getData",value:function(e,t){var r=this,n=t;return Wt.isNumber(e)&&Wt.isNumber(t)?e<0||t<=0?"":0==e&&n==r._length?r._content:(e+n>r._length&&(n=r._length-e),r._content.substr(e,n)):""}}])&&Cr(e.prototype,t),r&&Cr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();Lt.html5.Base64Result=Wr;var Pr=function(e){return e.SMF_NAME=1,e.SMF_TWAINVERSION=2,e.SMF_TWAINPROTOCOL=4,e.SMF_ICAUUID=8,e.SMF_ICAMODULEVERSION=16,e.SMF_ICALOCATIONTYPE=32,e}({});String.prototype.startsWith||(String.prototype.startsWith=function(e){return 0==this.indexOf(e)});var Lr=function(e){var t,r=e,n=r._license||"",o=JSON.parse(JSON.stringify(r._licenseServer)),i=r._sessionPassword,a=0;if(n.startsWith("t")||n.startsWith("f"))a=0;else if(0===n.length||n.startsWith("P")||n.startsWith("L")||n.startsWith("Y")||n.startsWith("A"))a=1;else{a=2;var s=n.indexOf(":");if(-1!=s&&(n=n.substring(s+1)),n.startsWith("DLS2")){var u;try{var c=n.substring(4);c=Dynamsoft.Lib.atob(c),u=JSON.parse(c)}catch(f){throw new Error("Format Error: The license string you specified is invalid, please check to make sure it is correct.")}if("number"==typeof(n=u.handshakeCode?u.handshakeCode:u.organizationID?u.organizationID:"")&&(n=JSON.stringify(n)),0===o.length){var l=[];u.mainServerURL&&(l[0]=u.mainServerURL),u.standbyServerURL&&(l[1]=u.standbyServerURL),o=function(e){if(null==e)e=[];else{e instanceof Array||(e=[e]);for(var t=0;t<e.length;++t){if(document&&document.createElement){var r=document.createElement("a");r.href=e[t],e[t]=r.href}e[t].lastIndexOf("/")!=e[t].length-1&&(e[t]+="/")}}return e}(l)}!i&&u.sessionPassword&&(i=u.sessionPassword),t=u.remark}("200001"===n||n.startsWith("200001-"))&&(o&&o.length||(n="")),n||(a=1)}return 1===a&&(n=""),{lt:a,l:n,ls:o,sp:i,rmk:t}};function Dr(e,t){return(null==e?void 0:e.port)==(null==t?void 0:t.port)&&(null==e?void 0:e.protocol)==(null==t?void 0:t.protocol)&&(null==e?void 0:e.server)==(null==t?void 0:t.server)&&(null==e?void 0:e.ssl)==(null==t?void 0:t.ssl)&&(null==e?void 0:e.useWS)==(null==t?void 0:t.useWS)}function Or(e){return Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Or(e)}function xr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fr(n.key),n)}}function Rr(e,t,r){return t&&Nr(e.prototype,t),r&&Nr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kr(e,t,r){return(t=Fr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fr(e){var t=function(e,t){if("object"!=Or(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Or(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Or(t)?t:t+""}var Mr=function(e){return e.OK=0,e.Custom=-1,e.NWB=-4200,e.WS_DISCONN=-4201,e.CB=-5e3,e.JSON_REQUIRED=-5001,e.OBJECT_DISPOSED=-5002,e.INVALID_TASK=-5003,e.OBJECT_DISPOSING=-5004,e}({}),Gr=function(e){return e.WS_DISCONN="The Web Socket connection failed.",e.JSON_REQUIRED="The input is not a JSON object or JSON styled string.",e.OBJECT_DISPOSED="The object has been disposed.",e.INVALID_TASK="The task is invalid.",e.OBJECT_DISPOSING="The object need to be disposed.",e}({}),Br=function(){return Rr((function e(){xr(this,e)}),null,[{key:"message",value:function(e){return this._errorMessage[e]}},{key:"init",value:function(){this._errorMessage[Mr.OK]="Successful.",this._errorMessage[Mr.WS_DISCONN]=Gr.WS_DISCONN,this._errorMessage[Mr.JSON_REQUIRED]=Gr.JSON_REQUIRED,this._errorMessage[Mr.OBJECT_DISPOSED]=Gr.OBJECT_DISPOSED,this._errorMessage[Mr.INVALID_TASK]=Gr.INVALID_TASK,this._errorMessage[Mr.OBJECT_DISPOSING]=Gr.OBJECT_DISPOSING}}])}();kr(Br,"_errorMessage",Object.create(null)),Br.init();var Ur=function(){return Rr((function e(t,r){xr(this,e),kr(this,"_code",Mr.OK),this.name="DSError",this.message=null!=r?r:"string"==typeof t?t:Br.message(t),this._code="string"==typeof t?Mr.Custom:t}),[{key:"code",get:function(){return this._code}}])}();function jr(e){return jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jr(e)}function Hr(){Hr=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof T?t:T,a=Object.create(i.prototype),s=new L(n||[]);return o(a,"_invoke",{value:C(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",d="suspendedYield",p="executing",g="completed",m={};function T(){}function v(){}function y(){}var b={};c(b,a,(function(){return this}));var S=Object.getPrototypeOf,_=S&&S(S(D([])));_&&_!==r&&n.call(_,a)&&(b=_);var w=y.prototype=T.prototype=Object.create(b);function I(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(o,i,a,s){var u=f(e[o],e,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==jr(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function C(t,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var c=f(t,r,n);if("normal"===c.type){if(o=n.done?g:d,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=g,n.method="throw",n.arg=c.arg)}}}function A(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function W(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(W,this),this.reset(!0)}function D(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(jr(t)+" is not iterable")}return v.prototype=y,o(w,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:v,configurable:!0}),v.displayName=c(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},I(E.prototype),c(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},I(w),c(w,u,"Generator"),c(w,a,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function o(){for(;r.length;){var e=r.pop();if(e in t)return o.value=e,o.done=!1,o}return o.done=!0,o}},t.values=D,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:D(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Vr(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function Kr(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Vr(i,n,o,a,s,"next",e)}function s(e){Vr(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Xr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jr(n.key),n)}}function Yr(e,t,r){return(t=Jr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jr(e){var t=function(e,t){if("object"!=jr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=jr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==jr(t)?t:t+""}var zr=function(e){return e.GET_TASKID=0,e.GET_EVENT_TASKID=1,e.ONMESSAGE_PROCESS_DATA=2,e.ONMESSAGE_GET_TASKID=3,e.ONMESSAGE_GET_EVENT_TASKID=4,e.HANDLE_RAW_MESSAGE=5,e.HANDLE_PROCESSED_MESSAGE=6,e}({}),qr=function(){return e=function a(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Yr(this,"_serverInfo",undefined),Yr(this,"_disposed",!1),this._serverInfo=e,this._ref=1},t=[{key:"serverInfo",get:function(){return this._serverInfo}},{key:"requestSync",value:function(e,t){return Kt.error("requestSync should be implemented in child class"),undefined}},{key:"request",value:function(e,t,r,n){return Kt.error("request should be implemented in child class"),Promise.resolve(null)}},{key:"send",value:(i=Kr(Hr().mark((function s(e,t,r){return Hr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Kt.error("reqsenduestSync should be implemented in child class");case 1:case"end":return e.stop()}}),s)}))),function(e,t,r){return i.apply(this,arguments)})},{key:"testConnection",value:function(e,t,r,n){return Kt.error("testConnection should be implemented in child class"),Promise.resolve(null)}},{key:"disposed",get:function(){return this._disposed}},{key:"dispose",value:(o=Kr(Hr().mark((function u(){return Hr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._ref--,!(this._ref>0)){e.next=3;break}return e.abrupt("return",!1);case 3:return this._disposed=!0,e.next=6,this._terminate();case 6:case"end":return e.stop()}}),u,this)}))),function(){return o.apply(this,arguments)})},{key:"_terminate",value:(n=Kr(Hr().mark((function c(){return Hr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),c)}))),function(){return n.apply(this,arguments)})},{key:"addRef",value:function(){this._ref++}}],t&&Xr(e.prototype,t),r&&Xr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,n,o,i}(),Qr={ErrStr_Service_NOT_INSTALLED:"Please make sure the Dynamsoft Service has been installed.",ErrStr_BROWSER_NOT_SUPPORT:"Error: This browser is currently not supported.",ErrStr_CreateID_ContainerIdDuplicated:"Error: Duplicate ContainerId detected while creating a Dynamic Web TWAIN object.",ErrStr_CreateID_WebTwainIdDuplicated:"Error: Duplicate WebTwainId detected while creating a Dynamic Web TWAIN object.",ErrStr_CreateID_NotContainer:"Error: The ID of the target DIV for the new DWT object is invalid.",ErrStr_CreateID_ContainerIdInvalid:"Error: The ContainerId cannot be empty string while creating a Dynamic Web TWAIN object.",ErrStr_CreateID_WebTwainIdInvalid:"Error: The WebTwainId cannot be empty string while creating a Dynamic Web TWAIN object."};function Zr(){return nr.bUseDynamsoftLicenseManager?Wt.isString(nr.refProductKey)&&(Wt.startsWith(nr.refProductKey,"DLS2")||""===nr.refProductKey):Wt.isString(nr.handshakeCode)||Wt.isString(nr.organizationID)||nr.bPublicLTS||Wt.isString(xt.DWT.ProductKey)&&Wt.startsWith(xt.DWT.ProductKey,"DLS2")}function $r(e){return"text/json"===e||"application/json"===e}var en=function(e){return e.LicenseInvalid=-2325,e.LicenseExpired=-2326,e.LicenseParseFailed=-2546,e.LicenseExpiredForDLS=-2808,e.LicenseNoCoreForDLS=-2809,e.LicenseNoCore=-2810,e.LicenseIsFuture=-2396,e.LicenseVersionNotCurrent=-2539,e}({});function tn(e,t,r){e._errorCode=t,e._errorString=r}function rn(e){var t=xt.DWT.licenseException;t.code=e._errorCode,t.message=e._errorString,t.fromLTS=!1}function nn(){return xt.DWT.IfChromeExtension?"":"Please contact the site administrator."}xt.DWT.EnumDWT_LicenseErrorCode=en;var on=function(e){return e.UserCancelled=-1032,e.CORSErrorFromService=-2137,e.CommonError=-2201,e.ModuleNotExists=-2371,e.MustUpgrade=-2207,e.RemoteDynamsoftServiceStopped=-2613,e.ResponseDataTypeError=-2801,e.HTSTError=-2817,e.SSLCertExpired=-2818,e.SSLCertInvalid=-2819,e.CORSError=-2820,e.DWTPortNotReady=-2821,e.HTTPRedirected=-2823,e.BboError=-2827,e.HTTPServerError=-2842,e}({});function an(e){tn(e,-1033,"Invalid index.")}function sn(e){tn(e,-1034,"Invalid value.")}function un(e){tn(e,en.LicenseInvalid,Zr()?"The license is invalid.":"The current product key is empty or invalid."),rn(e)}function cn(e,t){e._errorCode=en.LicenseExpired;var r="";if(t&&""!=t&&(-1==t.indexOf("on")&&(r=" on "+t),e.__licenseInfo&&(e.__licenseInfo.ExpireDate=t)),Zr()){var n,o,i,a;if(n=xt.DWT.lgdt(),e._bRemoteMode)o=null!==(i=null===(a=e._dmService)||void 0===a||null===(a=a.attrs)||void 0===a?void 0:a.UUID)&&void 0!==i?i:"";else o="";e._errorString="The license has expired"+r+". Please contact the application developer.",xt.DWT.lcexp(n,o).then((function(){e._errorString=xt.DWT.licenseException.message}))}else e._errorString="The current product key has expired"+r+". Please contact the application developer.",rn(e)}function ln(e,t){Zr()?111==t?(e._errorCode=en.LicenseExpiredForDLS,e._errorString="The license for v"+Nt+" Service Core Module has expired."):(e._errorCode=en.LicenseNoCoreForDLS,e._errorString="The license for v"+Nt+" Service Core Module is not found."):(e._errorCode=en.LicenseNoCore,e._errorString="The product key for the current operating system is missing the Service Core license. "+nn()),rn(e)}function fn(e){e._errorCode=-2339,Zr()?e._errorString="The license for the module pdf rasterizer is not found or has expired.":e._errorString="The current product key does not support pdf rasterizer. "+nn(),rn(e)}function hn(e){tn(e,-2352,"The indices are out of range.")}function dn(e){tn(e,-2359,"The index is out of range.")}function pn(e){tn(e,-2360,"The index is null or undefined.")}function gn(e){tn(e,-2391,"Invalid event name.")}function mn(e){tn(e,-2416,"Invalid parameter.")}function Tn(e){tn(e,-2426,"You have used a full license with a trial license which is not permitted. Please check and update Dynamsoft.DWT.ProductKey.")}function vn(e){tn(e,-2433,"The ActiveX edition does not support this method or property.")}function yn(e){tn(e,-2506,"The ThumbnailViewer object has been disposed.")}function bn(e,t,r){tn(e,-2816,["HTTP process error: ",r," (",t,")."].join(""))}function Sn(e){tn(e,-2828,"Invalid PDF Convert Mode Value.")}function _n(e){return _n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_n(e)}function wn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,En(n.key),n)}}function In(e,t,r){return(t=En(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function En(e){var t=function(e,t){if("object"!=_n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_n(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_n(t)?t:t+""}var Cn=/[#\/\?@]/g,An=/[#\?]/g,Wn={scheme:1,userInfo:2,hostname:3,port:4,path:5},Pn=new RegExp("^(?:([\\w\\d+.-]+):)?(?://(?:([^/?#@]*)@)?([\\w\\d\\-\\u0100-\\uffff.+%]*|\\[[^\\]]+\\])(?::([0-9]+))?)?(.+)?$");function Ln(e,t){return Wt.isString(e)&&Wt.isString(t)?e.toLowerCase()===t.toLowerCase():e===t}function Dn(e,t){return encodeURI(e).replace(t,(function(e){return"%"+function(e){return 1===e.length?"0"+e:e}(e.charCodeAt(0).toString(16))}))}var On=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),In(this,"scheme",""),In(this,"userInfo",""),In(this,"hostname",""),In(this,"port",""),In(this,"path",""),t instanceof e)return Wt.clone(t);e.getComponents(t,this)}return t=e,n=[{key:"getComponents",value:function(e,t){var r=(e=e||V).match(Pn)||[],n=t||{};return Wt.each(Wn,(function(e,t){n[t]=r[e]})),n}}],(r=[{key:"clone",value:function(){var t=new e,r=this;return Wt.each(Wn,(function(e,n){t[n]=r[n]})),t}},{key:"getScheme",value:function(){return this.scheme}},{key:"setScheme",value:function(e){return this.scheme=e,this}},{key:"getHostname",value:function(){return this.hostname}},{key:"setHostname",value:function(e){return this.hostname=e,this}},{key:"setUserInfo",value:function(e){return this.userInfo=e,this}},{key:"getUserInfo",value:function(){return this.userInfo}},{key:"setPort",value:function(e){return this.port=e,this}},{key:"getPort",value:function(){return this.port}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"getPath",value:function(){return this.path}},{key:"isSameOriginAs",value:function(e){var t=this;return Ln(t.hostname,e.hostname)&&Ln(t.scheme,e.scheme)&&Ln(t.port,e.port)}},{key:"toString",value:function(e){var t,r,n,o,i,a=[],s=this;return(t=s.scheme)&&(a.push(Dn(t,Cn)),a.push(":")),(r=s.hostname)&&(a.push("//"),(i=s.userInfo)&&(a.push(Dn(i,Cn)),a.push("@")),a.push(encodeURIComponent(r)),(o=s.port)&&(a.push(":"),a.push(o))),(n=s.path)&&(r&&!Wt.startsWith(n,"/")&&(n="/"+n),a.push(Dn(n,An))),a.join("")}}])&&wn(t.prototype,r),n&&wn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}();function xn(e){return xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xn(e)}function Nn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kn(n.key),n)}}function Rn(e,t,r){return(t=kn(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kn(e){var t=function(e,t){if("object"!=xn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=xn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==xn(t)?t:t+""}var Fn,Mn=Wt.each,Gn=Wt.error,Bn=Wt.isFunction,Un=Wt.isString,jn=K.bIE&&K.IEVersion<=9,Hn=K.bIE&&K.IEVersion<=10,Vn=window,Kn=new On(location.href),Xn=Kn&&/^(?:about|app|app\-storage|.+\-extension|file|widget)$/.test(Kn.getScheme()),Yn=!1,Jn=function(){try{return new Vn.XMLHttpRequest}catch(e){}},zn=function(){try{var e=sr;return Mn(["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.3.0","Msxml3.XMLHTTP"],(function(t){try{if(!e)return e=new Vn.ActiveXObject(t),sr}catch(r){Gn("new xhr error: "+r.message)}})),e}catch(t){}},qn=!(Xn||!Vn.XMLHttpRequest)&&"withCredentials"in(Jn()||[]),Qn=Vn.ActiveXObject?function(e){return jn?zn():!Xn&&Jn()||zn()}:Jn,Zn=function(e){return Yn},$n=/^(?:GET|HEAD)$/,eo=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,to={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},ro=Fn;Hn&&(ro=Wt.noop);var no,oo,io=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Rn(this,"url",!1),Rn(this,"onSuccess",!1),Rn(this,"onError",!1),Rn(this,"onComplete",!1),Rn(this,"method","GET"),Rn(this,"async",!0),Rn(this,"xhrFields",!1),Rn(this,"mimeType",!1),Rn(this,"username",!1),Rn(this,"password",!1),Rn(this,"data",!1),Rn(this,"dataType","text"),Rn(this,"headers",!1),Rn(this,"contentType","application/x-www-form-urlencoded; charset=UTF-8"),Rn(this,"beforeSend",!1),Rn(this,"afterSend",!1),Rn(this,"timeout",0),Rn(this,"cache",!0),Rn(this,"crossDomain",!1),Rn(this,"retry",0)}return t=e,r=[{key:"setRequestHeader",value:function(e,t){this.headers[e]=t}},{key:"getAllResponseHeaders",value:function(){return 2===this.state?this.responseHeadersString:null}},{key:"getNativeXhr",value:function(){return this.nativeXhr}},{key:"getResponseHeader",value:function(e){var t,r;if(e=e.toLowerCase(),2===this.state){if(!(r=this.responseHeaders))for(r=this.responseHeaders={};t=eo.exec(this.responseHeadersString);)r[t[1].toLowerCase()]=t[2];t=r[e]}return t===undefined?null:t}},{key:"overrideMimeType",value:function(e){return this.state||(this.mimeType=e),this}},{key:"abort",value:function(e){return this.state=3,this.status=0,this.statusText=null!=e?e:"abort",this.nativeXhr&&this.nativeXhr.abort(),this._callback(),this}},{key:"_ioReady",value:function(e,r){var n=!1,o=this;if(2!==this.state&&3!==this.state){1===this.state&&(this.state=2),this.readyState=4,e>=200&&e<300||304===e?304===e?(r="not modified",n=!0):(r="success",n=!0):e<0&&(e=0);try{e>=200&&this.handleResponseData()}catch(t){Gn(t,"error"),r=t.message||"parser error"}return(e<200||!n)&&this.retry>0?(this.retry=this.retry-1,void setTimeout((function(){o.sendInternal()}),200)):(this.status=e,this.statusText=r,this._callback(n),n)}}},{key:"_callback",value:function(e){var t=this,r=this.timeoutTimer;r&&(clearTimeout(r),this.timeoutTimer=0),Mn([e?this.onSuccess:this.onError,this.onComplete],(function(e){Bn(e)&&e.apply(t.context,[t.responseData,t.statusText,t])})),this.responseData=null}},{key:"handleResponseData",value:function(){var e,r=this.dataType,n=this.nativeXhr;if("blob"===r||"arraybuffer"===r)if(jn){var o,i,a;if("responseBody"in n)o=n.responseBody,i=Vn.dsVbsBinGetLength(o),e=new Vn.VBArray(Vn.dsVbsBinGetBytes(o,0,i)).toArray();else for(e=[],i=(o=n.responseText).length,a=0;a<i;++a)e.push(255&o.charCodeAt(a));o=null}else e=Vn.Blob?n.response:"responseBody"in n?n.responseBody:n.responseText;else if("json"==r)e=n.responseType&&"json"==n.responseType.toLowerCase()?n.response:n.responseText?Wt.parse(n.responseText):Wt.parse(n.response);else if("user-defined"===r)e=n.response!==undefined?n.response:n.responseText;else{this.responseText=e=n.responseText||"";try{var s=n.responseXML;s&&s.documentElement&&(this.responseXML=s)}catch(t){}}this.responseData=e}},{key:"sendInternal",value:function(e){var r,n,o,i,a,s,u,c,l,f,h,d=this;if(n=(r=this._setup(e)).method,Un(n)&&(n=n.toUpperCase()),a=r.contentType,o=r.url,i=r.dataType,c=r.mimeType,Un(o)&&(this.nativeXhr=s=Qn(r.crossDomain),s)){try{if(this.state=1,r.username?s.open(n,o,r.async,r.username,r.password):s.open(n,o,r.async),(r.async||K.bIE)&&i&&"user-defined"!=i&&"responseType"in s)try{s.responseType=i}catch(t){}}catch(p){return void(this.state<2?(Gn(p,"error"),this._ioReady(-1,"open error: "+(Wt.isNumber(p.number)?"("+p.number+")":"")+(p.message||""))):Gn(p))}"withCredentials"in(u=r.xhrFields||{})&&(qn||delete u.withCredentials),Mn(u,(function(e,r){try{s[r]=e}catch(t){Gn(t)}})),c&&s.overrideMimeType&&s.overrideMimeType(c),!1===(l=r.headers||{})["X-Requested-With"]&&delete l["X-Requested-With"],"setRequestHeader"in s&&(a&&s.setRequestHeader("Content-Type",r.contentType),s.setRequestHeader("Accept",i&&to[i]?to[i]+("*"===i?"":", */*; q=0.01"):to["*"]),Mn(l,(function(e,t){s.setRequestHeader(t,e)}))),"GET"!=n||r.cache||(s.setRequestHeader("If-Modified-Since","0"),s.setRequestHeader("Cache-Control","no-cache")),h=(f=!$n.test(r.method))&&r.data||null,f&&jn&&(h=r.data),r.async&&r.timeout>0&&(r.timeout<300&&(r.timeout=300),this.timeoutTimer=setTimeout((function(){d.abort("timeout")}),r.timeout));try{if(this.state=1,Bn(this.beforeSend)&&!1===this.beforeSend(s,d))return void this.abort("cancel");s.send(h),h=null,r.data=null,Bn(this.afterSend)&&this.afterSend(d)}catch(t){this.state<2?(Gn(t,"error"),this._ioReady(-1,"send error: "+(t.message||""))):Gn(t)}if(!r.async||4===s.readyState)return d._xhrCallback();s.onreadystatechange=function(){d._xhrCallback()}}}},{key:"_xhrCallback",value:function(e,r){var n,o=this.nativeXhr;try{if(4===o.readyState||r)if(Zn()||(o.onreadystatechange=ro),r)4!==o.readyState&&o.abort();else{Zn()||(this.responseHeadersString=o.getAllResponseHeaders());var i,a=o.status;try{i=o.statusText}catch(t){Gn("xhr statusText error: "),Gn(t),i=""}n=this._ioReady(a,i)}}catch(t){Gn(t,"error"),o.onreadystatechange=ro,r||this._ioReady(-1,t.message||"process error")}return n}},{key:"_setup",value:function(t){var r,n,o,i,a;if(t){for(n in this.context=t.context,delete t.context,t instanceof e&&(t=t.config),this.config=t,i=t.url,Wt.startsWith(i,"//")&&(t.url=i="http:"+i),(Wt.startsWith(i,"http://")||Wt.startsWith(i,"https://"))&&(a=new On(i)),r=t.dataType?t.dataType.toLowerCase():"text",t.dataType=r,t.method?t.method=t.method.toUpperCase():t.method="GET",a&&!("crossDomain"in t)&&(t.crossDomain=!a.isSameOriginAs(Kn)),o=t.headers)o[n]===Fn&&delete o[n];Wt.mix(this,t)}return this.state=1,this}},{key:"dispose",value:function(){this.responseHeaders=null,this.responseHeadersString=null,this.responseData=null,this.responseText=null,this.responseXML=null,this.context=null,this.config=null,this.onSuccess=null,this.onError=null,this.onComplete=null,this.xhrFields=null,this.data=null,this.headers=null,this.beforeSend=null,this.afterSend=null}}],r&&Nn(t.prototype,r),n&&Nn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}();var ao=K.bIE&&K.IEVersion<=9;no=self&&self.fetch?self.fetch:window.fetch;var so=0;var uo,co,lo,fo,ho=(uo=null,fo=!1,so=co=0,no?lo=function(e,t){var r=!1,n="text",o=!1;if(t&&(t.dataType&&(n=t.dataType),t.fetchRaw&&(o=!0),t.timeout)){var i=t.timeout;i<300&&(i=300);var a=new AbortController;t.signal=a.signal,setTimeout((function(){r||a.abort("timeout")}),i)}fo=!1;var s=no(e,t).then((function(e){if(e.ok){var t,n;if(r=!0,!uo)return e;if(uo.__clickCancel)return uo.__clickCancel=!1,uo.__cancelBeforObjectCreated=!1,fo=!0,e;uo.IfShowCancelDialogWhenImageTransfer?(po(!0),n=uo.on("cancel",(function(){fo=!0}))):po(!1);var o=e.headers.get("Content-Length"),i=0;uo._onPercent&&so==co&&uo._onPercent({loaded:i,total:o});var a=null==e||null===(t=e.body)||void 0===t?void 0:t.getReader(),s=new ReadableStream({start:function(e){a?setTimeout((function t(){return a.read().then((function(r){if(r.done||fo)return fo?a.cancel():n&&uo.off("cancel",n),e.close(),void(n=null);var s=r.value;i+=s.length,uo._onPercent&&so==co&&uo._onPercent({loaded:i,total:o});try{return e.enqueue(s),t()}catch(u){Wt.error(u)}}))}),0):e.close()}}),u=e.headers.get("Content-Type");return u&&""!=u||(u="application/octet-stream"),new Response(s,{headers:{"Content-Type":u}})}if("opaqueredirect"==e.type)throw{code:on.HTTPRedirected,message:"The http url redirected."};var c;throw bn(c={},e.status,e.statusText),{code:c._errorCode,message:c._errorString,httpCode:e.status}}));return o?s:(s="blob"==n?s.then((function(e){var t=e.headers.get("content-type");return $r(t)?e.json():K.bLinux?e.arrayBuffer().then((function(e){return new Blob([e],{type:t})})):e.blob()})):"json"==n?s.then((function(e){return e.json()})):"arraybuffer"==n?s.then((function(e){return $r(e.headers.get("content-type"))?e.json():e.arrayBuffer()})):s.then((function(e){return e.text()}))).then((function(e){var t;if(fo)throw tn(t={},-2615,"User cancelled the operation."),{code:t._errorCode,message:t._errorString};return e}))}:(ao&&Wt.addVBS(["Function dsVbsBinGetAt(strBinary,iOffset)\r\n"," dsVbsBinGetAt=AscB(MidB(strBinary,iOffset+1,1))\r\n","End Function\r\n","Function dsVbsBinGetBytes(strBinary,iOffset,iLength)\r\n"," Dim aBytes()\r\n"," ReDim aBytes(iLength-1)\r\n"," For i=0 To iLength-1\r\n","  aBytes(i)=dsVbsBinGetAt(strBinary,iOffset+i)\r\n"," Next\r\n"," dsVbsBinGetBytes=aBytes\r\n","End Function\r\n","Function dsVbsBinGetLength(strBinary)\r\n"," dsVbsBinGetLength=LenB(strBinary)\r\n","End Function"].join("")),lo=function(e,t){return new(Lt.nativePromise||window.Promise)((function(r,n){var o,i=!1;o={url:e,async:!0,onSuccess:function(e,t,n){var o=!1;if(n.responseHeadersString&&function(e){return-1!=e.indexOf("text/json")||-1!=e.indexOf("application/json")}(n.responseHeadersString)&&(Wt.isArray(e)||e instanceof ArrayBuffer)&&(o=!0),o){var i=e;e instanceof ArrayBuffer&&(i=new Uint8Array(e));var a=String.fromCharCode.apply(null,i);r(a)}else r(e)},onError:function(e,t,r){var o;bn(o={},r.status,t),n({code:o._errorCode,message:o._errorString,httpCode:r.status})},dataType:"text",method:oo,data:oo,headers:oo,contentType:oo,mimeType:oo},t&&(t.method&&(o.method=t.method),t.body&&(o.data=t.body),t.headers&&(o.headers||(o.headers={}),Wt.each(t.headers,(function(e,t){"content-type"==t.toLowerCase()&&(i=!0),o.headers[t]=e}))),t.dataType&&(o.dataType=t.dataType),t.contentType&&(o.contentType=t.contentType),Wt.isNumber(t.timeout)&&t.timeout>0&&(o.timeout=t.timeout)),i&&(o.contentType=!1),"blob"==o.dataType&&ao&&(o.mimeType="text/plain; charset=x-user-defined"),uo&&(uo._onPercent&&(o.beforeSend=function(e,t,r){e.upload.addEventListener("progress",(function(e){uo._onPercent&&so==co&&uo._onPercent(e)}),!1)}),uo.IfShowCancelDialogWhenImageTransfer?po(!0):po(!1));var a=function(e){if(e&&Un(e.url)){var t=new io;return e.async?(e.async=!0,t.sendInternal(e),t):(e.async=!1,t.sendInternal(e))}Wt.log("the url is error.")}(o);uo&&uo.IfShowCancelDialogWhenImageTransfer&&uo.on("cancel",(function(){a.abort()}))}))}),lo);function po(e){var t=Wt.sizzle(".dynamsoft-btnCancel");if(t.length>0){var r=t[0];r.style.display=e?"":"none"}}function go(e){return go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},go(e)}function mo(){mo=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof T?t:T,a=Object.create(i.prototype),s=new L(n||[]);return o(a,"_invoke",{value:C(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",d="suspendedYield",p="executing",g="completed",m={};function T(){}function v(){}function y(){}var b={};c(b,a,(function(){return this}));var S=Object.getPrototypeOf,_=S&&S(S(D([])));_&&_!==r&&n.call(_,a)&&(b=_);var w=y.prototype=T.prototype=Object.create(b);function I(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(o,i,a,s){var u=f(e[o],e,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==go(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function C(t,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var c=f(t,r,n);if("normal"===c.type){if(o=n.done?g:d,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=g,n.method="throw",n.arg=c.arg)}}}function A(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function W(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(W,this),this.reset(!0)}function D(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(go(t)+" is not iterable")}return v.prototype=y,o(w,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:v,configurable:!0}),v.displayName=c(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},I(E.prototype),c(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},I(w),c(w,u,"Generator"),c(w,a,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function o(){for(;r.length;){var e=r.pop();if(e in t)return o.value=e,o.done=!1,o}return o.done=!0,o}},t.values=D,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:D(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function To(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function vo(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){To(i,n,o,a,s,"next",e)}function s(e){To(i,n,o,a,s,"throw",e)}a(void 0)}))}}function yo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bo(n.key),n)}}function bo(e){var t=function(e,t){if("object"!=go(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=go(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==go(t)?t:t+""}function So(e,t,r){return t=wo(t),function(e,t){if(t&&("object"==go(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_o()?Reflect.construct(t,r||[],wo(e).constructor):t.apply(e,r))}function _o(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_o=function(){return!!e})()}function wo(e){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},wo(e)}function Io(e,t){return Io=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Io(e,t)}function Eo(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Co(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var Ao,Wo=Wt.getLogger(),Po=new WeakSet,Lo=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Eo(e=So(this,t,[].concat(n)),Po),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Io(e,t)}(t,e),r=t,n=[{key:"send",value:(i=vo(mo().mark((function a(e,t,r){return mo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Wo.error("HTTP Client send not supported");case 1:case"end":return e.stop()}}),a)}))),function(e,t,r){return i.apply(this,arguments)})},{key:"requestSync",value:function(e,t,r){return undefined}},{key:"request",value:function(e,t,r,n){return Co(Po,this,Oo).call(this,e,t,r,undefined,undefined,n)}},{key:"testConnection",value:function(e,t,r,n){return Co(Po,this,Oo).call(this,undefined,undefined,e,t,r,n)}}],n&&yo(r.prototype,n),o&&yo(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i}(qr);function Do(e){var t=this.serverInfo,r="";return r=t.ssl?"https://":"http://",r+=t.server,t.port&&(r+=":",r+=t.port),e&&(Wt.startsWith(e,"/")||Wt.endsWith(r,"/")||(r+="/"),Wt.endsWith(e,"/")?r+=e.slice(0,-1):r+=e),r}function Oo(e,t,r,n,o,i){return xo.apply(this,arguments)}function xo(){return(xo=vo(mo().mark((function e(t,r,n,o,i,a){var s,u;return mo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=null!=n?n:{},t&&(s.body=t),s.method||(s.method="POST"),a&&(s.timeout=a),u=Co(Po,this,Do).call(this,r),Wo.debug("HTTP URL: "+u),e.next=9,ho(u,s);case 9:return e.abrupt("return",e.sent);case 12:if(e.prev=12,e.t0=e["catch"](0),!(e.t0 instanceof Ur||e.t0&&e.t0.code&&e.t0.message)){e.next=18;break}throw e.t0;case 18:if(!e.t0.message){e.next=20;break}throw new Ur(e.t0.message);case 20:case"end":return e.stop()}}),e,this,[[0,12]])})))).apply(this,arguments)}function No(e){return No="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},No(e)}function Ro(e){try{return"object"===No(e)?e:(e="string"!=typeof e?Wt.stringify(e):e,Wt.parse(e))}catch(t){throw t instanceof Ur?t:new Ur(Mr.JSON_REQUIRED)}}function ko(e){return Math.random().toString(16).substring(2,2+e)}function Fo(e){return Fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fo(e)}function Mo(){Mo=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof T?t:T,a=Object.create(i.prototype),s=new L(n||[]);return o(a,"_invoke",{value:C(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",d="suspendedYield",p="executing",g="completed",m={};function T(){}function v(){}function y(){}var b={};c(b,a,(function(){return this}));var S=Object.getPrototypeOf,_=S&&S(S(D([])));_&&_!==r&&n.call(_,a)&&(b=_);var w=y.prototype=T.prototype=Object.create(b);function I(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(o,i,a,s){var u=f(e[o],e,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==Fo(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function C(t,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var c=f(t,r,n);if("normal"===c.type){if(o=n.done?g:d,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=g,n.method="throw",n.arg=c.arg)}}}function A(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function W(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(W,this),this.reset(!0)}function D(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Fo(t)+" is not iterable")}return v.prototype=y,o(w,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:v,configurable:!0}),v.displayName=c(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},I(E.prototype),c(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},I(w),c(w,u,"Generator"),c(w,a,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function o(){for(;r.length;){var e=r.pop();if(e in t)return o.value=e,o.done=!1,o}return o.done=!0,o}},t.values=D,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:D(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Go(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function Bo(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Go(i,n,o,a,s,"next",e)}function s(e){Go(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Uo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jo(n.key),n)}}function jo(e,t,r){return t=Vo(t),function(e,t){if(t&&("object"==Fo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ho()?Reflect.construct(t,r||[],Vo(e).constructor):t.apply(e,r))}function Ho(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ho=function(){return!!e})()}function Vo(e){return Vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vo(e)}function Ko(e,t){return Ko=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ko(e,t)}function Xo(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Yo(e,t,r){return(t=Jo(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jo(e){var t=function(e,t){if("object"!=Fo(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Fo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Fo(t)?t:t+""}function zo(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var qo,Qo,Zo=Wt.getLogger(),$o=1006,ei=new WeakSet,ti=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Xo(r=jo(this,t,[e]),ei),Yo(r,"_defaultRetries",1),Yo(r,"_ws",qo),Yo(r,"_events",{}),Yo(r,"_bHeartBeatStarted",!1),Yo(r,"_heartBeatTicks",6e4),r._ws=qo,r.bUseParentWS=!1,r._tasks=Object.create(null),r.bReady=!1,r._blob_callbacks=[],r._processing_blob=!1,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ko(e,t)}(t,e),r=t,n=[{key:"ws",get:function(){return this._ws}},{key:"requestSync",value:function(e,t,r){return Zo.error("WebSocket Client requestSync not supported"),undefined}},{key:"send",value:(s=Bo(Mo().mark((function u(e,t,r){var n,o,i,a;return Mo().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(n=r.client,s.prev=1,(o=r.taskId)!==undefined){s.next=7;break}return s.next=6,t(e,zr.GET_TASKID,n._requestTaskId,r);case 6:o=s.sent;case 7:if(i=n._tasks[o]){s.next=11;break}throw Zo.error("invalid task id: "+o),new Ur(Mr.INVALID_TASK);case 11:return s.next=13,zo(ei,n,ui).call(n,!1);case 13:return s.next=15,zo(ei,n,li).call(n,e,t,r,i);case 15:Zo.debug("begin to send data "+o),n.disposed||n._ws.send(e),e=null,Zo.debug("end to send data "+o),s.next=27;break;case 21:s.prev=21,s.t0=s["catch"](1),Zo.debug("failed to send data."),Zo.error(s.t0),delete n._tasks[o],null===(a=i)||void 0===a||null===(a=a.resolver)||void 0===a||a.reject(s.t0.message);case 27:case"end":return s.stop()}}),u,null,[[1,21]])}))),function(e,t,r){return s.apply(this,arguments)})},{key:"request",value:function(e,t,r,n){var o=this._defaultRetries,i=null!=t?t:zo(ei,this,ai),a=null!=r?r:{client:this,userData:this};return zo(ei,this,hi).call(this,e,i,a,o,!1,undefined,n)}},{key:"connected",get:function(){var e;return(null===(e=this._ws)||void 0===e?void 0:e.readyState)==WebSocket.OPEN}},{key:"testConnection",value:function(e,t,r,n){return zo(ei,this,ui).call(this,!0,null!=t?t:0,r,n)}},{key:"_terminate",value:(a=Bo(Mo().mark((function c(){var e,t;return Mo().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(t in Zo.debug("terminate WSClient"),this.fireEvent("disposed"),e=!1,this._tasks)this._tasks[t]!==undefined&&this._tasks[t].resolver&&(e=!0);if(this._lic_callback=qo,this._blob_callbacks=[],this._processing_blob=!1,this._ws&&(this._ws.onopen=null,this._ws.onerror=null,this._ws.onmessage=null,this._ws.onclose=null,this._ws.close()),this._ws=qo,this._tasks=Object.create(null),!e){r.next=12;break}throw new Ur(Mr.OBJECT_DISPOSING);case 12:case"end":return r.stop()}}),c,this)}))),function(){return a.apply(this,arguments)})},{key:"setRetry",value:function(e){this._defaultRetries=null!=e?e:1}},{key:"addEvent",value:function(e,t,r){var n=this._events[e];n||(this._events[e]={},n=this._events[e]),Wt.isString(t)&&Wt.isFunction(r)&&(n[t]=r)}},{key:"removeEvent",value:function(e,t){var r=this._events[e];r&&Wt.isString(t)&&delete r[t]}},{key:"clearEvent",value:function(e){this._events[e]&&(this._events[e]={})}},{key:"fireEvent",value:function(e){var t,r=this._events[e];if(r){var n=Object.keys(r);for(t=0;t<n.length;t++)Wt.isFunction(r[n[t]])&&r[n[t]]()}}},{key:"getRequestTaskId",value:function(){return this._requestTaskId?this._requestTaskId:0}}],o=[{key:"_waitForPreBlob",value:(i=Bo(Mo().mark((function l(e){return Mo().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e._processing_blob){r.next=3;break}return setTimeout((function(){t._waitForPreBlob(e)}),500),r.abrupt("return");case 3:t._preBlobResolv&&t._preBlobResolv();case 4:case"end":return r.stop()}}),l)}))),function(e){return i.apply(this,arguments)})}],n&&Uo(r.prototype,n),o&&Uo(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i,a,s}(qr);function ri(e){var t="";return t=e.ssl?"wss://":"ws://",t+=e.server,e.port&&(t+=":",t+=e.port),t}function ni(e,t,r,n){var o=this;return new Lt.Promise((function(i,a){try{var s,u,c=a,l=i;if(n&&(u=setTimeout((function(){var e=new Ur("createWebSocket timed out.");Zo.debug(e.message),c&&(c(e),c=null,l=null),u&&clearTimeout(u),s&&s.close()}),n)),e.bUseParentWS){var f=window,h=parent,d=f.WebSocket;try{for(;f!=h&&h&&h.WebSocket;)d=h.WebSocket,f=h.window,h=h.parent}catch(p){d=window.WebSocket}s=r?new d(t,r):new d(t)}else s=r?new WebSocket(t,r):new WebSocket(t);s.onopen=function(){u&&clearTimeout(u),e._ws=s,l&&(l(s),c=null,l=null)},s.onerror=function(t){s.close(),e.bReady=!1,u&&clearTimeout(u),o.fireEvent("error"),c&&(c(new Ur("websocket error")),c=null,l=null)},s.onmessage=function(t){zo(ei,e,oi).call(e,e,t.data)},s.onclose=function(t){e.bReady=!1,u&&clearTimeout(u),o.fireEvent("close"),c&&(t&&t.code==$o?c(new Ur("websocket error")):c(t),c=null,l=null)}}catch(g){if(g instanceof Ur||g&&g.code&&g.message)throw g;if(g.message)throw new Ur(g.message)}}))}function oi(e,t){return ii.apply(this,arguments)}function ii(){return(ii=Bo(Mo().mark((function e(t,r){var n,o,i,a,s,u,c,l,f;return Mo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,e.prev=1,a={client:n,userData:undefined},"object"!==Fo(r)){e.next=17;break}if(!(n._blob_callbacks.length>0)){e.next=17;break}if(!n._processing_blob){e.next=9;break}return e.next=8,new Lt.Promise((function(e){Ao._preBlobResolv=e,Ao._waitForPreBlob(n)}));case 8:Ao._preBlobResolv=null;case 9:return n._processing_blob=!0,s=n._blob_callbacks.shift(),e.next=13,s(r);case 13:return e.sent,n._processing_blob=!1,e.abrupt("return");case 17:if(!(n.bReady&&Wt.isString(r)&&(r.indexOf("Function not found")>0||r.indexOf("Version not found")>0))){e.next=19;break}return e.abrupt("return");case 19:if(n._cbToGetTaskId){e.next=21;break}return e.abrupt("return");case 21:return e.next=23,n._cbToGetTaskId(r,zr.ONMESSAGE_PROCESS_DATA,n._requestTaskId,a);case 23:return u=e.sent,c=!1,e.next=27,n._cbToGetTaskId(u,zr.ONMESSAGE_GET_TASKID,n._requestTaskId,a);case 27:if(i=e.sent){e.next=36;break}if(!u.Detail||!u.Domain){e.next=32;break}return n._lic_callback&&n._lic_callback(u),e.abrupt("return");case 32:return e.next=34,n._cbToGetTaskId(u,zr.ONMESSAGE_GET_EVENT_TASKID,n._requestTaskId,a);case 34:(i=e.sent)&&(c=!0);case 36:if(o=n._tasks[i]){e.next=46;break}if(!c){e.next=42;break}o={},e.next=44;break;case 42:return""!=i&&Zo.log("invalid task id: "+i),e.abrupt("return");case 44:e.next=48;break;case 46:if(!o.timedout){e.next=48;break}return e.abrupt("return");case 48:return e.next=50,n._cbToGetTaskId(r,zr.HANDLE_RAW_MESSAGE,n._requestTaskId,o.ctx);case 50:if((l=e.sent)!==undefined){e.next=55;break}return e.next=54,n._cbToGetTaskId(u,zr.HANDLE_PROCESSED_MESSAGE,n._requestTaskId,o.ctx);case 54:l=e.sent;case 55:l&&!c&&(o.tmid&&clearTimeout(o.tmid),delete n._tasks[i],o.resolver&&o.resolver.resolve(l)),e.next=64;break;case 58:e.prev=58,e.t0=e["catch"](1),Zo.debug("failed to handle message."),e.t0 instanceof Error?Zo.error(e.t0):Zo.error(Wt.stringify(e.t0)),delete n._tasks[i],null===(f=o)||void 0===f||null===(f=f.resolver)||void 0===f||f.reject(e.t0.message);case 64:case"end":return e.stop()}}),e,null,[[1,58]])})))).apply(this,arguments)}function ai(e,t,r){return si.apply(this,arguments)}function si(){return(si=Bo(Mo().mark((function e(t,r,n){var o,i;return Mo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r,e.next=e.t0===zr.GET_TASKID?3:e.t0===zr.HANDLE_RAW_MESSAGE?7:9;break;case 3:return(i=Ro(t)).cmdId=null!==(o=i.cmdId)&&void 0!==o?o:(n=void 0,a=void 0,a=[ko(8),"-",ko(4),"-",ko(4),"-",ko(4),"-",ko(8)],n&&a.unshift(n),a.join("")),Lt.Promise.resolve(["cmdId"]),e.abrupt("break",9);case 7:return Lt.Promise.resolve(t),e.abrupt("break",9);case 9:case"end":return e.stop()}var n,a}),e)})))).apply(this,arguments)}function ui(e,t,r,n){return ci.apply(this,arguments)}function ci(){return ci=Bo(Mo().mark((function e(t,r,n,o){var i,a,s,u;return Mo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.connected&&!this.disposed){e.next=2;break}return e.abrupt("return");case 2:if(!(s=this)._connectPromise){e.next=7;break}return e.next=6,s._connectPromise;case 6:return e.abrupt("return");case 7:return r=null!==(i=r)&&void 0!==i?i:this._defaultRetries,n=null!==(a=n)&&void 0!==a?a:100,u=zo(ei,s,ri).call(s,s.serverInfo),Zo.debug("WebSocket URL: "+u+", try to create websocket "+r+"/"+n),s._connectPromise=new Lt.Promise((function(e,t){var i=function(n){zo(ei,s,ni).call(s,s,u,s.serverInfo.protocol,o).then((function(t){e(t)}))["catch"]((function(e){Zo.debug("create websocket failed: "+e.message),n<r?a(n):t(e)}))};function a(e,t,r){setTimeout((function(){i(++e)}),n)}i(0)})),e.prev=12,e.next=15,s._connectPromise;case 15:e.next=20;break;case 17:throw e.prev=17,e.t0=e["catch"](12),e.t0;case 20:return e.prev=20,s._connectPromise=null,e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[12,17,20,23]])}))),ci.apply(this,arguments)}function li(e,t,r,n){return fi.apply(this,arguments)}function fi(){return(fi=Bo(Mo().mark((function e(t,r,n,o){var i,a,s,u;return Mo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this,a=n.eventTaskId,s=n.lastEventTaskId,a!==undefined){e.next=7;break}return e.next=6,r(t,zr.GET_EVENT_TASKID,i._requestTaskId,n);case 6:a=e.sent;case 7:a&&(i._tasks[a]?n&&n.userData&&n.userData.command&&((u=i._tasks[a]).ctx=n,s&&((u=i._tasks[s]).ctx=n)):(u={id:o.id,resolver:null,ctx:n,timedout:!1},i._tasks[a]=u,s&&(i._tasks[s]=u)));case 8:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function hi(e,t,r,n,o,i,a){return di.apply(this,arguments)}function di(){return(di=Bo(Mo().mark((function e(t,r,n,o,i,a,s){var u,c,l,f;return Mo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=this,e.prev=1,n.client=u,e.next=5,zo(ei,u,ui).call(u,i,o,a,s);case 5:if("0"!=(c=n.taskId)){e.next=12;break}return u.disposed||u._ws.send(t),t=null,e.abrupt("return");case 12:if(c!==undefined){e.next=16;break}return e.next=15,r(t,zr.GET_TASKID,null,n);case 15:c=e.sent;case 16:return c===undefined&&Zo.debug("websocket send: task id is invalid."),(l={}).promise=new Lt.Promise((function(e,t){l.resolve=e,l.reject=t})),f={id:c,resolver:l,ctx:n,timedout:!1},u._tasks[c]=f,u._requestTaskId=c,e.next=24,zo(ei,u,li).call(u,t,r,n,f);case 24:return u._cbToGetTaskId=r,s&&(f.tmid=setTimeout((function(){Zo.debug("ws request time out."),f.timedout=!0,f.resolver.reject("request timed out.")}),s)),u.disposed||u._ws.send(t),Zo.debug("end to send task "+c),t=null,e.abrupt("return",l.promise);case 32:if(e.prev=32,e.t0=e["catch"](1),c&&delete u._tasks[c],!(e.t0 instanceof Ur||e.t0&&e.t0.code&&e.t0.message)){e.next=39;break}throw e.t0;case 39:if(!e.t0.message){e.next=41;break}throw new Ur(e.t0.message);case 41:return e.prev=41,t=null,e.finish(41);case 44:case"end":return e.stop()}}),e,this,[[1,32,41,44]])})))).apply(this,arguments)}function pi(e){return pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pi(e)}function gi(){gi=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof T?t:T,a=Object.create(i.prototype),s=new L(n||[]);return o(a,"_invoke",{value:C(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",d="suspendedYield",p="executing",g="completed",m={};function T(){}function v(){}function y(){}var b={};c(b,a,(function(){return this}));var S=Object.getPrototypeOf,_=S&&S(S(D([])));_&&_!==r&&n.call(_,a)&&(b=_);var w=y.prototype=T.prototype=Object.create(b);function I(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(o,i,a,s){var u=f(e[o],e,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==pi(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function C(t,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var c=f(t,r,n);if("normal"===c.type){if(o=n.done?g:d,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=g,n.method="throw",n.arg=c.arg)}}}function A(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function W(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(W,this),this.reset(!0)}function D(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(pi(t)+" is not iterable")}return v.prototype=y,o(w,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:v,configurable:!0}),v.displayName=c(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},I(E.prototype),c(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},I(w),c(w,u,"Generator"),c(w,a,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function o(){for(;r.length;){var e=r.pop();if(e in t)return o.value=e,o.done=!1,o}return o.done=!0,o}},t.values=D,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:D(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function mi(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Ti(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ti(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r["return"]||r["return"]()}finally{if(s)throw i}}}}function Ti(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function vi(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function yi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_i(n.key),n)}}function bi(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Si(e,t,r){return(t=_i(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _i(e){var t=function(e,t){if("object"!=pi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=pi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pi(t)?t:t+""}function wi(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}Ao=ti;var Ii=new WeakSet,Ei=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),bi(this,Ii),Si(this,"_maxWebSocketCon",10),Si(this,"_wsClients",[])}return t=e,r=[{key:"removeTerminatedWSClient",value:function(){this._wsClients=this._wsClients.filter((function(e){return!e.disposed}))}},{key:"getClient",value:function(e,t){return e.useWS?wi(Ii,this,Ai).call(this,e,t):new Lo(e)}},{key:"closeClient",value:(o=gi().mark((function a(e){var t,r,n,o;return gi().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t=this._wsClients,r=mi(t),i.prev=2,r.s();case 4:if((n=r.n()).done){i.next=12;break}if(!Dr((o=n.value).serverInfo,e)){i.next=10;break}if(o.disposed){i.next=10;break}return i.next=10,o.dispose();case 10:i.next=4;break;case 12:i.next=17;break;case 14:i.prev=14,i.t0=i["catch"](2),r.e(i.t0);case 17:return i.prev=17,r.f(),i.finish(17);case 20:this.removeTerminatedWSClient();case 21:case"end":return i.stop()}}),a,this,[[2,14,17,20]])})),i=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=o.apply(e,t);function a(e){vi(i,r,n,a,s,"next",e)}function s(e){vi(i,r,n,a,s,"throw",e)}a(void 0)}))},function(e){return i.apply(this,arguments)})},{key:"terminate",value:function(){var e=this._wsClients.slice();this._wsClients=[],e.forEach((function(e){e.dispose()}))}}],n=[{key:"Instance",get:function(){return this._gClientPool||(this._gClientPool=new e),this._gClientPool}}],r&&yi(t.prototype,r),n&&yi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n,o,i}();function Ci(e){this.removeTerminatedWSClient();var t,r=mi(this._wsClients);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(Dr(n.serverInfo,e)&&!n.disposed)return n.addRef(),n}}catch(o){r.e(o)}finally{r.f()}return null}function Ai(e,t){var r;return t||(r=wi(Ii,this,Ci).call(this,e)),r||(this._wsClients.length<this._maxWebSocketCon?((r=new ti(e)).addEvent("disposed","1",(function(){Qo.Instance.removeTerminatedWSClient()})),this._wsClients.push(r),r):null)}function Wi(e){Wt.log(e)}Qo=Ei,Si(Ei,"_gClientPool",null),Lt.ClientPool=Ei;var Pi="Checking Product Key format...",Li=function(e){return e.CM_RENDERALL=1,e.CM_IMAGEONLY=2,e.CM_AUTO=3,e.CM_RENDERALLWITHANNOTATION=4,e}({});function Di(e){return Di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Di(e)}function Oi(){Oi=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof T?t:T,a=Object.create(i.prototype),s=new L(n||[]);return o(a,"_invoke",{value:C(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",d="suspendedYield",p="executing",g="completed",m={};function T(){}function v(){}function y(){}var b={};c(b,a,(function(){return this}));var S=Object.getPrototypeOf,_=S&&S(S(D([])));_&&_!==r&&n.call(_,a)&&(b=_);var w=y.prototype=T.prototype=Object.create(b);function I(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(o,i,a,s){var u=f(e[o],e,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==Di(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function C(t,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var c=f(t,r,n);if("normal"===c.type){if(o=n.done?g:d,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=g,n.method="throw",n.arg=c.arg)}}}function A(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function W(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(W,this),this.reset(!0)}function D(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Di(t)+" is not iterable")}return v.prototype=y,o(w,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:v,configurable:!0}),v.displayName=c(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},I(E.prototype),c(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},I(w),c(w,u,"Generator"),c(w,a,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function o(){for(;r.length;){var e=r.pop();if(e in t)return o.value=e,o.done=!1,o}return o.done=!0,o}},t.values=D,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:D(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function xi(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function Ni(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){xi(i,n,o,a,s,"next",e)}function s(e){xi(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Ri(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fi(n.key),n)}}function ki(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Fi(e){var t=function(e,t){if("object"!=Di(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Di(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Di(t)?t:t+""}function Mi(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var Gi=Nt+".",Bi=parseInt(Nt),Ui={ActiveX:0,Plugin:1,HTML5:2,WinMacLinux:3,Barcode1D:4,Barcode2D:5,BarcodeWriter:6,OCR:7,Webcam:8,PDFRasterizer:9,OCRPro:10,QR:50,PDF417:51,DataMatrix:52};function ji(e){return Wt.isString(e)?Wt.trim(e):e}var Hi=new WeakSet,Vi=function(){return t=function a(){var e,t,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),ki(this,Hi),e=this,r=Zr,(t=Fi(t="isLTS"))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r},r=[{key:"isLongKey",value:function(e){if(Wt.isString(e)&&e.length>0){var t=e.charAt(0);if("f"==t||"t"==t)return!0;if(Wt.startsWith(e,"DLS"))return!1;if(Wt.isNumber(e))return!1;var r=parseInt(e)+"-";return!Wt.startsWith(e,r)}return!1}},{key:"isLicenseMixed",value:function(e,t){var r,n=!1,o=e||xt.DWT.ProductKey;if(xt.DWT.lclex(),t&&(ji(xt.DWT.organizationID)||ji(xt.DWT.handshakeCode))&&o&&(n=!0,tn(r={},-2444,"A license can only be specified once and has already been set using the ProductKey API.")),!n&&Wt.isString(o))if(o=Wt.trim(o),Wt.startsWith(o,"f")||Wt.startsWith(o,"t"));else if(""==o);else if(Wt.startsWith(o,"DLS2"))try{Mi(Hi,this,Xi).call(this,o)}catch(a){n=!0,tn(r={},-2440,""),r._errorString=a.message}else Mi(Hi,this,Ki).call(this,o).LTS||(n=!0,function(e){tn(e,en.LicenseParseFailed,"The license is invalid.")}(r={}));if(n&&r){rn(r);var i=xt.DWT.licenseException;Wt.error(i.message)}return n}},{key:"getLicenseFromDynamsoftCore",value:function(){var t=null;if(K.bSSL){var r,n;if(e.mapPackageRegister&&e.mapPackageRegister.license)t=null===(n=e.mapPackageRegister.license.LicenseManager)||void 0===n?void 0:n.license;else if(null!==(r=window)&&void 0!==r&&null!==(r=r.Dynamsoft)&&void 0!==r&&null!==(r=r.Core)&&void 0!==r&&null!==(r=r.mapPackageRegister)&&void 0!==r&&r.license){var o;t=null===(o=window.Dynamsoft.Core.mapPackageRegister.license.LicenseManager)||void 0===o?void 0:o.license}if(Wt.isString(t))return Wt.trim(t)}return t}},{key:"initLicenseFromDynamsoftCore",value:(i=Ni(Oi().mark((function s(){var t,r,n;return Oi().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!K.bSSL){o.next=11;break}if(!e.mapPackageRegister||!e.mapPackageRegister.license){o.next=7;break}return o.next=4,e.mapPackageRegister.license.getAR();case 4:t=o.sent,o.next=11;break;case 7:if(null===(r=window)||void 0===r||null===(r=r.Dynamsoft)||void 0===r||null===(r=r.Core)||void 0===r||null===(r=r.mapPackageRegister)||void 0===r||!r.license){o.next=11;break}return o.next=10,window.Dynamsoft.Core.mapPackageRegister.license.getAR();case 10:t=o.sent;case 11:t&&((n={}).workWithOtherProduct=!0,n.ar=t.ar,n.cu=t.u,n.bPublicTrial=t.pt,t.pk?(this._innerResetLicense(),nr.refProductKey=t.pk,n.isDLS=!1):(n.isDLS=!0,xt.DWT.lsdt(xt.DWT.EnumInstance.dwt_browser),xt.DWT.lsmid(n.cu,""),xt.DWT.lsar(n.ar,"")));case 12:case"end":return o.stop()}}),s,this)}))),function(){return i.apply(this,arguments)})},{key:"preParseProductKey",value:(o=Ni(Oi().mark((function u(t){var r,n,o,i,a;return Oi().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(r=null,n=!1,i=null,r=this.getLicenseFromDynamsoftCore(),!Wt.isString(r)){s.next=38;break}if(!this.isLongKey(r)){s.next=8;break}i=r,s.next=38;break;case 8:if(!e.mapPackageRegister||!e.mapPackageRegister.license){s.next=14;break}return s.next=11,e.mapPackageRegister.license.getAR();case 11:o=s.sent,s.next=18;break;case 14:if(null===(a=window)||void 0===a||null===(a=a.Dynamsoft)||void 0===a||null===(a=a.Core)||void 0===a||null===(a=a.mapPackageRegister)||void 0===a||!a.license){s.next=18;break}return s.next=17,window.Dynamsoft.Core.mapPackageRegister.license.getAR();case 17:o=s.sent;case 18:if(""!==r){s.next=28;break}if(!o){s.next=26;break}return nr.bUseDynamsoftLicenseManager=!0,this._innerResetLicense(),nr.refProductKey="",nr.bPublicLTS=!0,nr.handshakeCode="200001",s.abrupt("return");case 26:s.next=38;break;case 28:if(!o){s.next=38;break}if(!o.pk){s.next=36;break}return this._innerResetLicense(),nr.refProductKey=o.pk,nr.bPublicLTS=!1,s.abrupt("return");case 36:nr.bUseDynamsoftLicenseManager=!0,nr.refProductKey!==r&&(n=!0);case 38:!n&&this.isLicenseMixed(i,!0)||this.reparseProductKey(t);case 39:case"end":return s.stop()}}),u,this)}))),function(e){return o.apply(this,arguments)})},{key:"reparseProductKey",value:function(e){e&&Wi("Parsing Product Key...");var t=this.getLicenseFromDynamsoftCore(),r=!1;if(null===t){var n=ji(xt.DWT.organizationID),o=ji(xt.DWT.handshakeCode),i=n||o;if(t=Wt.trim(xt.DWT.ProductKey),!i){var a=Mi(Hi,this,Ki).call(this,t);a.LTS&&(o=ji(a.handshakeCode),i=(n=ji(a.organizationID))||o)}if(i)return this._innerResetLicense(),Wt.isNumber(t)&&(n=t),nr.handshakeCode=o,nr.organizationID=n,nr.licenseServer=xt.DWT.licenseServer,nr.sessionPassword=xt.DWT.sessionPassword,void(nr.bPublicLTS=Mi(Hi,this,Yi).call(this,nr.licenseServer,i))}if(nr.refProductKey!==t&&(this._innerResetLicense(),Wt.isString(t)&&t.length>0&&(nr.refProductKey=t,r=!0)),r)if(this.isLongKey(nr.refProductKey))nr.bPublicLTS=!1;else{var s,u={_pLoad:{isEmpty:ur},_license:nr.refProductKey,_licenseServer:[]};try{s=Lr(u)}catch(l){Wt.error(l),s=!1}if(s&&Wt.isString(s.l)){var c=Wt.trim(s.l);""==c?(c="200001",nr.organizationID=c,nr.handshakeCode=c):(-1!=c.indexOf("-")||(nr.organizationID=c),nr.handshakeCode=c),Wt.isArray(s.ls)&&s.ls.length>0&&(nr.licenseServer=s.ls),nr.bPublicLTS=Mi(Hi,this,Yi).call(this,nr.licenseServer,c),nr.sessionPassword=s.sp}else nr.bPublicLTS=!1,s&&Wt.isNumber(s.l)&&(nr.handshakeCode=""+s.l)}}},{key:"_innerResetLicense",value:function(){nr.refProductKey="",nr.handshakeCode=undefined,nr.organizationID=undefined,nr.licenseServer=undefined,nr.sessionPassword="",nr.bPublicLTS=!0}},{key:"checkOSForAllowCore",value:function(e,t,r){if(nr.bHTML5Edition){if(e)return Mi(Hi,this,$i).call(this,t);var n=r._bRemoteMode,o=r.__serverPlatform;return this.isOSOK(t,n,o)}return ur}},{key:"checkLocalPlatformForRemoteService",value:function(e){var t,r,n,o=e.__licenseInfo,i=Qt.getEnumPlatform(),a=!1;for(t=0;t<o.Detail.length;t++)if(r=o.Detail[t],(n=Mi(Hi,this,Qi).call(this,r.EnumLicenseType,r.LicenseType)).Core&&Wt.isString(r.Version)&&0==r.Version.indexOf(Gi)){if(a=Mi(Hi,this,$i).call(this,r.OS))break;if(a=this.isOSOK(r.OS,!0,i))break;if(!e._blts&&e._bScanForProxyRemote&&n.RemoteScan)break}return a||(i==zt.enumWindow?function(e){tn(e,-2344,"The current product key does not support Windows OS. "+nn()),rn(e)}(e):i==zt.enumLinux?function(e){tn(e,-2346,"The current product key does not support Linux OS. "+nn()),rn(e)}(e):i==zt.enumMac?function(e){tn(e,-2345,"The current product key does not support MAC OS. "+nn()),rn(e)}(e):function(e){tn(e,-2347,"The current product key does not support your OS. "+nn()),rn(e)}(e)),a}},{key:"checkProductKey",value:function(e,t,r){var n,o=xt.DWT.licenseException;return!t.Camera&&(e.__licenseInfo||(e.__licenseInfo={}),(n=Mi(Hi,this,zi).call(this,e,e.__licenseInfo,sr,t,r))||(o.code=e._errorCode,o.message=e._getErrorString(),o.fromLTS=!1),n)}},{key:"isBindDomainOK",value:function(e){if(Wt.isUndefined(e)||null==e||""==e||"*"==e||"*.*"==e)return ur;var t=location.hostname,r=sr;if(""==t)return ur;for(var n=t.toLowerCase().split("."),o=n.length,i=e.toLowerCase().split(";"),a=0;a<i.length;a++){var s=i[a];if("*.*"==s){r=ur;break}var u=s.split("."),c=u.length;if(c>0&&c-1<=o){for(var l=ur,f=c-1;f>0;f--){if(u[f].indexOf("*")>-1){r=ur;break}if(f+o-c>=0){if(n[f+o-c]!=u[f]){l=sr;break}}else if("*"!=u[f]){l=sr;break}}if(l&&("*"==u[0]||o>=c&&n[o-c]==u[0])){r=ur;break}}}return r}},{key:"isExpiredOrFuture",value:function(e,t){if(""==e)return sr;if(!t){var r=e.length;if(r>2&&"/"==e[r-2]&&"0"==e[r-1])return sr}var n=ta(e),o=(new Date).getTime(),i=o+5184e6;return n.getTime()<o||t&&n.getTime()>i?ur:sr}},{key:"willTrialExpire",value:function(e){if(""==e)return sr;var t=ta(e),r=(new Date).getTime();return t.getTime()<r+432e6&&t.getTime()>r?ur:sr}},{key:"isOSOK",value:function(e,t,r){var n=!1,o=!1,i=!1,a=!1,s=!1,u=!1,c=!1,l=!1;return""==e||"0"==e?ur:(t?r==zt.enumWindow?i=!0:r==zt.enumLinux?o=!0:r==zt.enumMac?n=!0:r==zt.enumEmbed?s=!0:r==zt.enumChromeOS?u=!0:r==zt.enumAndroid?c=!0:r==zt.enumHarmonyOS?l=!0:r==zt.enumiOS&&(a=!0):(n=K.bMac,o=K.bLinux,i=K.bWin,a=K.biPhone||K.biPad,u=K.bChromeOS,s=xt.navInfo.bEmbed,c=K.bAndroid,l=K.bHarmonyOS),(e=e.toLowerCase()).indexOf("windows")>-1&&i||e.indexOf("mac")>-1&&n||e.indexOf("linux")>-1&&(o||u||l)||e.indexOf("android")>-1&&c||e.indexOf("ios")>-1&&a||e.indexOf("embed")>-1&&s?ur:sr)}},{key:"isBrowserOK",value:function(e){if(Wt.isString(e)){if(""==e||"0"==e)return ur;var t=(e=e.toLowerCase()).split(";"),r=sr;return Wt.each(t,(function(e){("chrome"==Wt.trim(e)&&(K.bChrome||K.bSafari||K.bOpera||K.bEdge)||"ie"==Wt.trim(e)&&K.bIE||"firefox"==Wt.trim(e)&&K.bFirefox)&&(r=ur)})),r}return sr}},{key:"isAllowLicenseType",value:function(e,t){return t.Core?e.Core:t.PDFRasterizer?e.PDFRasterizer:t.Webcam||t.Camera?e.Webcam:t.barcode1D?e.barcode1D:t.QR?e.QR:t.PDF417?e.PDF417:t.DataMatrix?e.DataMatrix:t.OCR?e.OCR:t.OCRPro?e.OCRPro:e.Core}},{key:"setNoAllowedLicenseTypeError",value:function(e,t,r){r.Core?ln(e):r.Webcam||r.Camera?t||r.Camera?function(e){e._errorCode=-2431,Zr()?e._errorString="The license for the Camera Addon is not found or has expired.":tn(e,-2431,"The current product key does not support Camera Addon. "+nn()),rn(e)}(e):function(e){e._errorCode=-2338,Zr()?e._errorString="The license for the module direct show is not found or has expired.":e._errorString="The current product key does not support Webcam. "+nn(),rn(e)}(e):r.PDFRasterizer?t?function(e){e._errorCode=-2370,Zr()?e._errorString="The license for the module pdf rasterizer is not found or has expired.":e._errorString="The current product key does not support Pdf Rasterizer Wasm. "+nn(),rn(e)}(e):fn(e):r.OCR?function(e){e._errorCode=-2340,Zr()?e._errorString="The license for the module ocr is not found or has expired.":e._errorString="The current product key does not support OCR. "+nn(),rn(e)}(e):r.OCRPro?function(e){e._errorCode=-2341,Zr()?e._errorString="The license for the module ocr pro is not found or has expired.":e._errorString="The current product key does not support OCR pro. "+nn(),rn(e)}(e):un(e)}},{key:"getLicenseDateString",value:function(e){var t,r=e.getFullYear();return[(t=e.getMonth()+1)>=10?""+t:"0"+t,"/",e.getDate()>=10?""+e.getDate():"0"+e.getDate(),"/",r].join("")}},{key:"hasPDFRProductKey",value:function(e){return!!this.checkProductKey(e,{PDFRasterizer:!0},!0)||(e._resetErr(),!1)}},{key:"checkPDFProductKeyWhenNeeds",value:function(e,t){var r;return t!=xt.DWT.EnumDWT_ImageType.IT_PDF&&t!=xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF||(nr.bHTML5Edition?e.__addon&&e.__addon.PDF&&(r=e._getConvertMode()):e.Addon&&e.Addon.PDF&&(r=e._getConvertMode()),r!=Li.CM_RENDERALL&&r!=Li.CM_RENDERALLWITHANNOTATION)?ur:this.checkProductKey(e,{PDFRasterizer:!0},!0)}},{key:"getPublicLicenseContent",value:function(e){var t=[],r=e;if(!Wt.isString(r)){if(Wt.isUndefined(r))return"";r=r instanceof Error||"message"in r?r.message:""+r}var n=r.indexOf("["),o=r.indexOf("]",n),i=r.indexOf("(",o),a=r.indexOf(")",i);if(-1==n||-1==o||-1==i||-1==a)return r;n>0&&t.push(r.substring(0,n));var s=r.substring(n+1,o),u=r.substring(i+1,a);return t.push(['<a href="',u,'" target="_blank" class="dynamsoft-major-color">',s,"</a>"].join("")),t.push(r.substring(a+1)),t.join("")}},{key:"getLTSLicense",value:function(){return nr.bPublicLTS?"":nr.handshakeCode||nr.organizationID}}],r&&Ri(t.prototype,r),n&&Ri(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n,o,i}();function Ki(e){var t,r,n=e,o=e.indexOf("-"),i=-1!=o;return r={},i&&(n=e.substring(0,o)),t=Number(n),isNaN(t)||String(Number(t))!==n||(i?r.handshakeCode=e:r.organizationID=e,r.LTS=ur),r}function Xi(e){Lr({_pLoad:{isEmpty:ur},_license:e,_licenseServer:[]})}function Yi(e,t){var r=!0;if(Wt.isArray(e)&&e.length>0){var n=e[0];if(Wt.isString(n)&&""!=n)"mlts.dynamsoft.com"!==new On(n).getHostname()&&(r=!1)}return r&&(!t||"200001"===t||Wt.startsWith(t,"200001-"))}function Ji(e,t,r){return this.checkOSForAllowCore(e,t,r)}function zi(e,t,r,n,o){var i,a=!1;if(nr.bHTML5Edition&&Wt.isFunction(e._needCheckProxyRemoteScanLicense)&&(a=e._needCheckProxyRemoteScanLicense()),t&&t.LTS){if(!t||!Wt.isArray(t.Detail)||0==t.Detail.length)return this.isLTS()?ln(e):un(e),sr}else if(!t||!Wt.isArray(t.Detail)||0==t.Detail.length)return this.isLTS()?ln(e):un(e),sr;var s,u,c,l,f=0,h=0,d=[],p=[],g=sr,m=sr,T=sr,v=sr,y=sr;if(!this.isBindDomainOK(t.Domain))return function(e){tn(e,-2342,"The domain of your current site does not match the domain bound in the current product key. "+nn()),rn(e)}(e),sr;for(t.Detail.length>0&&(i="FALSE"!=(c=t.Detail[0]).Trial),u=1;u<t.Detail.length;u++)if("FALSE"==(c=t.Detail[u]).Trial&&i||"TRUE"==c.Trial&&!i)return Tn(e),sr;if(t.bTrial=i,n.Core||n.Webcam){var b=[],S=!1;for(u=0;u<t.Detail.length;u++)if(c=t.Detail[u],l=Mi(Hi,this,Qi).call(this,c.EnumLicenseType,c.LicenseType),n.Core&&l.Core&&this.checkOSForAllowCore(r,c.OS,e)||n.Core&&l.Core&&nr.bActiveXEdition&&l.ActiveX||n.Webcam&&l.Webcam&&!r){if(t.LTS);else if(!Wt.isString(c.Version)||0!=c.Version.indexOf(Gi)){b.push(c);continue}if(nr.bHTML5Edition){if(l.ActiveX&&!l.Html5)continue;if(a&&!l.RemoteScan)continue;p.push(c)}else{if(!l.ActiveX&&l.Html5)continue;p.push(c)}S=!0}if(!S&&b.length>0)return b.splice(0),function(e,t){var r=nn();tn(e,en.LicenseVersionNotCurrent,"The current product key is not for version ".concat(t,". ").concat(r)),rn(e)}(e,[Nt,Rt,kt].join(".")),!1;b.splice(0)}else p=t.Detail;for(u=0;u<p.length;u++){var _=ur;if(c=p[u],l=Mi(Hi,this,Qi).call(this,c.EnumLicenseType,c.LicenseType),n.Core&&l.Core||this.isAllowLicenseType(l,n)){s=c.ExpireDate.replace(/-/g,"/");var w="FALSE"!=c.Trial;if(this.isExpiredOrFuture(s,w))d.push(s);else if(w&&l.Core&&this.willTrialExpire(s)&&(t.ExpireDate=s),t.LTS||l.Core&&nr.bHTML5Edition&&parseInt(c.Version)>=Bi||l.Core&&nr.bActiveXEdition||!l.Core){var I=!1;if(l.Core)(this.checkOSForAllowCore(r,c.OS,e)||nr.bActiveXEdition&&l.ActiveX)&&(I=!0);else{var E=r;n.Camera&&(E=!0),Mi(Hi,this,Ji).call(this,E,c.OS,e)&&(I=!0)}I?this.isBrowserOK(c.Browser)||o?(f++,_=sr):m=ur:n.Core?g=ur:n.PDFRasterizer?v=ur:(n.Webcam||n.Camera)&&(y=ur)}else T=ur;_&&h++}}if(f>0)return ur;if(0==h)return this.setNoAllowedLicenseTypeError(e,r,n),sr;if(d.length>0){var C,A=0,W=1e20,P="",L=(new Date).getTime();for(s="",u=0;u<d.length;u++)(C=ta(d[u])).getTime()<L&&C.getTime()>A?(A=C.getTime(),s=d[u]):C.getTime()>L&&C.getTime()<W&&(W=C.getTime(),P=d[u]);return""!=s?(C=ta(s),cn(e,s=this.getLicenseDateString(C))):""!=P?(C=ta(P),P=this.getLicenseDateString(C),function(e,t){tn(e,en.LicenseIsFuture,"The current product key is invalid. "+nn()),rn(e)}(e)):cn(e,""),sr}return T?(function(e){tn(e,-2348,"The current product key is invalid because it's generated with the licenses of a different major version."),rn(e)}(e),sr):m?(K.bEdge?function(e){tn(e,-2330,"The current product key does not support Edge. "+nn()),rn(e)}(e):K.bChrome?function(e){tn(e,-2327,"The current product key does not support Chrome. "+nn()),rn(e)}(e):K.bFirefox?function(e){tn(e,-2328,"The current product key does not support Firefox. "+nn()),rn(e)}(e):K.bIE?function(e){tn(e,-2329,"The current product key does not support IE. "+nn()),rn(e)}(e):K.bSafari?function(e){tn(e,-2392,"The current product key does not support Safari. "+nn()),rn(e)}(e):function(e){tn(e,-2343,"The current product key does not support your browser. "+nn()),rn(e)}(e),sr):g?(this.setNoAllowedLicenseTypeError(e,r,{Core:!0}),sr):v?(this.setNoAllowedLicenseTypeError(e,r,{PDFRasterizer:!0}),sr):y?(this.setNoAllowedLicenseTypeError(e,r,{Webcam:!0}),sr):(un(e),sr)}function qi(e){var t=sr,r=sr,n=sr,o=sr,i=sr,a=sr,s=sr,u=sr,c=sr;return Wt.isString(e)&&""!=e&&Wt.each(e.split(";"),(function(e){var l=1*e;l==Ui.HTML5||l==Ui.WinMacLinux||l==Ui.ActiveX||l==Ui.Plugin?t=ur:l==Ui.Barcode1D?r=ur:l==Ui.QR?n=ur:l==Ui.PDF417?o=ur:l==Ui.DataMatrix?i=ur:l==Ui.OCR?a=ur:l==Ui.Webcam?s=ur:l==Ui.PDFRasterizer?u=ur:l==Ui.OCRPro&&(c=ur)})),{Core:t,PDFRasterizer:u,Webcam:s,barcode1D:r,QR:n,PDF417:o,DataMatrix:i,OCR:a,OCRPro:c}}function Qi(e,t){var r=Mi(Hi,this,qi).call(this,e),n=Mi(Hi,this,Zi).call(this,t);return Wt.each(["Core","Html5","RemoteScan","LocalScan","ActiveX","PDFRasterizer","Webcam","barcode1D","QR","PDF417","DataMatrix","OCR","OCRPro"],(function(e){r[e]=r[e]||n[e]})),r}function Zi(e){var t=sr,r=sr,n=sr,o=sr,i=sr,a=sr,s=sr,u=sr,c=sr,l=sr,f=sr,h=sr,d=sr;return e&&""!=e&&((e=e.toLowerCase()).indexOf("html5")>-1||"win=(aph) or mac=(ph) or linux(h)"==e?(t=ur,e.indexOf("html5;activex;oldie")>-1?o=ur:e.indexOf("html5;activex")>-1?(r=ur,d=ur,o=ur):(r=ur,d=ur),e.indexOf(";remotescan")>-1&&(r=ur,h=ur,e.indexOf(";onlyremote")>-1&&(d=sr))):"1d barcode reader"==e?n=ur:"2d barcode reader(qrcode)"==e?i=ur:"2d barcode reader(pdf417)"==e?a=ur:"2d barcode reader(data matrix)"==e?s=ur:"ocr"==e?u=ur:"webcam"==e?c=ur:"pdf rasterizer"==e?l=ur:"proocr"==e&&(f=ur)),{Core:t,Html5:r,RemoteScan:h,LocalScan:d,ActiveX:o,PDFRasterizer:l,Webcam:c,barcode1D:n,QR:i,PDF417:a,DataMatrix:s,OCR:u,OCRPro:f}}function $i(e){var t=e.toLowerCase();return t.indexOf("wasm")>-1||t.indexOf("mobile")>-1}var ea=new Vi;function ta(e){var t,r=e;return r=r.replace(/-/g,"/"),t=Date.parse(r),isNaN(t)&&(t=0),(t=new Date(t)).setHours(23,59,59,999),t}function ra(e){var t=xt.DWT.licenseException;t.code=e.code,t.message=e.message,e&&(!function(e){Wt.isFunction(xt.DWT.OnWebTwainError)?xt.DWT.OnWebTwainError(e):Wt.isFunction(window.Dynamsoft_OnError)&&window.Dynamsoft_OnError(e)}(e),e instanceof Error?Wt.error(e):Wt.error(Wt.stringify(e)))}function na(e){var t=0,r=e.message;Wt.isNumber(e.code)?t=e.code:Wt.isString(r)&&(t=-1),0!=t&&function(e,t){Wt.isFunction(xt.OnLicenseError)&&xt.OnLicenseError(t,e)}(t,r)}function oa(e){na(function(e){return{code:e._errorCode,message:e._errorString}}(e))}xt.DWT.isPublicLicense=function(){return nr.bPublicLTS};var ia=K.bWin,aa=K.bMac,sa=K.bLinux,ua=K.bSafari,ca=K.bFirefox,la=K.bChrome,fa=location.hostname,ha=location.pathname,da=0,pa=K.bMobile,ga=parseFloat(K.strBrowserVersion);if(K.bWin||K.bMac||K.bLinux||K.bChromeOS){if(xt.navInfo){var ma=xt.navInfo;pa=pa||ma.bAndroid||ma.bPad||ma.biPhone||ma.biPad}}else pa=!0;""===fa?ia&&ha.lastIndexOf("\\")>1?ha=ha.substring(1,ha.lastIndexOf("\\")).replace(/%20/g," "):(da=1,ha=ha.substring(1,ha.lastIndexOf("/")).replace(/%20/g," ")):(da=1,ha=ha.substring(0,ha.lastIndexOf("/")));var Ta={bChrome:la,bFirefox:ca,bSafari:ua,bIE:K.bIE,bEdge:K.bEdge,bWin:ia,bMac:aa,bLinux:sa,iPluginLength:0,bFileSystem:K.bFileSystem,bMobile:pa,strIEVersion:K.IEVersion,strChromeVersion:K.bChrome?ga:"",strFirefoxVersion:K.bFirefox?ga:"",basePath:ha,pathType:da,isDesktopViewer:function(){return K.bWin||K.bLinux||K.bChromeOS||K.bMac},isPadViewer:function(){return K.bPad||K.biPad},isMobileViewer:function(){return K.bMobile||K.biPhone||K.bAndroid||K.bHarmonyOS},WSVersion:"18.5.0",WSSession:(new Date).getTime(),bDiscardBlankImage:sr};function va(e){return va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},va(e)}function ya(){ya=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof T?t:T,a=Object.create(i.prototype),s=new L(n||[]);return o(a,"_invoke",{value:C(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",d="suspendedYield",p="executing",g="completed",m={};function T(){}function v(){}function y(){}var b={};c(b,a,(function(){return this}));var S=Object.getPrototypeOf,_=S&&S(S(D([])));_&&_!==r&&n.call(_,a)&&(b=_);var w=y.prototype=T.prototype=Object.create(b);function I(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(o,i,a,s){var u=f(e[o],e,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==va(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function C(t,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var c=f(t,r,n);if("normal"===c.type){if(o=n.done?g:d,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=g,n.method="throw",n.arg=c.arg)}}}function A(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function W(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(W,this),this.reset(!0)}function D(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(va(t)+" is not iterable")}return v.prototype=y,o(w,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:v,configurable:!0}),v.displayName=c(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},I(E.prototype),c(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},I(w),c(w,u,"Generator"),c(w,a,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function o(){for(;r.length;){var e=r.pop();if(e in t)return o.value=e,o.done=!1,o}return o.done=!0,o}},t.values=D,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:D(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function ba(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}Lt.product=nr;var Sa={encodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeChars:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1]},_a=self||window;Lt.btoa=function(e){for(var t,r,n=String(e),o=0,i=Sa.encodeChars,a="";n.charAt(0|o)||(i="=",o%1);a+=i.charAt(63&t>>8-o%1*8)){if((r=n.charCodeAt(o+=3/4))>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|r}return a},_a.btoa||(_a.btoa=Lt.btoa),Lt.atob=function(e){var t=String(e).replace(/[=]+$/,"");if(t.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,o=0,i=0,a="";n=t.charAt(i++);~n&&(r=o%4?64*r+n:n,o++%4)?a+=String.fromCharCode(255&r>>(-2*o&6)):0)n=Sa.encodeChars.indexOf(n);return a},_a.atob||(_a.atob=Lt.atob);var wa={isFunction:function(e){return e&&"function"==typeof e},isReturnSuccess:function(e){if(-2115===e._errorCode)return ur;if(-2003===e._errorCode&&!xt.DWT.IfHttpPostErrorNoWindow){var t=window.open("","ErrorMessage","height=500,width=750,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no");null==t||t.document.writeln(e.HTTPPostResponseString)}return 0==e._errorCode?ur:sr},setErrorString:function(e){e._errorCode=e.getSWebTwain().ErrorCode,e._errorString=e.getSWebTwain().ErrorString},checkErrorString:function(e){return wa.setErrorString(e),wa.isReturnSuccess(e)},wrapperRet:function(e,t,r,n,o,i){if(wa.checkErrorString(e)){if(wa.isFunction(r))if(o){var a=e.getSWebTwain().HTTPPostResponseString;a&&""!=a?(e._errorCode=-2003,e._errorString="HTTP process error.",Lt.isFunction(n)&&n(e._errorCode,e._errorString,a)):r(a)}else{if(i)return r(t),!0;r()}}else wa.isFunction(n)&&(o?n(e._errorCode,e._errorString,e.getSWebTwain().HTTPPostResponseString):n(e._errorCode,e._errorString));return t},wrapperPromise:function(e,t){return wa.setErrorString(e),0==e._errorCode?Lt.Promise.resolve(t):Lt.Promise.reject({code:e._errorCode,message:e._errorString})},getImageType:function(e){if(e===undefined)return-1;if(e.length<4)return-1;var t=e.lastIndexOf(".");if(-1===t)return-1;var r=e.slice(t).toLowerCase();return".bmp"===r||".dib"===r?xt.DWT.EnumDWT_ImageType.IT_BMP:".jpg"===r||".jpe"===r||".jpeg"===r||".jfif"===r?xt.DWT.EnumDWT_ImageType.IT_JPG:".tif"===r||".tiff"===r?xt.DWT.EnumDWT_ImageType.IT_TIF:".png"===r?xt.DWT.EnumDWT_ImageType.IT_PNG:".pdf"===r?xt.DWT.EnumDWT_ImageType.IT_PDF:".jp2"===r||".j2k"===r||".j2c"===r?xt.DWT.EnumDWT_ImageType.IT_J2K:-1},replaceLocalFilename:function(e){var t=e;return K.bFileSystem&&(t=decodeURI(t)),t},makeParams:function(){var e=arguments;return e===undefined||0===e.length?undefined:e}};Lt.checkErrorString=wa.checkErrorString,Lt.wrapperRet=wa.wrapperRet,Lt.setErrorString=wa.setErrorString,Lt.DynamicLoadAddonFuns=[],Lt.attachAddon=function(e){if(K.bWin){var t,r=!xt.navInfo.bOSx64||xt.navInfo.bWOW64,n=e.getSWebTwain();t=r?"DynamicPdfCore_"+Yt.ActiveXPdfVersion+".dll":"DynamicPdfCorex64_"+Yt.ActiveXPdfVersion+".dll";try{n.GetAddOnVersion("pdf",t)["catch"]((function(){}))}catch(Tu){}Lt.each(Lt.DynamicLoadAddonFuns,(function(t){Lt.isFunction(t)&&t(e)}))}};Lt.attachProperty=function(e){var t=e,r=function(e,r,n){var o;0!==r&&1!==r?o=r:(o={},r&&(o.set=1==n?function(r){return r*=1,!Lt.isNumber(r)||isNaN(r)?(sn(t),sr):(t.getSWebTwain()[e]=r,wa.checkErrorString(t))}:2==n?function(r){return Lt.isBoolean(r)?(t.getSWebTwain()[e]=r,wa.checkErrorString(t)):(sn(t),sr)}:function(r){return Lt.isString(r)?(t.getSWebTwain()[e]=r,wa.checkErrorString(t)):(sn(t),sr)})),o.get||(o.get=function(){var r=t.getSWebTwain()[e];return t._errorCode=t.getSWebTwain().ErrorCode,t._errorString=t.getSWebTwain().ErrorString,r}),e in t||Object.defineProperty(t,e,o)};r("ErrorCode",{get:function(e){return t._errorCode}}),r("ErrorString",{get:function(e){return t._errorString}}),r("LogLevel",{get:function(){var e=t.getSWebTwain().LogLevel;return t._errorCode=t.getSWebTwain().ErrorCode,t._errorString=t.getSWebTwain().ErrorString,e},set:function(e){var r=1*e;return!Lt.isNumber(r)||isNaN(r)?(sn(t),sr):(t.getSWebTwain().LogLevel=r,wa.checkErrorString(t))}}),r("Manufacturer",1),r("ProductFamily",1),r("ProductKey",{get:function(){return xt.DWT.ProductKey},set:function(e){var r=ur,n=e;if(n=Lt.isString(n)?Lt.trim(n):"",xt.DWT.ProductKey=n,ea.reparseProductKey(),t.__licenseInfo=undefined,""==n)r=sr,ea.checkProductKey(t,{Core:ur},sr)||oa(t);else{var o=xt.DWT.licenseException;if(0!=o.code)return t._errorCode=o.code,t._errorString=o.message,r;t.__licenseInfo=undefined,t.GetLicenseInfo(n),r=wa.checkErrorString(t)}return r}}),r("ProductName",1),r("VersionInfo",1),r("BitDepth",1,1),r("Brightness",1,1),r("Contrast",1,1),r("CurrentSourceName",0),r("DataSourceStatus",0),r("DefaultSourceName",0),r("Duplex",0),r("IfAppendImage",1,2),r("IfAutoBright",1,2),r("IfAutoDiscardBlankpages",1,2),r("IfAutoFeed",1,2),r("IfAutomaticBorderDetection",1,2),r("IfAutomaticDeskew",1,2),r("IfAutoScan",1,2),r("IfDisableSourceAfterAcquire",1,2),r("IfDuplexEnabled",1,2),r("IfFeederEnabled",1,2),r("IfModalUI",1,2),r("IfScanInNewThread",1,2),r("IfSortBySelectionOrder",1,2),r("IfShowCancelDialogWhenImageTransfer",1,2),r("IfShowUI",1,2),r("IfShowIndicator",1,2),r("IfUseTwainDSM",1,2),r("IfFeederLoaded",0,2),r("IfPaperDetectable",0,2),r("IfUIControllable",0,2),r("ImageBitsPerPixel",0),r("ImageCaptureDriverType",1,1),r("ImageLayoutDocumentNumber",0),r("ImageLayoutFrameBottom",0),r("ImageLayoutFrameLeft",0),r("ImageLayoutFrameNumber",0),r("ImageLayoutFrameRight",0),r("ImageLayoutFrameTop",0),r("ImageLayoutPageNumber",0),r("ImageLength",0),r("ImagePixelType",0),r("ImageWidth",0),r("ImageXResolution",0),r("ImageYResolution",0),r("MagData",0),r("MagType",0),r("PageSize",1,1),r("PendingXfers",0),r("PixelFlavor",1,1),r("PixelType",1,1),r("Resolution",1,1),r("SourceCount",0),r("TransferMode",1,1),r("Unit",1,1),r("XferCount",1,1),r("Capability",1,1),r("CapCurrentIndex",1,1),r("CapCurrentValue",1,1),r("CapDefaultIndex",0),r("CapDefaultValue",0),r("CapDescription",1),r("CapMaxValue",1,1),r("CapMinValue",1,1),r("CapNumItems",1,1),r("CapStepSize",1,1),r("CapType",1,1),r("CapValue",1,1),r("CapValueString",1),r("CapValueType",1,1),r("AllowMultiSelect",1,2),r("BackgroundColor",1,1),r("BackgroundFillColor",1,1),r("BlankImageCurrentStdDev",0),r("BlankImageMaxStdDev",1,1),r("BlankImageThreshold",1,1),r("CurrentImageIndexInBuffer",{set:function(e){return e!=t.getSWebTwain().CurrentImageIndexInBuffer&&(t.getSWebTwain().CurrentImageIndexInBuffer=e),wa.checkErrorString(t)}}),r("FitWindowType",1,1),r("HowManyImagesInBuffer",0),r("IfFitWindow",1,2),r("ImageMargin",1,1),r("MaxImagesInBuffer",1,1),r("MouseX",0),r("MouseY",0),r("SelectionImageBorderColor",1),r("Zoom",1,1),r("MouseShape",1,2),r("SelectedImagesIndices",{get:function(){for(var e=[],r=t.getSWebTwain().SelectedImagesCount,n=0;n<r;n++)e.push(t.getSWebTwain().GetSelectedImageIndex(n));return e}}),r("HTTPPostResponseString",0),r("AsyncMode",1,2),r("FTPPassword",1),r("FTPPort",{set:function(e){return""!==e?(e*=1,t.getSWebTwain().FTPPort=e,wa.checkErrorString(t)):sr}}),r("FTPUserName",1),r("HTTPPort",{set:function(e){return""!==e?(e*=1,t.getSWebTwain().HTTPPort=e,wa.checkErrorString(t)):(e=Lt.detect.ssl?443:80,t.getSWebTwain().HTTPPort=e,wa.checkErrorString(t))}}),r("HTTPPassword",1),r("HTTPUserName",1),r("IfPASVMode",1,2),r("IfShowProgressBar",1,2),r("ProxyServer",1),r("IfShowFileDialog",1,2),r("IfTiffMultiPage",1,2),r("PDFAuthor",1),r("PDFCompressionType",1,1),r("PDFCreationDate",1),r("PDFCreator",1),r("PDFKeywords",1),r("PDFModifiedDate",1),r("PDFProducer",1),r("PDFSubject",1),r("PDFTitle",1),r("PDFVersion",1),r("TIFFCompressionType",1,1),r("JPEGQuality",{set:function(e){return(e*=1)>=100?e=100:e<0&&(e=0),t.getSWebTwain().JPEGQuality=e,wa.checkErrorString(t)}}),r("HttpContentTypeFieldValue",1),r("SelectionRectAspectRatio",1,1),r("IfAllowLocalCache",1,2),r("_AutoCropMethod",1,2),r("BrokerProcessType",1,1),r("BorderStyle",1,1),r("IfShowPrintUI",1,2),r("VScrollBar",1,2),r("EnableInteractiveZoom",1,2),r("ImageEditorIfEnableEnumerator",1,2),r("ImageEditorIfReadonly",1,2),r("ImageEditorIfModal",1,2),r("ImageEditorWindowTitle",1),r("IfSSL",1,2),r("AllowPluginAuthentication",1,2),r("HttpFieldNameOfUploadedImage",1),r("MaxInternetTransferThreads",1,1),r("MaxUploadImageSize",1,1),r("IfOpenImageWithGDIPlus",1,2),r("BufferMemoryLimit",1,1),r("Width",{get:function(){return t.getSWebTwain().style.width},set:function(e){return t._ChangeWidth(e),wa.checkErrorString(t)}}),r("Height",{get:function(){return t.getSWebTwain().style.height},set:function(e){return t._ChangeHeight(e),wa.checkErrorString(t)}}),r("IfThrowException",1,2),r("IfAutoScroll",1,2),r("ShowPageNumber",{get:function(){return sr},set:function(e){return sr}}),r("UseLocalService",{get:function(){return!0}})},Lt.attachMethod=function(e){var t=e,r=function(e){return ea.checkProductKey(t,{Core:ur})?ur:(Lt.isFunction(e)&&e(t.ErrorCode,t.ErrorString),sr)},n=function(e,r){return ea.checkPDFProductKeyWhenNeeds(t,e)?ur:(Lt.isFunction(r)&&r(t.ErrorCode,t.ErrorString),sr)},o=function(e,t){return 0!=e.HowManyImagesInBuffer||(function(e){tn(e,-1035,"There is no image.")}(e),Lt.isFunction(t)&&t(e.ErrorCode,e.ErrorString),!1)},i=function(e,t,r){return!!o(e,r)&&(!(isNaN(t)||!Lt.isNumber(t)||t<0||t>=e.HowManyImagesInBuffer)||(dn(e),Lt.isFunction(r)&&r(e.ErrorCode,e.ErrorString),!1))};e.UnregisterEvent=function(e,r){if(!Lt.isString(e))return gn(t),!1;if("onwsmessage"===e.toLowerCase())return gn(t),!1;if("OnPostAllTransfers"===e)return t.__OnPostAllTransfers=null,!0;if("OnBufferChanged"===e)return t.__OnBufferChanged=null,!0;if("OnBitmapChanged"===e)return t.__OnBitmapChanged=null,!0;t.getSWebTwain().UnregisterEvent(e,(function(){}));var n=["__",e].join("");return t[n]=null,wa.checkErrorString(t)},e.RegisterEvent=function(e,r){if(Lt.isUndefined(e))return tn(t,-2314,"The parameter cannot be empty."),!1;if(!Lt.isString(e)||Lt.isString(e)&&0==e.trim().length||Lt.isUndefined(r)||!Lt.isFunction(r))return mn(t),!1;if(!Lt.isString(e))return gn(t),!1;var n=e.toLowerCase();if("onwsmessage"===n)return gn(t),!1;if(Lt.isFunction(r)){if("onpostalltransfers"===n)return t.__OnPostAllTransfers=r,!0;if("onbufferchanged"===n)return t.__OnBufferChanged=r,!0;if("onbitmapchanged"===n)return t.__OnBitmapChanged=r,!0;var o=["__",e].join("");return t[o]=r,t.getSWebTwain().RegisterEvent(e,r),wa.checkErrorString(t)}return!0},e.onEvent=function(e,r){return t.RegisterEvent(e,r)},e.on=function(e,r){return t.RegisterEvent(e,r)},e.CancelAllPendingTransfers=function(){return t.getSWebTwain().CancelAllPendingTransfers(),wa.checkErrorString(t)},e.CloseSource=function(){return t.getSWebTwain().CloseSource(),wa.checkErrorString(t)},e.CloseSourceManager=function(){return t.getSWebTwain().CloseSourceManager(),wa.checkErrorString(t)},e.DisableSource=function(){return t.getSWebTwain().DisableSource(),wa.checkErrorString(t)},e.FeedPage=function(){return t.getSWebTwain().FeedPage(),wa.checkErrorString(t)},e.GetDeviceType=function(){var e=t.getSWebTwain().GetDeviceType();return wa.setErrorString(t),e},e.GetSourceNameItems=function(e){var r=t.getSWebTwain().GetSourceNameItems(e);return wa.setErrorString(t),r},e.SourceNameItems=function(e){var r=t.getSWebTwain().GetSourceNameItems(e);return wa.setErrorString(t),r},e.GetSourceNames=function(){var r,n,o=[];for(r=t.getSWebTwain().SourceCount,n=0;n<r;n++){var i=e.GetSourceNameItems(n);o.push(i)}return o},e.GetSourceType=function(e){var r=t.getSWebTwain().GetSourceType(e);return wa.setErrorString(t),r},e.OpenSource=function(){return t.getSWebTwain().OpenSource(),wa.checkErrorString(t)},e.OpenSourceManager=function(){return t.getSWebTwain().OpenSourceManager(),wa.checkErrorString(t)},e.ResetImageLayout=function(){return t.getSWebTwain().ResetImageLayout(),wa.checkErrorString(t)},e.RewindPage=function(){return t.getSWebTwain().RewindPage(),wa.checkErrorString(t)},e.SelectSource=function(e,r){return Lt.isUndefined(e)?(t.getSWebTwain().SelectSource(),wa.checkErrorString(t)):(t.getSWebTwain().SelectSource(),wa.checkErrorString(t)?(Wt.isFunction(e)&&e(),!0):(Wt.isFunction(r)&&r(),!1))},e.SelectSourceByIndex=function(e){return t.getSWebTwain().SelectSourceByIndex(e),wa.checkErrorString(t)},e.CloseSourceAsync=function(){return wa.wrapperPromise(t,t.CloseSource())},e.CloseSourceManagerAsync=function(){return wa.wrapperPromise(t,t.CloseSourceManager())},e.GetSourceNamesAsync=function(){return wa.wrapperPromise(t,t.GetSourceNames())},e.GetSourceTypeAsync=function(e){return wa.wrapperPromise(t,t.GetSourceType(e))},e.OpenSourceAsync=function(){return wa.wrapperPromise(t,t.OpenSource())},e.OpenSourceManagerAsync=function(){return wa.wrapperPromise(t,t.OpenSourceManager())},e.SelectSourceAsync=function(e){return!e||e&cr.TWAINSCANNER||e&cr.WIATWAINSCANNER?wa.wrapperPromise(t,t.SelectSource()):(mn(t),Lt.Promise.reject({code:t._errorCode,message:t._errorString}))},e.SelectSourceByIndexAsync=function(e){return wa.wrapperPromise(t,t.SelectSourceByIndex(e))},e.SetFileXferInfo=function(e,r){var n=wa.replaceLocalFilename(e);return t.getSWebTwain().SetFileXferInfo(n,r),wa.checkErrorString(t)},e.SetImageLayout=function(e,r,n,o){return t.getSWebTwain().SetImageLayout(e,r,n,o),wa.checkErrorString(t)},e.CapGet=function(){var e=t.getSWebTwain().CapGet();return wa.setErrorString(t),e},e.CapGetCurrent=function(){var e=t.getSWebTwain().CapGetCurrent();return wa.setErrorString(t),e},e.CapGetDefault=function(){var e=t.getSWebTwain().CapGetDefault();return wa.setErrorString(t),e},e.CapGetFrameBottom=function(e){var r=t.getSWebTwain().CapGetFrameBottom(e);return wa.setErrorString(t),r},e.CapGetFrameLeft=function(e){var r=t.getSWebTwain().CapGetFrameLeft(e);return wa.setErrorString(t),r},e.CapGetFrameRight=function(e){var r=t.getSWebTwain().CapGetFrameRight(e);return wa.setErrorString(t),r},e.CapGetFrameTop=function(e){var r=t.getSWebTwain().CapGetFrameTop(e);return wa.setErrorString(t),r},e.CapGetHelp=function(){var e=t.getSWebTwain().CapGetHelp();return wa.setErrorString(t),e},e.CapGetLabel=function(){var e=t.getSWebTwain().CapGetLabel();return wa.setErrorString(t),e},e.CapGetLabels=function(){var e=t.getSWebTwain().CapGetLabels();return wa.setErrorString(t),e},e.CapIfSupported=function(e){var r=t.getSWebTwain().CapIfSupported(e);return wa.setErrorString(t),r},e.CapReset=function(){return t.getSWebTwain().CapReset(),wa.checkErrorString(t)},e.CapSet=function(){return t.getSWebTwain().CapSet(),wa.checkErrorString(t)},e.CapSetFrame=function(e,r,n,o,i){return t.getSWebTwain().CapSetFrame(e,r,n,o,i),wa.checkErrorString(t)},e.GetCapItems=function(e){var r=t.getSWebTwain().GetCapItems(e);return wa.setErrorString(t),r},e.GetCapItemsString=function(e){var r=t.getSWebTwain().GetCapItemsString(e);return wa.setErrorString(t),r},e.SetCapItems=function(e,r){return t.getSWebTwain().SetCapItems(e,r),wa.checkErrorString(t)},e.SetCapItemsString=function(e,r){return t.getSWebTwain().SetCapItemsString(e,r),wa.checkErrorString(t)},e.AddText=function(e,r,n,o,i,a,s,u){var c=parseInt(e);return isNaN(c)||c<0||c>=t.HowManyImagesInBuffer?(dn(t),!1):(t.getSWebTwain().AddText(c,r,n,o,i,a,s,u),wa.checkErrorString(t))},e.CreateTextFont=function(e,r,n,o,i,a,s,u,c,l,f,h,d,p){return t.getSWebTwain().CreateTextFont(e,r,n,o,i,a,s,u,c,l,f,h,d,p),wa.checkErrorString(t)},e.CopyToClipboard=function(e){var r=parseInt(e);return isNaN(r)||r<0||r>=t.HowManyImagesInBuffer?(dn(t),!1):(t.getSWebTwain().CopyToClipboard(r),wa.checkErrorString(t))},e.Erase=function(e,r,n,o,i,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=t.HowManyImagesInBuffer?(dn(t),Lt.isFunction(s)&&s(t.ErrorCode,t.ErrorString),!1):(u=t.getSWebTwain().Erase(c,r,n,o,i),wa.wrapperRet(t,u,a,s))},e.GetImageBitDepth=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=t.HowManyImagesInBuffer)return dn(t),!1;var n=t.getSWebTwain().GetImageBitDepth(r);return wa.setErrorString(t),n},e.GetImageWidth=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=t.HowManyImagesInBuffer)return dn(t),!1;var n=t.getSWebTwain().GetImageWidth(r);return wa.setErrorString(t),n},e.GetImageHeight=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=t.HowManyImagesInBuffer)return dn(t),!1;var n=t.getSWebTwain().GetImageHeight(r);return wa.setErrorString(t),n},e.GetImageSize=function(e,r,n){var o=parseInt(e);if(isNaN(o)||o<0||o>=t.HowManyImagesInBuffer)return dn(t),!1;var i=t.getSWebTwain().GetImageSize(o,r,n);return wa.setErrorString(t),i},e.GetImageSizeWithSpecifiedType=function(e,r){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return dn(t),!1;var o=t.getSWebTwain().GetImageSizeWithSpecifiedType(n,r);return wa.setErrorString(t),o},e.GetImageXResolution=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=t.HowManyImagesInBuffer)return dn(t),!1;var n=t.getSWebTwain().GetImageXResolution(r);return wa.setErrorString(t),n},e.GetImageYResolution=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=t.HowManyImagesInBuffer)return dn(t),!1;var n=t.getSWebTwain().GetImageYResolution(r);return wa.setErrorString(t),n},e.CopyToClipboardAsync=function(e){return wa.wrapperPromise(t,t.CopyToClipboard(e))},e.EraseAsync=function(e,r,n,o,i){return wa.wrapperPromise(t,t.Erase(e,r,n,o,i))},e.GetImageBitDepthAsync=function(e){return wa.wrapperPromise(t,t.GetImageBitDepth(e))},e.GetImageWidthAsync=function(e){return wa.wrapperPromise(t,t.GetImageWidth(e))},e.GetImageHeightAsync=function(e){return wa.wrapperPromise(t,t.GetImageHeight(e))},e.GetImageSizeAsync=function(e,r,n){return wa.wrapperPromise(t,t.GetImageSize(e,r,n))},e.GetImageSizeWithSpecifiedTypeAsync=function(e,r){return wa.wrapperPromise(t,t.GetImageSizeWithSpecifiedType(e,r))},e.GetImageXResolutionAsync=function(e){return wa.wrapperPromise(t,t.GetImageXResolution(e))},e.GetImageYResolutionAsync=function(e){return wa.wrapperPromise(t,t.GetImageYResolution(e))},e.SelectAllImages=function(){var e,r=t.getSWebTwain().HowManyImagesInBuffer,n=[];for(t.getSWebTwain().SelectedImagesCount=r,e=0;e<r;e++)t.getSWebTwain().SetSelectedImageIndex(e,e),n.push(e);return wa.checkErrorString(t),n},e.SelectImages=function(e){var r=e.length;t.getSWebTwain().SelectedImagesCount=r;for(var n=0;n<r;n++)t.getSWebTwain().SetSelectedImageIndex(n,e[n]);return wa.checkErrorString(t)},e.GetSelectedImagesSize=function(e){var r=t.getSWebTwain().GetSelectedImagesSize(e);return wa.setErrorString(t),r},e.GetSkewAngle=function(e,r,n){var o,i=parseInt(e);return isNaN(i)||i<0||i>=t.HowManyImagesInBuffer?(dn(t),Lt.isFunction(n)&&n(t.ErrorCode,t.ErrorString),!1):(o=t.getSWebTwain().GetSkewAngle(i),wa.wrapperRet(t,o,r,n,!1,!0))},e.GetSkewAngleEx=function(e,r,n,o,i,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=t.HowManyImagesInBuffer?(dn(t),Lt.isFunction(s)&&s(t.ErrorCode,t.ErrorString),!1):(u=t.getSWebTwain().GetSkewAngleEx(c,r,n,o,i),wa.wrapperRet(t,u,a,s))},e.IsBlankImage=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=t.HowManyImagesInBuffer)return dn(t),!1;var n=t.getSWebTwain().IsBlankImage(r);return wa.setErrorString(t),n},e.IsBlankImageEx=function(e,r,n,o,i,a){var s=parseInt(e);if(isNaN(s)||s<0||s>=t.HowManyImagesInBuffer)return dn(t),!1;var u=t.getSWebTwain().IsBlankImageEx(s,r,n,o,i,a);return wa.setErrorString(t),u},e.Mirror=function(e,r,n){var o,i=parseInt(e);return isNaN(i)||i<0||i>=t.HowManyImagesInBuffer?(dn(t),Lt.isFunction(n)&&n(t.ErrorCode,t.ErrorString),!1):(o=t.getSWebTwain().Mirror(i),wa.wrapperRet(t,o,r,n))},e.OverlayRectangle=function(e,r,n,o,i,a,s){return t.getSWebTwain().OverlayRectangle(e,r,n,o,i,a,s),wa.checkErrorString(t)},e.RemoveAllImages=function(){var e;return t.getSWebTwain().RemoveAllImages(),(e=wa.checkErrorString(t))&&t.__innerRefreshImage(),Wt.isString(t.Width)?-1==t.Width.indexOf("%")&&(t.Width=parseInt(t.Width)+2):Wt.isNumber(t.Width)&&(t.Width=t.Width+2),e},e.RemoveAllSelectedImages=function(){var e;return t.getSWebTwain().RemoveAllSelectedImages(),(e=wa.checkErrorString(t))&&t.__innerRefreshImage(),e},e.RemoveImage=function(e){var r=parseInt(e);return isNaN(r)||r<0||r>=t.HowManyImagesInBuffer?(dn(t),!1):(t.getSWebTwain().RemoveImage(r),wa.checkErrorString(t))},e.MirrorAsync=function(e){return wa.wrapperPromise(t,t.Mirror(e))},e.RemoveAllImagesAsync=function(){return wa.wrapperPromise(t,t.RemoveAllImages())},e.RemoveAllSelectedImagesAsync=function(){return wa.wrapperPromise(t,t.RemoveAllSelectedImages())},e.RemoveImageAsync=function(e){return wa.wrapperPromise(t,t.RemoveImage(e))},e.Rotate=function(e,r,n,o,i){var a,s=parseInt(e);return isNaN(s)||s<0||s>=t.HowManyImagesInBuffer?(dn(t),Lt.isFunction(i)&&i(t.ErrorCode,t.ErrorString),!1):(a=t.getSWebTwain().Rotate(s,r,n),wa.wrapperRet(t,a,o,i))},e.RotateEx=function(e,r,n,o,i,a){var s,u=parseInt(e);return isNaN(u)||u<0||u>=t.HowManyImagesInBuffer?(dn(t),Lt.isFunction(a)&&a(t.ErrorCode,t.ErrorString),!1):(s=t.getSWebTwain().RotateEx(u,r,n,o),wa.wrapperRet(t,s,i,a))},e.RotateLeft=function(e,r,n){var o,i=parseInt(e);return isNaN(i)||i<0||i>=t.HowManyImagesInBuffer?(dn(t),Lt.isFunction(n)&&n(t.ErrorCode,t.ErrorString),!1):(o=t.getSWebTwain().RotateLeft(i),wa.wrapperRet(t,o,r,n))},e.RotateRight=function(e,r,n){var o,i=parseInt(e);return isNaN(i)||i<0||i>=t.HowManyImagesInBuffer?(dn(t),Lt.isFunction(n)&&n(t.ErrorCode,t.ErrorString),!1):(o=t.getSWebTwain().RotateRight(i),wa.wrapperRet(t,o,r,n))},e.ChangeImageSize=function(e,r,n,o,i,a){var s,u=parseInt(e);return isNaN(u)||u<0||u>=t.HowManyImagesInBuffer?(dn(t),Lt.isFunction(a)&&a(t.ErrorCode,t.ErrorString),!1):r<=0||n<=0?(tn(t,-2307,"The width or height you entered is invalid."),Lt.isFunction(a)&&a(t.ErrorCode,t.ErrorString),!1):(s=t.getSWebTwain().ChangeImageSize(u,r,n,o),wa.wrapperRet(t,s,i,a))},e.Flip=function(e,r,n){var o,i=parseInt(e);return isNaN(i)||i<0||i>=t.HowManyImagesInBuffer?(dn(t),Lt.isFunction(n)&&n(t.ErrorCode,t.ErrorString),!1):(o=t.getSWebTwain().Flip(i),wa.wrapperRet(t,o,r,n))},e.Crop=function(e,r,n,o,i,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=t.HowManyImagesInBuffer?(dn(t),Lt.isFunction(s)&&s(t.ErrorCode,t.ErrorString),!1):(u=t.getSWebTwain().Crop(c,r,n,o,i),wa.wrapperRet(t,u,a,s))},e.CropToClipboard=function(e,r,n,o,i){var a=parseInt(e);return isNaN(a)||a<0||a>=t.HowManyImagesInBuffer?(dn(t),!1):(t.getSWebTwain().CropToClipboard(a,r,n,o,i),wa.checkErrorString(t))},e.CutFrameToClipboard=function(e,r,n,o,i){var a=parseInt(e);return isNaN(a)||a<0||a>=t.HowManyImagesInBuffer?(dn(t),!1):(t.getSWebTwain().CutFrameToClipboard(a,r,n,o,i),wa.checkErrorString(t))},e.CutToClipboard=function(e){var r=parseInt(e);return isNaN(r)||r<0||r>=t.HowManyImagesInBuffer?(dn(t),!1):(t.getSWebTwain().CutToClipboard(r),wa.checkErrorString(t))},e.RotateAsync=function(e,r,n){return wa.wrapperPromise(t,t.Rotate(e,r,n))},e.RotateExAsync=function(e,r,n,o){return wa.wrapperPromise(t,t.RotateEx(e,r,n,o))},e.RotateLeftAsync=function(e){return wa.wrapperPromise(t,t.RotateLeft(e))},e.RotateRightAsync=function(e){return wa.wrapperPromise(t,t.RotateRight(e))},e.ChangeImageSizeAsync=function(e,r,n,o){return wa.wrapperPromise(t,t.ChangeImageSize(e,r,n,o))},e.FlipAsync=function(e){return wa.wrapperPromise(t,t.Flip(e))},e.CropAsync=function(e,r,n,o,i){return wa.wrapperPromise(t,t.Crop(e,r,n,o,i))},e.CropToClipboardAsync=function(e,r,n,o,i){return wa.wrapperPromise(t,t.CropToClipboard(e,r,n,o,i))},e.CutFrameToClipboardAsync=function(e,r,n,o,i){return wa.wrapperPromise(t,t.CutFrameToClipboard(e,r,n,o,i))},e.CutToClipboardAsync=function(e){return wa.wrapperPromise(t,t.CutToClipboard(e))},e.InvertAsync=function(e){return wa.wrapperPromise(t,t.Invert(e))},e.Invert=function(e){var r=parseInt(e);return isNaN(r)||r<0||r>=t.HowManyImagesInBuffer?(dn(t),!1):(vn(t),!1)},e.SetDPI=function(e,r,n,o,i,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=t.HowManyImagesInBuffer?(dn(t),Lt.isFunction(s)&&s(t.ErrorCode,t.ErrorString),!1):(u=t.getSWebTwain().SetDPI(c,r,n,o,i),wa.wrapperRet(t,u,a,s))},e.SetViewMode=function(e,r){return t.getSWebTwain().SetViewMode(e,r),wa.checkErrorString(t)},e.GetViewModeH=function(){var e=t.getSWebTwain().GetViewModeH();return wa.setErrorString(t),e},e.GetViewModeV=function(){var e=t.getSWebTwain().GetViewModeV();return wa.setErrorString(t),e},e.MoveImage=function(e,r){var n=parseInt(e),o=parseInt(r);return isNaN(n)||n<0||n>=t.HowManyImagesInBuffer||isNaN(o)||o<0||o>=t.HowManyImagesInBuffer?(dn(t),!1):(t.getSWebTwain().MoveImage(n,o),wa.checkErrorString(t))},e.SwitchImage=function(e,r){var n=parseInt(e),o=parseInt(r);return isNaN(n)||n<0||n>=t.HowManyImagesInBuffer||isNaN(o)||o<0||o>=t.HowManyImagesInBuffer?(dn(t),!1):(t.getSWebTwain().SwitchImage(n,o),wa.checkErrorString(t))},e.Print=function(){return t.getSWebTwain().Print(),wa.checkErrorString(t)},e.checkErrorString=function(){return wa.isReturnSuccess(t)},e.FileExists=function(e){var r=wa.replaceLocalFilename(e),n=t.getSWebTwain().FileExists(r);return wa.setErrorString(t),n},e.SaveAllAsMultiPageTIFF=function(e,r,n){if(!o(t,n))return!1;var i,a=wa.replaceLocalFilename(e);return i=t.getSWebTwain().SaveAllAsMultiPageTIFF(a),wa.wrapperRet(t,i,r,n)},e.SaveAllAsPDF=function(e,r,n){if(!o(t,n))return!1;var i,a=wa.replaceLocalFilename(e);return i=t.getSWebTwain().SaveAllAsPDF(a),wa.wrapperRet(t,i,r,n)},e.SaveAsBMP=function(e,r,n,o){if(!i(t,r,o))return!1;var a,s=wa.replaceLocalFilename(e);return a=t.getSWebTwain().SaveAsBMP(s,r),wa.wrapperRet(t,a,n,o)},e.SaveAsJPEG=function(e,r,n,o){if(!i(t,r,o))return!1;var a,s=wa.replaceLocalFilename(e);return a=t.getSWebTwain().SaveAsJPEG(s,r),wa.wrapperRet(t,a,n,o)},e.SaveAsPDF=function(e,r,n,o){if(!i(t,r,o))return!1;var a,s=wa.replaceLocalFilename(e);return a=t.getSWebTwain().SaveAsPDF(s,r),wa.wrapperRet(t,a,n,o)},e.SaveAsPNG=function(e,r,n,o){if(!i(t,r,o))return!1;var a,s=wa.replaceLocalFilename(e);return a=t.getSWebTwain().SaveAsPNG(s,r),wa.wrapperRet(t,a,n,o)},e.SaveAsTIFF=function(e,r,n,o){if(!i(t,r,o))return!1;var a,s=wa.replaceLocalFilename(e);return a=t.getSWebTwain().SaveAsTIFF(s,r),wa.wrapperRet(t,a,n,o)},e.SaveSelectedImagesAsMultiPagePDF=function(e,r,n){var o,i=wa.replaceLocalFilename(e);return o=t.getSWebTwain().SaveSelectedImagesAsMultiPagePDF(i),wa.wrapperRet(t,o,r,n)},e.SaveSelectedImagesAsMultiPageTIFF=function(e,r,n){var o,i=wa.replaceLocalFilename(e);return o=t.getSWebTwain().SaveSelectedImagesAsMultiPageTIFF(i),wa.wrapperRet(t,o,r,n)},e.SaveSelectedImagesToBase64Binary=function(e,r){var n=t.getSWebTwain().SaveSelectedImagesToBase64Binary();return wa.wrapperRet(t,n,e,r)},e.ShowFileDialog=function(e,r,n,o,i,a,s,u){return t.getSWebTwain().ShowFileDialog(e,r,n,o,i,a,s,u),wa.checkErrorString(t)},e.FTPDownload=function(e,n,o,i){if(!r(i))return!1;var a=t.getSWebTwain().FTPDownload(e,n);return a&&Zr()&&xt.DWT.lcvrf(t),wa.wrapperRet(t,a,o,i)},e.FTPDownloadDirectly=function(e,n,o,i,a){if(!r(a))return!1;var s=t.getSWebTwain().FTPDownloadDirectly(e,n,o);return wa.wrapperRet(t,s,i,a)},e.FTPDownloadEx=function(e,o,i,a,s){if(!r(s))return!1;if(i!=xt.DWT.EnumDWT_ImageType.IT_BMP&&i!=xt.DWT.EnumDWT_ImageType.IT_JPG&&i!=xt.DWT.EnumDWT_ImageType.IT_TIF&&i!=xt.DWT.EnumDWT_ImageType.IT_PNG&&i!=xt.DWT.EnumDWT_ImageType.IT_PDF&&i!=xt.DWT.EnumDWT_ImageType.IT_J2K&&(i=-1),!n(i,s))return sr;var u=t.getSWebTwain().FTPDownloadEx(e,o,i);return wa.wrapperRet(t,u,a,s)},e.FTPUpload=function(e,n,o,i,a){if(!r(a))return!1;var s=t.getSWebTwain().FTPUpload(e,n,o);return wa.wrapperRet(t,s,i,a)},e.FTPUploadDirectly=function(e,n,o,i,a){if(!r(a))return!1;var s=t.getSWebTwain().FTPUploadDirectly(e,n,o);return wa.wrapperRet(t,s,i,a)},e.FTPUploadEx=function(e,n,o,i,a,s){if(!r(s))return!1;var u=t.getSWebTwain().FTPUploadEx(e,n,o,i);return wa.wrapperRet(t,u,a,s)},e.FTPUploadAllAsMultiPageTIFF=function(e,n,o,i){if(!r(i))return!1;var a=t.getSWebTwain().FTPUploadAllAsMultiPageTIFF(e,n);return wa.wrapperRet(t,a,o,i)},e.FTPUploadAllAsPDF=function(e,n,o,i){if(!r(i))return!1;var a=t.getSWebTwain().FTPUploadAllAsPDF(e,n);return wa.wrapperRet(t,a,o,i)},e.FTPUploadAsMultiPagePDF=function(e,r,n,o){var i=t.getSWebTwain().FTPUploadAsMultiPagePDF(e,r);return wa.wrapperRet(t,i,n,o)},e.FTPUploadAsMultiPageTIFF=function(e,r,n,o){var i=t.getSWebTwain().FTPUploadAsMultiPageTIFF(e,r);return wa.wrapperRet(t,i,n,o)},e.HTTPDownloadDirectly=function(e,n,o,i,a){if(!r(a))return!1;var s=t.getSWebTwain().HTTPDownloadDirectly(e,n,o);return wa.wrapperRet(t,s,i,a)},e.HTTPDownload=function(e,r,n,o){var i=wa.getImageType(r);return t.HTTPDownloadEx(e,r,i,n,o)},e.HTTPDownloadEx=function(e,o,i,a,s){if(!r(s))return sr;if(i!=xt.DWT.EnumDWT_ImageType.IT_BMP&&i!=xt.DWT.EnumDWT_ImageType.IT_JPG&&i!=xt.DWT.EnumDWT_ImageType.IT_TIF&&i!=xt.DWT.EnumDWT_ImageType.IT_PNG&&i!=xt.DWT.EnumDWT_ImageType.IT_PDF&&i!=xt.DWT.EnumDWT_ImageType.IT_J2K&&(i=-1),!n(i,s))return sr;var u=t.getSWebTwain().HTTPDownloadEx(e,o,i);return u&&Zr()&&xt.DWT.lcvrf(t),wa.wrapperRet(t,u,a,s)},e.HTTPDownloadThroughGet=e.HTTPDownloadEx,e.HTTPUploadThroughPostDirectly=function(e,n,o,i,a,s){if(!r(s))return!1;var u=t.getSWebTwain().HTTPUploadThroughPostDirectly(e,n,o,i);return wa.wrapperRet(t,u,a,s,!0)},e.HTTPUploadThroughPost=function(e,r,n,o,i,a){if(!Lt.isNumber(r)||isNaN(r)||r<-2)return dn(t),Lt.isFunction(a)&&a(t.ErrorCode,t.ErrorString),!1;var s=t.getSWebTwain().HTTPUploadThroughPost(e,r,n,o);return wa.wrapperRet(t,s,i,a,!0)},e.HTTPUploadThroughPostEx=function(e,r,n,o,i,a,s){if(!Lt.isNumber(r)||isNaN(r)||r<-2)return dn(t),Lt.isFunction(s)&&s(t.ErrorCode,t.ErrorString),!1;var u=t.getSWebTwain().HTTPUploadThroughPostEx(e,r,n,o,i);return wa.wrapperRet(t,u,a,s,!0)},e.ClearAllHTTPFormField=function(){return t.getSWebTwain().ClearAllHTTPFormField(),wa.checkErrorString(t)},e.SetHTTPFormField=function(e,r){return t.getSWebTwain().SetHTTPFormField(e,r),wa.checkErrorString(t)},e.HTTPUploadAllThroughPostAsMultiPageTIFF=function(e,r,n,o,i){var a;return a=t.getSWebTwain().HTTPUploadAllThroughPostAsMultiPageTIFF(e,r,n),wa.wrapperRet(t,a,o,i,!0)},e.HTTPUploadThroughPostAsMultiPageTIFF=function(e,r,n,o,i){var a;return a=t.getSWebTwain().HTTPUploadThroughPostAsMultiPageTIFF(e,r,n),wa.wrapperRet(t,a,o,i,!0)},e.HTTPUploadAllThroughPostAsPDF=function(e,r,n,o,i){var a;return a=t.getSWebTwain().HTTPUploadAllThroughPostAsPDF(e,r,n),wa.wrapperRet(t,a,o,i,!0)},e.HTTPUploadThroughPostAsMultiPagePDF=function(e,r,n,o,i){var a;return a=t.getSWebTwain().HTTPUploadThroughPostAsMultiPagePDF(e,r,n),wa.wrapperRet(t,a,o,i,!0)},e.HTTPUploadThroughPutDirectly=function(e,r,n,o,i){var a;return a=t.getSWebTwain().HTTPUploadThroughPutDirectly(e,r,n),wa.wrapperRet(t,a,o,i)},e.HTTPUploadThroughPut=function(e,r,n,o,i){var a=wa.getImageType(n);return t.HTTPUploadThroughPutEx(e,r,n,a,o,i)},e.HTTPUploadThroughPutEx=function(e,r,n,o,i,a){var s;return s=t.getSWebTwain().HTTPUploadThroughPutEx(e,r,n,o),wa.wrapperRet(t,s,i,a)},e.HTTPUploadAllThroughPutAsMultiPageTIFF=function(e,r,n,o){return t.HTTPUploadThroughPutEx(e,-1,r,2,n,o)},e.HTTPUploadThroughPutAsMultiPageTIFF=function(e,r,n,o){return t.HTTPUploadThroughPutEx(e,-2,r,2,n,o)},e.HTTPUploadAllThroughPutAsPDF=function(e,r,n,o){return t.HTTPUploadThroughPutEx(e,-1,r,4,n,o)},e.HTTPUploadThroughPutAsMultiPagePDF=function(e,r,n,o){return t.HTTPUploadThroughPutEx(e,-2,r,4,n,o)},e.ShowImageEditor=function(){return t.getSWebTwain().ShowImageEditor(),wa.checkErrorString(t)},e.SetCookie=function(e){return t.getSWebTwain().SetCookie(e),wa.checkErrorString(t)},e.LoadImageFromBase64Binary=function(e,o,i,a){if(!r())return sr;if(o!=xt.DWT.EnumDWT_ImageType.IT_BMP&&o!=xt.DWT.EnumDWT_ImageType.IT_JPG&&o!=xt.DWT.EnumDWT_ImageType.IT_TIF&&o!=xt.DWT.EnumDWT_ImageType.IT_PNG&&o!=xt.DWT.EnumDWT_ImageType.IT_PDF&&o!=xt.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!n(o))return Lt.isFunction(a)&&a(t._errorCode,t._errorString),sr;var s=t.getSWebTwain().LoadImageFromBase64Binary(e,o);return wa.setErrorString(t),s?Lt.isFunction(i)&&i():Lt.isFunction(a)&&a(t._errorCode,t._errorString),s},e.SaveSelectedImagesToBytes=function(e,r){var n=t.getSWebTwain().SaveSelectedImagesToBytes(e,r);return wa.setErrorString(t),n},e.LoadImageFromBytes=function(e,o,i){if(!r())return sr;if(i!=xt.DWT.EnumDWT_ImageType.IT_BMP&&i!=xt.DWT.EnumDWT_ImageType.IT_JPG&&i!=xt.DWT.EnumDWT_ImageType.IT_TIF&&i!=xt.DWT.EnumDWT_ImageType.IT_PNG&&i!=xt.DWT.EnumDWT_ImageType.IT_PDF&&i!=xt.DWT.EnumDWT_ImageType.IT_J2K&&(i=-1),!n(i))return sr;var a=t.getSWebTwain().LoadImageFromBytes(e,o,i);return wa.setErrorString(t),a},e.SetImageWidth=function(e,r,n,o){var i,a=parseInt(e);return isNaN(a)||a<0||a>=t.HowManyImagesInBuffer?(dn(t),Lt.isFunction(o)&&o(t.ErrorCode,t.ErrorString),!1):(i=t.getSWebTwain().SetImageWidth(a,r),wa.wrapperRet(t,i,n,o))},e.HTTPDownloadThroughPost=function(e,o,i,a,s){if(!r(s))return!1;if(i!=xt.DWT.EnumDWT_ImageType.IT_BMP&&i!=xt.DWT.EnumDWT_ImageType.IT_JPG&&i!=xt.DWT.EnumDWT_ImageType.IT_TIF&&i!=xt.DWT.EnumDWT_ImageType.IT_PNG&&i!=xt.DWT.EnumDWT_ImageType.IT_PDF&&i!=xt.DWT.EnumDWT_ImageType.IT_J2K&&(i=-1),!n(i,s))return sr;var u=t.getSWebTwain().HTTPDownloadThroughPost(e,o,i);return wa.wrapperRet(t,u,a,s)},e.SetCustomDSDataEx=function(e){return t.getSWebTwain().SetCustomDSDataEx(e),wa.checkErrorString(t)},e.SetCustomDSData=function(e){return t.getSWebTwain().SetCustomDSData(e),wa.checkErrorString(t)},e.GetCustomDSDataEx=function(){var e=t.getSWebTwain().GetCustomDSDataEx();return wa.setErrorString(t),e},e.GetCustomDSData=function(e){var r=t.getSWebTwain().GetCustomDSData(e);return wa.setErrorString(t),r},e.ChangeBitDepth=function(e,r,n){var o=parseInt(e);return isNaN(o)||o<0||o>=t.HowManyImagesInBuffer?(dn(t),!1):(t.getSWebTwain().ChangeBitDepth(o,r,n),wa.checkErrorString(t))},e.ConvertToGrayScale=function(e,r,n){var o,i=parseInt(e);return isNaN(i)||i<0||i>=t.HowManyImagesInBuffer?(dn(t),Lt.isFunction(n)&&n(t.ErrorCode,t.ErrorString),!1):(o=t.getSWebTwain().ConvertToGrayScale(e),wa.wrapperRet(t,o,r,n))},e.ShowImageEditorEx=function(e,r,n,o,i){return t.getSWebTwain().ShowImageEditorEx(e,r,n,o,i),wa.checkErrorString(t)},e.ClearTiffCustomTag=function(){return t.getSWebTwain().ClearTiffCustomTag(),wa.checkErrorString(t)},e.SetTiffCustomTag=function(e,r,n){var o=1*e;return Lt.isUndef(e)||Lt.isUndef(r)?(mn(t),!1):o<=0||o>2147483647?(tn(t,-2378,"Invalid value for the tiff tag code."),!1):(t.getSWebTwain().SetTiffCustomTag(e,r,n),wa.checkErrorString(t))},e.IsBlankImageExpress=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=t.HowManyImagesInBuffer)return dn(t),!1;var n=t.getSWebTwain().IsBlankImageExpress(r);return wa.setErrorString(t),n},e._ChangeWidth=function(e){var r,n=document.getElementById(t._strDWTInnerContainerID);if(Lt.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(r=e),!r){var o=parseInt(e);o&&o>2&&(r=o-2+"px")}return r&&(t._strWidth=r,t.getSWebTwain().style.width=r,n&&(n.style.width=r)),ur},e._ChangeHeight=function(e){var r,n=document.getElementById(t._strDWTInnerContainerID);if(Lt.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(r=e),!r){var o=parseInt(e);o&&(r=o+"px")}return r&&(t._strHeight=r,t.getSWebTwain().style.height=r,n&&(n.style.height=r)),ur},e.SetSize=function(e,t){return this._ChangeWidth(e),this._ChangeHeight(t),ur},e.SetSelectedImageArea=function(e,r,n,o,i){return t.getSWebTwain().SetSelectedImageArea(e,r,n,o,i),wa.checkErrorString(t)},e.SetVideoRotateMode=function(e){return t.getSWebTwain().SetVideoRotateMode(e),wa.checkErrorString(t)},e.SetOpenSourceTimeout=function(e){return t.getSWebTwain().SetOpenSourceTimeout(e),wa.checkErrorString(t)},e.SetHTTPHeader=function(e,t){return!1},e.GetImageURL=function(e,t,r){return""},e.GetImagePartURL=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=t.HowManyImagesInBuffer)return dn(t),"";var n=t.getSWebTwain().GetDIB(r);return wa.setErrorString(t),n},e.GetLicenseInfo=function(e){try{var r,n=!1;if(Zr())n=!0,r=t.getSWebTwain().GetLicenseInfo();else if(Lt.isString(e))if(ea.isLicenseMixed(e,!1)){var o=xt.DWT.licenseException;t._errorCode=o.code,t._errorString=o.message}else ea.isLongKey(e)?(t.getSWebTwain().ProductKey=e,r=t.getSWebTwain().GetLicenseInfo()):un(t);else un(t);if(r&&wa.checkErrorString(t)){var i=Lt.parse(r);if(i&&i.message)un(t),t._errorString=i.message,i=undefined;else if(n){if(i&&Lt.isArray(i.Detail)&&i.Detail.length>0){var a=i.Detail[0].ExpireDate;xt.DWT.lsexp(xt.DWT.EnumInstance.dwt_desktop,a,"")}i.LTS=!0}u=i,(s=t).__licenseInfo=u,function(e){e.__calic||(e.__calic=e.__licenseInfo)}(s)}else t.__licenseInfo=undefined}catch(Tu){t.__licenseInfo=undefined}var s,u;return Lt.Promise.resolve(t.__licenseInfo)},e.LoadDibFromClipboard=function(e,r){var n=t.getSWebTwain().LoadDibFromClipboard();return n&&Zr()&&xt.DWT.lcvrf(t),wa.wrapperRet(t,n,e,r)},e.LoadImage=function(e,n,o){if(!r(o))return!1;var i,a=wa.replaceLocalFilename(e);return(i=t.getSWebTwain().LoadImage(a))&&Zr()&&xt.DWT.lcvrf(t),wa.wrapperRet(t,i,n,o)},e.LoadImageEx=function(e,o,i,a){if(!r(a))return sr;if(o!=xt.DWT.EnumDWT_ImageType.IT_BMP&&o!=xt.DWT.EnumDWT_ImageType.IT_JPG&&o!=xt.DWT.EnumDWT_ImageType.IT_TIF&&o!=xt.DWT.EnumDWT_ImageType.IT_PNG&&o!=xt.DWT.EnumDWT_ImageType.IT_PDF&&o!=xt.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!n(o,a))return sr;var s,u=wa.replaceLocalFilename(e),c=o;return c==xt.DWT.EnumDWT_ImageType.IT_ALL&&(c=-1),(s=t.getSWebTwain().LoadImageEx(u,c))&&Zr()&&xt.DWT.lcvrf(t),wa.wrapperRet(t,s,i,a)},e.EnableSource=function(e,r,n){return this.AcquireImage(e,r,n),wa.checkErrorString(t)},e.AcquireImage=function(e,n,o){var i,a,s,u=t.getSWebTwain();if(Lt.isUndefined(o)&&(Lt.isFunction(e)&&Lt.isFunction(n)||Lt.isFunction(e)&&Lt.isUndefined(n)||Lt.isFunction(e)&&null==n||null==e&&Lt.isFunction(n))?(i=null,Lt.isFunction(e)&&(a=e),Lt.isFunction(n)&&(s=function(){n(t._errorCode,t._errorString)})):(i=Lt.isUndefined(e)||null==e?{}:Lt.clone(e),Lt.isFunction(n)&&(a=function(){n(i)}),Lt.isFunction(o)&&(s=function(){o(i,t._errorCode,t._errorString)})),!r(s))return!1;var c,l=!1;i!==undefined&&null!==i&&(null!=(c=i.SelectSourceByIndex)&&void 0!==c&&(u.SelectSourceByIndex(c),u.CloseSource()),u.OpenSource(),null!=(c=i.IfShowUI)&&void 0!==c&&(u.IfShowUI=c),null!=(c=i.PixelType)&&void 0!==c&&(u.PixelType=c),null!=(c=i.Resolution)&&void 0!==c&&(u.Resolution=c),null!=(c=i.IfFeederEnabled)&&void 0!==c&&(u.IfFeederEnabled=c),null!=(c=i.IfDuplexEnabled)&&void 0!==c&&(u.IfDuplexEnabled=c),null!=(c=i.IfDisableSourceAfterAcquire)&&void 0!==c&&(u.IfDisableSourceAfterAcquire=c),null!=(c=i.IfCloseSourceAfterAcquire)&&void 0!==c&&(l=!!c));return t.getSWebTwain().RegisterEvent("OnPostTransferAsync",(function(e){var r;e&&Lt.isString(e)&&(r=Lt.parse(e)),Lt.isFunction(t.__OnPostTransferAsync)&&t.__OnPostTransferAsync(r)})),t.getSWebTwain().RegisterEvent("OnPostAllTransfers",(function(){wa.checkErrorString(t)?(Zr()&&xt.DWT.lcvrf(t),Lt.isFunction(a)&&a()):Lt.isFunction(s)&&s(t._errorCode,t._errorString),Lt.isFunction(t.__OnPostAllTransfers)&&t.__OnPostAllTransfers(),l&&u.CloseSource()})),u.AcquireImage(),wa.checkErrorString(t)},e.AcquireImageAsync=function(){var e,r=(e=ya().mark((function n(e){var r;return ya().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e?Lt.clone(e):{},n.abrupt("return",new Lt.Promise((function(e,n){t.AcquireImage(r,(function(){e(!0)}),(function(){n({code:t._errorCode,message:t._errorString})}))})));case 2:case"end":return n.stop()}}),n)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){ba(i,n,o,a,s,"next",e)}function s(e){ba(i,n,o,a,s,"throw",e)}a(void 0)}))});return function(e){return r.apply(this,arguments)}}(),e.GetDevicesAsync=function(e,r,n){var o,i=null!=e?e:fr,a=null!=r&&r,s=null!=n&&n;return o=function(e,t){var r,n=[],o=t;if(Wt.isString(o)&&(o=Wt.parse(o)),Wt.isArray(o))for(r=0;r<o.length;r++){var i=Ir(o[r]);n.push(i)}for(r=0;r<n.length;r++){var a=n[r],s=a.deviceType;a.name&&(a.name=Wt.base64.decode(a.name)),s&lr&&a.deviceInfo&&wr(a.deviceInfo),a.serviceInfo=null==e?void 0:e._dmService,_r(a,null==e?void 0:e._dmService),Wt.isBoolean(a.isSystemDefaultPrinter)||(a.isSystemDefaultPrinter=!1)}return n}(null,o=t.getSWebTwain().GetDevices(i,a,s)),wa.wrapperPromise(t,o)},e.SelectDeviceAsync=function(e,r){var n,o=null!=r?r:Pr.SMF_NAME;if(t._resetErr(),!(e&&e instanceof Sr))throw mn(t),{code:t._errorCode,message:t._errorString};return n=t.getSWebTwain().SelectDevice(e.strDevice,o),wa.wrapperPromise(t,n)},e.GenerateURLForUploadData=function(e,r,n){var o=e;return o==xt.DWT.EnumDWT_ImageType.IT_ALL&&(o=-1),!0,wa.wrapperRet(t,true,r,n)},e._innerFun=function(e,r,n){var o=t.getSWebTwain(),i=o[e];return"function"==typeof i?i.apply(o,r):i},e.ActiveUI=function(e,t){},e.startScan=function(){return new Lt.Promise((function(e,t){}))},e.IndexToImageID=function(e){return e},e.ImageIDToIndex=function(e){return e},e.first=function(){return t.HowManyImagesInBuffer>0&&(t.CurrentImageIndexInBuffer=0,t.__innerRefreshImage()),ur},e.previous=function(){var e;return t.HowManyImagesInBuffer>0&&(e=t.CurrentImageIndexInBuffer)>0&&(t.CurrentImageIndexInBuffer=e-1,t.__innerRefreshImage()),ur},e.next=function(){var e,r=t.HowManyImagesInBuffer;return r>0&&(e=t.CurrentImageIndexInBuffer)>=0&&e<r-1&&(t.CurrentImageIndexInBuffer=e+1,t.__innerRefreshImage()),ur},e.last=function(){var e=t.HowManyImagesInBuffer;return e>0&&(t.CurrentImageIndexInBuffer=e-1,t.__innerRefreshImage()),ur},e.isUsingActiveX=function(){return!0},e.show=function(){return e.ShowImageEditor()},e.SetLTSInfo=function(e,r){return t.getSWebTwain().SetLTSInfo(e,r)},e.EnableBuffer=function(e){return t.getSWebTwain().Encrypt(e,0)},e.GetBuffer=function(e){return t.getSWebTwain().GetBuffer(e)},e.GetUUID=function(){return t.getSWebTwain().GetUUID()},e.__OnDispatchThumbnailEvt=function(t,r,n){1==n?Lt.isFunction(e["__"+t+"_Thumbnail"])&&("OnMouseClick"==t||"OnMouseDoubleClick"==t||"OnMouseMove"==t||"OnMouseWheel"==t||"OnKeyDown"==t?e["__"+t+"_Thumbnail"]():e["__"+t+"_Thumbnail"](r)):Lt.isFunction(e["__"+t])&&e["__"+t](r)},e._OnImageAreaSelected=function(t,r,n,o,i,a){var s="OnImageAreaSelected";1==a?Lt.isFunction(e["__"+s+"_Thumbnail"])&&e["__"+s+"_Thumbnail"](t,r,n,o,i):Lt.isFunction(e["__"+s])&&e["__"+s](t,r,n,o,i)};var a=function(e,t){(Lt.isFunction(e["__"+t])||Lt.isFunction(e["__"+t+"_Thumbnail"]))&&("OnImageAreaSelected"==t?e.getSWebTwain().RegisterEvent(t,e._OnImageAreaSelected):e.getSWebTwain().RegisterEvent(t,(function(r,n){return e.__OnDispatchThumbnailEvt(t,r,n)})))};e.getSourceCount=function(e){return vn(t),Lt.Promise.resolve(t.getSWebTwain().SourceCount)},e.GetSourceCountAsync=function(e){return vn(t),Lt.Promise.resolve(t.getSWebTwain().SourceCount)},e._resetErr=function(){this._errorCode=0,this._errorString="";var e=xt.DWT.licenseException;e.code=0,e.message=""},e._setConvertModeInner=function(e){if(!ea.checkProductKey(t,{Core:ur}))return!1;var r=1*e;return t._resetErr(),isNaN(r)||r!=Li.CM_RENDERALL&&r!=Li.CM_IMAGEONLY&&r!=Li.CM_AUTO&&r!=Li.CM_RENDERALLWITHANNOTATION?(Sn(t),!1):(t._pdfConvertMode=r,r==Li.CM_IMAGEONLY||ea.hasPDFRProductKey(t)?t._pdfOptions.convertMode=r:t._pdfOptions.convertMode=Li.CM_IMAGEONLY,t._pdfOptions.convertMode==Li.CM_IMAGEONLY||t._pdfOptions.convertMode==Li.CM_RENDERALL?t._pdfOptions.renderOptions.renderAnnotations=!1:t._pdfOptions.convertMode==Li.CM_RENDERALLWITHANNOTATION&&(t._pdfOptions.renderOptions.renderAnnotations=!0),!0)},e._setConvertMode=function(e){return!!t._setConvertModeInner(e)&&(t.getSWebTwain().SetPDFConvertMode(t._pdfOptions.convertMode),!(t._pdfOptions.convertMode==Li.CM_IMAGEONLY&&t._pdfConvertMode==Li.CM_RENDERALL||t._pdfOptions.convertMode==Li.CM_IMAGEONLY&&t._pdfConvertMode==Li.CM_RENDERALLWITHANNOTATION)||(fn(t),!1))},e._axNotSupportAsync=function(e){var t=this;return vn(t),Lt.Promise.reject({code:t.ErrorCode,message:t.ErrorString})},e.ConvertToBase64=function(e,t,r,n){var o,i,a=this,s=e;s=Lt.isArray(s)?s.join(","):-1;var u,c=a.getSWebTwain().SaveImagesToBase64(s,t,(function(e,t){o=e,i=t}));return wa.checkErrorString(a)&&(u=new Wr(null,i,o,c)),wa.wrapperRet(a,[u,e,t],(function(e){r&&r(e[0],e[1],e[2])}),n,!1,!0)},e.ConvertToBlob=function(e,t,r,n){var o=this,i=e;i=Lt.isArray(i)?i.join(","):-1;var a=o.getSWebTwain().SaveImagesToBytes(i,t,(function(e,t){}));return wa.checkErrorString(o)&&(a=window.VBArray(a).toArray()),wa.wrapperRet(o,[a,e,t],(function(e){r&&r(e[0],e[1],e[2])}),n,!1,!0)},e._checkIndices=function(e){var t,r,n=this;if(!Lt.isArray(e))return tn(n,-2358,"The type of the parameter indices must be an Array."),!1;if(0==e.length)return function(e){tn(e,-2350,"The indices cannot be empty.")}(n),!1;if(xt.DWT.ConnectWithSocket)return!0;for(t=n.HowManyImagesInBuffer,r=0;r<e.length;r++){var o=e[r];if(Lt.isUndefined(o)||null===o)return pn(n),!1;if(o=parseInt(o),isNaN(o))return an(n),!1;if(o<0||o>=t)return hn(n),!1}return!0},e.HTTPUpload=function(e,t,r,n,o,i,a){var s=this,u=t,c=i,l=a,f=arguments;if(!s._checkIndices(t))return l(s._errorCode,s._errorString),!1;if(r==xt.DWT.EnumDWT_ImageType.IT_BMP||r==xt.DWT.EnumDWT_ImageType.IT_JPG||r==xt.DWT.EnumDWT_ImageType.IT_PNG){if(t.length>1)return tn(s,-2351,"You cannot upload more than one image when the format is BMP, JPG or PNG"),l(s._errorCode,s._errorString),!1}else if(r!=xt.DWT.EnumDWT_ImageType.IT_TIF&&r!=xt.DWT.EnumDWT_ImageType.IT_PDF)return function(e){tn(e,-2362,"The image type is not supported.")}(s),l(s._errorCode,s._errorString),!1;if(Wt.isUndefined(n)||n!=xt.DWT.EnumDWT_UploadDataFormat.Binary&&n!=xt.DWT.EnumDWT_UploadDataFormat.Base64)return function(e){tn(e,-2363,"The data format is not supported.")}(s),l(t),!1;u=Lt.isArray(u)?u.join(","):-1;var h=s.IfSSL,d=s.HTTPPort,p=new On(e),g=p.scheme,m=p.port;Lt.isString(g)&&(g=g.toLowerCase()),"https"==g?(s.IfSSL=!0,s.HTTPPort=443):(s.IfSSL=!1,s.HTTPPort=80),m&&(s.HTTPPort=m);var T="RemoteFile";f.length>4&&(Lt.isFunction(o)?(c=o,f.length>5&&(l=i)):Lt.isString(o)&&(T=o));var v=s.getSWebTwain().HTTPUpload(p.hostname,u,p.path,T,r,n);return v=wa.wrapperRet(s,v,(function(e){Lt.isFunction(c)&&c(e,t,f)}),l,!0),s.IfSSL=h,s.HTTPPort=d,v},e._getConvertMode=function(){return this._pdfConvertMode},e.__innerRefreshImage=function(){var e,r=t.HowManyImagesInBuffer;r>0&&(e=t.CurrentImageIndexInBuffer,Wt.isFunction(t.__OnRefreshUI)&&t.__OnRefreshUI(e,r))},e._canConsume=function(){return e._blts},e.__OnBitmapChangedEx=function(r,n,o,i,a){var s=n,u=a;if(u>-1&&e._canConsume()&&(1==s||2==s)){var c=xt.DWT.lgct(u);Lt.isFunction(t.__OnLtsverify)&&t.__OnLtsverify(c,1)}if(Lt.isFunction(t.__OnBitmapChanged)&&t.__OnBitmapChanged(r,n,o,i),Lt.isFunction(t.__OnBufferChanged)){var l=t.CurrentImageIndexInBuffer,f={action:1==s||2==s?"add":3==s?"remove":4==s?"modify":5==s?"shift":"",currentId:l,imageIds:[],selectedIds:[]};-1!=l&&f.selectedIds.push(l),t.__OnBufferChanged(f)}},e._attachEvents=function(){var e,r=t.getSWebTwain();(e=ar(String(t.VersionInfo))).length<=2||e[0]<9||9==e[0]&&e[1]<=2||(""!=t.__OnPostTransfer&&r.RegisterEvent("OnPostTransfer",t.__OnPostTransfer),""!=t.__OnPostAllTransfers&&r.RegisterEvent("OnPostAllTransfers",t.__OnPostAllTransfers),""!=t.__OnPostLoad&&r.RegisterEvent("OnPostLoad",t.__OnPostLoad),a(t,"OnMouseClick"),a(t,"OnImageAreaSelected"),a(t,"OnTopImageInTheViewChanged"),a(t,"OnImageAreaDeSelected"),a(t,"OnMouseDoubleClick"),a(t,"OnMouseRightClick"),a(t,"OnMouseMove"),""!=t.__OnGetFilePath&&r.RegisterEvent("OnGetFilePath",t.__OnGetFilePath),""!=t.__OnAfterOperate&&r.RegisterEvent("OnAfterOperate",t.__OnAfterOperate),""!=t.__OnBeforeOperate&&r.RegisterEvent("OnBeforeOperate",t.__OnBeforeOperate),""!=t.__OnOperateStatus&&r.RegisterEvent("OnOperateStatus",t.__OnOperateStatus),r.RegisterEvent("OnBitmapChangedEx",t.__OnBitmapChangedEx),""!=t.__OnPreAllTransfers&&r.RegisterEvent("OnPreAllTransfers",t.__OnPreAllTransfers),""!=t.__OnPreTransfer&&r.RegisterEvent("OnPreTransfer",t.__OnPreTransfer),""!=t.__OnSourceUIClose&&r.RegisterEvent("OnSourceUIClose",t.__OnSourceUIClose),""!=t.__OnTransferCancelled&&r.RegisterEvent("OnTransferCancelled",t.__OnTransferCancelled),""!=t.__OnTransferError&&r.RegisterEvent("OnTransferError",t.__OnTransferError),""!=t.__OnInternetTransferPercentage&&r.RegisterEvent("OnInternetTransferPercentage",t.__OnInternetTransferPercentage),""!=t.__OnInternetTransferPercentageEx&&r.RegisterEvent("OnInternetTransferPercentageEx",t.__OnInternetTransferPercentageEx),a(t,"OnMouseWheel"),a(t,"OnKeyDown"),a(t,"OnPaintDone"))},e._isMobileMode=function(){return!1}},Lt.noControl=function(e){if(xt.DWT.IfUseEmbeddedDownloadNoticeForActiveX)!function(e,t,r,n){var o,i,a=!1;e&&(Lt.one(e).before(Lt.install._strNonInstallDIV),(o=Lt.get(Lt.install._divDWTNonInstallContainerID))&&(o.style.width=t,o.style.height=r),Lt.show(Lt.install._divDWTNonInstallContainerID),Lt.hide(e));""!=Lt.install._divDWTemessageContainer&&Lt.hide(Lt.install._divDWTemessageContainer);if(i=Qt.getDSPath(),n){if(Lt.isFunction(xt.OnWebTwainNeedUpgradeCallback)){var s={"default":i};xt.OnWebTwainNeedUpgradeCallback(Lt.product.name,s,Lt.product.bHTML5Edition,zt.enumWindow,K.bIE,K.bSafari,Lt.detect.ssl,Ta.strIEVersion)}}else Lt.isFunction(xt.OnWebTwainNotFoundOnWindowsCallback)&&xt.OnWebTwainNotFoundOnWindowsCallback(Lt.product.name,i,Lt.product.bHTML5Edition,K.bIE,K.bSafari,Lt.detect.ssl,Ta.strIEVersion,a)}(e._containerElement,e._strWidth,e._strHeight,!1);else{var t="";Lt.isFunction(xt.OnWebTwainNotFoundOnWindowsCallback)&&(t=K.bIE||Lt.product.bHTML5Edition?Qt.getDSPath():Lt.product.getMSIPath(),xt.OnWebTwainNotFoundOnWindowsCallback(xt.DWT.ProductName,t,Lt.product.bHTML5Edition,K.bIE,K.bSafari,Lt.detect.ssl,Ta.strIEVersion,!1))}};var Ia=function(e){return e.CAP_NONE=0,e.CAP_XFERCOUNT=1,e.ICAP_COMPRESSION=256,e.ICAP_PIXELTYPE=257,e.ICAP_UNITS=258,e.ICAP_XFERMECH=259,e.CAP_AUTHOR=4096,e.CAP_CAPTION=4097,e.CAP_FEEDERENABLED=4098,e.CAP_FEEDERLOADED=4099,e.CAP_TIMEDATE=4100,e.CAP_SUPPORTEDCAPS=4101,e.CAP_EXTENDEDCAPS=4102,e.CAP_AUTOFEED=4103,e.CAP_CLEARPAGE=4104,e.CAP_FEEDPAGE=4105,e.CAP_REWINDPAGE=4106,e.CAP_INDICATORS=4107,e.CAP_SUPPORTEDCAPSEXT=4108,e.CAP_PAPERDETECTABLE=4109,e.CAP_UICONTROLLABLE=4110,e.CAP_DEVICEONLINE=4111,e.CAP_AUTOSCAN=4112,e.CAP_THUMBNAILSENABLED=4113,e.CAP_DUPLEX=4114,e.CAP_DUPLEXENABLED=4115,e.CAP_ENABLEDSUIONLY=4116,e.CAP_CUSTOMDSDATA=4117,e.CAP_ENDORSER=4118,e.CAP_ALARMS=4120,e.CAP_ALARMVOLUME=4121,e.CAP_AUTOMATICCAPTURE=4122,e.CAP_TIMEBEFOREFIRSTCAPTURE=4123,e.CAP_TIMEBETWEENCAPTURES=4124,e.CAP_CLEARBUFFERS=4125,e.CAP_MAXBATCHBUFFERS=4126,e.CAP_DEVICETIMEDATE=4127,e.CAP_POWERSUPPLY=4128,e.CAP_CAMERAPREVIEWUI=4129,e.CAP_SERIALNUMBER=4132,e.CAP_PRINTER=4134,e.CAP_PRINTERENABLED=4135,e.CAP_PRINTERINDEX=4136,e.CAP_PRINTERMODE=4137,e.CAP_PRINTERSTRING=4138,e.CAP_PRINTERSUFFIX=4139,e.CAP_LANGUAGE=4140,e.CAP_FEEDERALIGNMENT=4141,e.CAP_FEEDERORDER=4142,e.CAP_REACQUIREALLOWED=4144,e.CAP_BATTERYMINUTES=4146,e.CAP_BATTERYPERCENTAGE=4147,e.CAP_CAMERASIDE=4148,e.CAP_SEGMENTED=4149,e.CAP_CAMERAENABLED=4150,e.CAP_CAMERAORDER=4151,e.CAP_MICRENABLED=4152,e.CAP_FEEDERPREP=4153,e.CAP_FEEDERPOCKET=4154,e.CAP_AUTOMATICSENSEMEDIUM=4155,e.CAP_CUSTOMINTERFACEGUID=4156,e.ICAP_AUTOBRIGHT=4352,e.ICAP_BRIGHTNESS=4353,e.ICAP_CONTRAST=4355,e.ICAP_CUSTHALFTONE=4356,e.ICAP_EXPOSURETIME=4357,e.ICAP_FILTER=4358,e.ICAP_FLASHUSED=4359,e.ICAP_GAMMA=4360,e.ICAP_HALFTONES=4361,e.ICAP_HIGHLIGHT=4362,e.ICAP_IMAGEFILEFORMAT=4364,e.ICAP_LAMPSTATE=4365,e.ICAP_LIGHTSOURCE=4366,e.ICAP_ORIENTATION=4368,e.ICAP_PHYSICALWIDTH=4369,e.ICAP_PHYSICALHEIGHT=4370,e.ICAP_SHADOW=4371,e.ICAP_FRAMES=4372,e.ICAP_XNATIVERESOLUTION=4374,e.ICAP_YNATIVERESOLUTION=4375,e.ICAP_XRESOLUTION=4376,e.ICAP_YRESOLUTION=4377,e.ICAP_MAXFRAMES=4378,e.ICAP_TILES=4379,e.ICAP_BITORDER=4380,e.ICAP_CCITTKFACTOR=4381,e.ICAP_LIGHTPATH=4382,e.ICAP_PIXELFLAVOR=4383,e.ICAP_PLANARCHUNKY=4384,e.ICAP_ROTATION=4385,e.ICAP_SUPPORTEDSIZES=4386,e.ICAP_THRESHOLD=4387,e.ICAP_XSCALING=4388,e.ICAP_YSCALING=4389,e.ICAP_BITORDERCODES=4390,e.ICAP_PIXELFLAVORCODES=4391,e.ICAP_JPEGPIXELTYPE=4392,e.ICAP_TIMEFILL=4394,e.ICAP_BITDEPTH=4395,e.ICAP_BITDEPTHREDUCTION=4396,e.ICAP_UNDEFINEDIMAGESIZE=4397,e.ICAP_EXTIMAGEINFO=4399,e.ICAP_MINIMUMHEIGHT=4400,e.ICAP_MINIMUMWIDTH=4401,e.ICAP_AUTODISCARDBLANKPAGES=4404,e.ICAP_FLIPROTATION=4406,e.ICAP_BARCODEDETECTIONENABLED=4407,e.ICAP_SUPPORTEDBARCODETYPES=4408,e.ICAP_BARCODEMAXSEARCHPRIORITIES=4409,e.ICAP_BARCODESEARCHPRIORITIES=4410,e.ICAP_BARCODESEARCHMODE=4411,e.ICAP_BARCODEMAXRETRIES=4412,e.ICAP_BARCODETIMEOUT=4413,e.ICAP_ZOOMFACTOR=4414,e.ICAP_PATCHCODEDETECTIONENABLED=4415,e.ICAP_SUPPORTEDPATCHCODETYPES=4416,e.ICAP_PATCHCODEMAXSEARCHPRIORITIES=4417,e.ICAP_PATCHCODESEARCHPRIORITIES=4418,e.ICAP_PATCHCODESEARCHMODE=4419,e.ICAP_PATCHCODEMAXRETRIES=4420,e.ICAP_PATCHCODETIMEOUT=4421,e.ICAP_FLASHUSED2=4422,e.ICAP_IMAGEFILTER=4423,e.ICAP_NOISEFILTER=4424,e.ICAP_OVERSCAN=4425,e.ICAP_AUTOMATICBORDERDETECTION=4432,e.ICAP_AUTOMATICDESKEW=4433,e.ICAP_AUTOMATICROTATE=4434,e.ICAP_JPEGQUALITY=4435,e.ICAP_FEEDERTYPE=4436,e.ICAP_ICCPROFILE=4437,e.ICAP_AUTOSIZE=4438,e.ICAP_AUTOMATICCROPUSESFRAME=4439,e.ICAP_AUTOMATICLENGTHDETECTION=4440,e.ICAP_AUTOMATICCOLORENABLED=4441,e.ICAP_AUTOMATICCOLORNONCOLORPIXELTYPE=4442,e.ICAP_COLORMANAGEMENTENABLED=4443,e.ICAP_IMAGEMERGE=4444,e.ICAP_IMAGEMERGEHEIGHTTHRESHOLD=4445,e.ICAP_SUPPORTEDEXTIMAGEINFO=4446,e}({}),Ea=function(e){return e.TWLG_DAN=0,e.TWLG_DUT=1,e.TWLG_ENG=2,e.TWLG_FCF=3,e.TWLG_FIN=4,e.TWLG_FRN=5,e.TWLG_GER=6,e.TWLG_ICE=7,e.TWLG_ITN=8,e.TWLG_NOR=9,e.TWLG_POR=10,e.TWLG_SPA=11,e.TWLG_SWE=12,e.TWLG_USA=13,e.TWLG_USERLOCALE=-1,e.TWLG_AFRIKAANS=14,e.TWLG_ALBANIA=15,e.TWLG_ARABIC=16,e.TWLG_ARABIC_ALGERIA=17,e.TWLG_ARABIC_BAHRAIN=18,e.TWLG_ARABIC_EGYPT=19,e.TWLG_ARABIC_IRAQ=20,e.TWLG_ARABIC_JORDAN=21,e.TWLG_ARABIC_KUWAIT=22,e.TWLG_ARABIC_LEBANON=23,e.TWLG_ARABIC_LIBYA=24,e.TWLG_ARABIC_MOROCCO=25,e.TWLG_ARABIC_OMAN=26,e.TWLG_ARABIC_QATAR=27,e.TWLG_ARABIC_SAUDIARABIA=28,e.TWLG_ARABIC_SYRIA=29,e.TWLG_ARABIC_TUNISIA=30,e.TWLG_ARABIC_UAE=31,e.TWLG_ARABIC_YEMEN=32,e.TWLG_BASQUE=33,e.TWLG_BYELORUSSIAN=34,e.TWLG_BULGARIAN=35,e.TWLG_CATALAN=36,e.TWLG_CHINESE=37,e.TWLG_CHINESE_HONGKONG=38,e.TWLG_CHINESE_PRC=39,e.TWLG_CHINESE_SINGAPORE=40,e.TWLG_CHINESE_SIMPLIFIED=41,e.TWLG_CHINESE_TAIWAN=42,e.TWLG_CHINESE_TRADITIONAL=43,e.TWLG_CROATIA=44,e.TWLG_CZECH=45,e.TWLG_DANISH=0,e.TWLG_DUTCH=1,e.TWLG_DUTCH_BELGIAN=46,e.TWLG_ENGLISH=2,e.TWLG_ENGLISH_AUSTRALIAN=47,e.TWLG_ENGLISH_CANADIAN=48,e.TWLG_ENGLISH_IRELAND=49,e.TWLG_ENGLISH_NEWZEALAND=50,e.TWLG_ENGLISH_SOUTHAFRICA=51,e.TWLG_ENGLISH_UK=52,e.TWLG_ENGLISH_USA=13,e.TWLG_ESTONIAN=53,e.TWLG_FAEROESE=54,e.TWLG_FARSI=55,e.TWLG_FINNISH=4,e.TWLG_FRENCH=5,e.TWLG_FRENCH_BELGIAN=56,e.TWLG_FRENCH_CANADIAN=3,e.TWLG_FRENCH_LUXEMBOURG=57,e.TWLG_FRENCH_SWISS=58,e.TWLG_GERMAN=6,e.TWLG_GERMAN_AUSTRIAN=59,e.TWLG_GERMAN_LUXEMBOURG=60,e.TWLG_GERMAN_LIECHTENSTEIN=61,e.TWLG_GERMAN_SWISS=62,e.TWLG_GREEK=63,e.TWLG_HEBREW=64,e.TWLG_HUNGARIAN=65,e.TWLG_ICELANDIC=7,e.TWLG_INDONESIAN=66,e.TWLG_ITALIAN=8,e.TWLG_ITALIAN_SWISS=67,e.TWLG_JAPANESE=68,e.TWLG_KOREAN=69,e.TWLG_KOREAN_JOHAB=70,e.TWLG_LATVIAN=71,e.TWLG_LITHUANIAN=72,e.TWLG_NORWEGIAN=9,e.TWLG_NORWEGIAN_BOKMAL=73,e.TWLG_NORWEGIAN_NYNORSK=74,e.TWLG_POLISH=75,e.TWLG_PORTUGUESE=10,e.TWLG_PORTUGUESE_BRAZIL=76,e.TWLG_ROMANIAN=77,e.TWLG_RUSSIAN=78,e.TWLG_SERBIAN_LATIN=79,e.TWLG_SLOVAK=80,e.TWLG_SLOVENIAN=81,e.TWLG_SPANISH=11,e.TWLG_SPANISH_MEXICAN=82,e.TWLG_SPANISH_MODERN=83,e.TWLG_SWEDISH=12,e.TWLG_THAI=84,e.TWLG_TURKISH=85,e.TWLG_UKRANIAN=86,e.TWLG_ASSAMESE=87,e.TWLG_BENGALI=88,e.TWLG_BIHARI=89,e.TWLG_BODO=90,e.TWLG_DOGRI=91,e.TWLG_GUJARATI=92,e.TWLG_HARYANVI=93,e.TWLG_HINDI=94,e.TWLG_KANNADA=95,e.TWLG_KASHMIRI=96,e.TWLG_MALAYALAM=97,e.TWLG_MARATHI=98,e.TWLG_MARWARI=99,e.TWLG_MEGHALAYAN=100,e.TWLG_MIZO=101,e.TWLG_NAGA=102,e.TWLG_ORISSI=103,e.TWLG_PUNJABI=104,e.TWLG_PUSHTU=105,e.TWLG_SERBIAN_CYRILLIC=106,e.TWLG_SIKKIMI=107,e.TWLG_SWEDISH_FINLAND=108,e.TWLG_TAMIL=109,e.TWLG_TELUGU=110,e.TWLG_TRIPURI=111,e.TWLG_URDU=112,e.TWLG_VIETNAMESE=113,e}({}),Ca=function(e){return e.TWSS_NONE=0,e.TWSS_A4LETTER=1,e.TWSS_B5LETTER=2,e.TWSS_USLETTER=3,e.TWSS_USLEGAL=4,e.TWSS_A5=5,e.TWSS_B4=6,e.TWSS_B6=7,e.TWSS_USLEDGER=9,e.TWSS_USEXECUTIVE=10,e.TWSS_A3=11,e.TWSS_B3=12,e.TWSS_A6=13,e.TWSS_C4=14,e.TWSS_C5=15,e.TWSS_C6=16,e.TWSS_4A0=17,e.TWSS_2A0=18,e.TWSS_A0=19,e.TWSS_A1=20,e.TWSS_A2=21,e.TWSS_A4=1,e.TWSS_A7=22,e.TWSS_A8=23,e.TWSS_A9=24,e.TWSS_A10=25,e.TWSS_ISOB0=26,e.TWSS_ISOB1=27,e.TWSS_ISOB2=28,e.TWSS_ISOB3=12,e.TWSS_ISOB4=6,e.TWSS_ISOB5=29,e.TWSS_ISOB6=7,e.TWSS_ISOB7=30,e.TWSS_ISOB8=31,e.TWSS_ISOB9=32,e.TWSS_ISOB10=33,e.TWSS_JISB0=34,e.TWSS_JISB1=35,e.TWSS_JISB2=36,e.TWSS_JISB3=37,e.TWSS_JISB4=38,e.TWSS_JISB5=2,e.TWSS_JISB6=39,e.TWSS_JISB7=40,e.TWSS_JISB8=41,e.TWSS_JISB9=42,e.TWSS_JISB10=43,e.TWSS_C0=44,e.TWSS_C1=45,e.TWSS_C2=46,e.TWSS_C3=47,e.TWSS_C7=48,e.TWSS_C8=49,e.TWSS_C9=50,e.TWSS_C10=51,e.TWSS_USSTATEMENT=52,e.TWSS_BUSINESSCARD=53,e.TWSS_MAXSIZE=54,e}({}),Aa=function(e){return e.TWON_NONE=0,e.TWON_ARRAY=3,e.TWON_ENUMERATION=4,e.TWON_ONEVALUE=5,e.TWON_RANGE=6,e}({}),Wa=function(e){return e.TWTY_INT8=0,e.TWTY_INT16=1,e.TWTY_INT32=2,e.TWTY_UINT8=3,e.TWTY_UINT16=4,e.TWTY_int=5,e.TWTY_BOOL=6,e.TWTY_FIX32=7,e.TWTY_FRAME=8,e.TWTY_STR32=9,e.TWTY_STR64=10,e.TWTY_STR128=11,e.TWTY_STR255=12,e}({}),Pa=function(e){return e.TWFA_NONE=0,e.TWFA_LEFT=1,e.TWFA_CENTER=2,e.TWFA_RIGHT=3,e}({}),La=function(e){return e.TWFO_FIRSTPAGEFIRST=0,e.TWFO_LASTPAGEFIRST=1,e}({}),Da=function(e){return e.TWPR_IMPRINTERTOPBEFORE=0,e.TWPR_IMPRINTERTOPAFTER=1,e.TWPR_IMPRINTERBOTTOMBEFORE=2,e.TWPR_IMPRINTERBOTTOMAFTER=3,e.TWPR_ENDORSERTOPBEFORE=4,e.TWPR_ENDORSERTOPAFTER=5,e.TWPR_ENDORSERBOTTOMBEFORE=6,e.TWPR_ENDORSERBOTTOMAFTER=7,e}({}),Oa=function(e){return e.TWPM_SINGLESTRING=0,e.TWPM_MULTISTRING=1,e.TWPM_COMPOUNDSTRING=2,e}({}),xa=function(e){return e.TWBR_THRESHOLD=0,e.TWBR_HALFTONE=1,e.TWBR_CUSTHALFTONE=2,e.TWBR_DIFFUSION=3,e}({}),Na=function(e){return e.TWBO_LSBFIRST=0,e.TWBO_MSBFIRST=1,e}({}),Ra=function(e){return e.TWFT_RED=0,e.TWFT_GREEN=1,e.TWFT_BLUE=2,e.TWFT_NONE=3,e.TWFT_WHITE=4,e.TWFT_CYAN=5,e.TWFT_MAGENTA=6,e.TWFT_YELLOW=7,e.TWFT_BLACK=8,e}({}),ka=function(e){return e.TWFL_NONE=0,e.TWFL_OFF=1,e.TWFL_ON=2,e.TWFL_AUTO=3,e.TWFL_REDEYE=4,e}({}),Fa=function(e){return e.TWFR_BOOK=0,e.TWFR_FANFOLD=1,e}({}),Ma=function(e){return e.TWIF_NONE=0,e.TWIF_AUTO=1,e.TWIF_LOWPASS=2,e.TWIF_BANDPASS=3,e.TWIF_HIGHPASS=4,e.TWIF_TEXT=3,e.TWIF_FINELINE=4,e}({}),Ga=function(e){return e.TWLP_REFLECTIVE=0,e.TWLP_TRANSMISSIVE=1,e}({}),Ba=function(e){return e.TWLS_RED=0,e.TWLS_GREEN=1,e.TWLS_BLUE=2,e.TWLS_NONE=3,e.TWLS_WHITE=4,e.TWLS_UV=5,e.TWLS_IR=6,e}({}),Ua=function(e){return e.TWNF_NONE=0,e.TWNF_AUTO=1,e.TWNF_LONEPIXEL=2,e.TWNF_MAJORITYRULE=3,e}({}),ja=function(e){return e.TWOR_ROT0=0,e.TWOR_ROT90=1,e.TWOR_ROT180=2,e.TWOR_ROT270=3,e.TWOR_PORTRAIT=0,e.TWOR_LANDSCAPE=3,e.TWOR_AUTO=4,e.TWOR_AUTOTEXT=5,e.TWOR_AUTOPICTURE=6,e}({}),Ha=function(e){return e.TWOV_NONE=0,e.TWOV_AUTO=1,e.TWOV_TOPBOTTOM=2,e.TWOV_LEFTRIGHT=3,e.TWOV_ALL=4,e}({}),Va=function(e){return e.TWPF_CHOCOLATE=0,e.TWPF_VANILLA=1,e}({}),Ka=function(e){return e.TWPC_CHUNKY=0,e.TWPC_PLANAR=1,e}({}),Xa=function(e){return e.TWAIN=0,e.ICA=3,e.SANE=3,e.TWAIN_AND_ICA=4,e.TWAIN_AND_TWAIN64=4,e.TWAIN64=5,e}({}),Ya=function(e){return e.URL=0,e.Blob=1,e.Base64=2,e}({}),Ja=function(e){return e.IT_BMP=0,e.IT_JPG=1,e.IT_TIF=2,e.IT_PNG=3,e.IT_PDF=4,e.IT_ALL=5,e.IT_MULTIPAGE_PDF=7,e.IT_MULTIPAGE_TIF=8,e.IT_J2K=14,e}({}),za=function(e){return e.Info=1,e.Error=2,e.NotInstalledError=3,e}({}),qa=function(e){return e.Text=0,e.Blob=1,e.ArrayBuffer=2,e.XML=3,e.JSON=4,e.UserDefined=5,e}({}),Qa=function(e){return e.Binary=0,e.Base64=1,e}({}),Za=function(e){return e.CONNECTING=0,e.OPEN=1,e.CLOSING=2,e.CLOSED=3,e}({}),$a=function(e){return e.normal=0,e.balance=1,e}({}),es=function(e){return e.TWPT_BW=0,e.TWPT_GRAY=1,e.TWPT_RGB=2,e.TWPT_PALLETE=3,e.TWPT_CMY=4,e.TWPT_CMYK=5,e.TWPT_YUV=6,e.TWPT_YUVK=7,e.TWPT_CIEXYZ=8,e.TWPT_LAB=9,e.TWPT_SRGB=10,e.TWPT_SCRGB=11,e.TWPT_INFRARED=16,e}(es||{}),ts=function(e){return e.TWUN_INCHES=0,e.TWUN_CENTIMETERS=1,e.TWUN_PICAS=2,e.TWUN_POINTS=3,e.TWUN_TWIPS=4,e.TWUN_PIXELS=5,e.TWUN_MILLIMETERS=6,e}(ts||{});Wt.mix(xt.DWT,{EnumDWT_DeviceType:cr,EnumDWT_Cap:Ia,EnumDWT_CapLanguage:Ea,EnumDWT_CapSupportedSizes:Ca,EnumDWT_CapType:Aa,EnumDWT_CapValueType:Wa,EnumDWT_CapFeederAlignment:Pa,EnumDWT_CapFeederOrder:La,EnumDWT_CapPrinter:Da,EnumDWT_CapPrinterMode:Oa,EnumDWT_CapBitdepthReduction:xa,EnumDWT_CapBitOrder:Na,EnumDWT_CapFilterType:Ra,EnumDWT_CapFlash:ka,EnumDWT_CapFlipRotation:Fa,EnumDWT_CapImageFilter:Ma,EnumDWT_CapLightPath:Ga,EnumDWT_CapLightSource:Ba,EnumDWT_CapNoiseFilter:Ua,EnumDWT_CapORientation:ja,EnumDWT_CapOverscan:Ha,EnumDWT_CapPixelFlavor:Va,EnumDWT_CapPlanarChunky:Ka,EnumDWT_ImageType:Ja,EnumDWT_ImageFormatType:Ya,EnumDWT_ResponseType:qa,EnumDWT_SourceMatchField:Pr,EnumDWT_UploadDataFormat:Qa,EnumDWT_WorkMode:$a,EnumDWT_ConvertMode:Li,EnumDWT_PixelType:es,EnumDWT_UnitType:ts});var rs=xt.DWT;rs.EnumPDF_Page={Page_Default:0,Page_Custom:1,Page_A4:2,Page_A4_Reverse:3,Page_A3:4,Page_A3_Reverse:5,Page_Letter:6,Page_Letter_Reverse:7,Page_Legal:8,Page_Legal_Reverse:9},rs.EnumDWT_BorderStyle={TWBS_NONE:0,TWBS_SINGLEFLAT:1,TWBS_SINGLE3D:2},rs.EnumDWT_MessageType={TWQC_GET:1,TWQC_SET:2,TWQC_GETDEFAULT:4,TWQC_GETCURRENT:8,TWQC_RESET:16},rs.EnumDWT_TransferMode={TWSX_NATIVE:0,TWSX_FILE:1,TWSX_MEMORY:2},rs.EnumDWT_FileFormat={TWFF_TIFF:0,TWFF_PICT:1,TWFF_BMP:2,TWFF_XBM:3,TWFF_JFIF:4,TWFF_FPX:5,TWFF_TIFFMULTI:6,TWFF_PNG:7,TWFF_SPIFF:8,TWFF_EXIF:9,TWFF_PDF:10,TWFF_JP2:11,TWFF_JPN:12,TWFF_JPX:13,TWFF_DEJAVU:14,TWFF_PDFA:15,TWFF_PDFA2:16},rs.EnumDWT_TIFFCompressionType={TIFF_AUTO:0,TIFF_NONE:1,TIFF_RLE:2,TIFF_FAX3:3,TIFF_T4:3,TIFF_FAX4:4,TIFF_T6:4,TIFF_LZW:5,TIFF_JPEG:7,TIFF_PACKBITS:32773},rs.EnumDWT_InterpolationMethod={IM_NEARESTNEIGHBOUR:1,IM_BILINEAR:2,IM_BICUBIC:3,IM_BESTQUALITY:5},rs.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5,PDF_JP2000:6,PDF_JBIG2:7},rs.EnumDWT_ShowMode={SW_ACTIVE:0,SW_MAX:1,SW_MIN:2,SW_CLOSE:3,SW_IFLIVE:4},rs.EnumDWT_DUPLEX={TWDX_NONE:0,TWDX_1PASSDUPLEX:1,TWDX_2PASSDUPLEX:2},rs.EnumDWT_MagType={TWMD_MICR:0,TWMD_RAW:1,TWMD_INVALID:2},rs.EnumDWT_DataSourceStatus={TWDSS_CLOSED:0,TWDSS_OPENED:1,TWDSS_ENABLED:2,TWDSS_ACQUIRING:3};var ns=function(e){return e.enumFitWindow=0,e.enumFitWindowHeight=1,e.enumFitWindowWidth=2,e}(ns||{});rs.EnumDWT_FitWindowType={enumFitWindow:ns.enumFitWindow,enumFitWindowHeight:ns.enumFitWindowHeight,enumFitWindowWidth:ns.enumFitWindowWidth},rs.EnumDWT_PlatformType={enumUnknown:zt.enumUnknown,enumWindow:zt.enumWindow,enumMac:zt.enumMac,enumLinux:zt.enumLinux,enumEmbed:zt.enumEmbed,enumChromeOS:zt.enumChromeOS,enumHarmonyOS:zt.enumHarmonyOS,enumAndroid:zt.enumAndroid,enumiOS:zt.enumiOS};var os=function(e){return e.Default=0,e.Hand=1,e.Crosshair=2,e.Zoom=3,e.NWResize=4,e.EResize=5,e.NResize=6,e.Resize=7,e.Move=8,e}(os||{});rs.EnumDWT_MouseShape={Default:os.Default,Hand:os.Hand,Crosshair:os.Crosshair,Zoom:os.Zoom,NWResize:os.NWResize,EResize:os.EResize,NResize:os.NResize,Resize:os.Resize,Move:os.Move},rs.EnumDWT_Language={English:0,French:1,Arabic:2,Spanish:3,Portuguese:4,German:5,Italian:6,Russian:7,Chinese:8},rs.EnumDWT_InitMsg={Info:za.Info,Error:za.Error,NotInstalledError:za.NotInstalledError},rs.EnumDWT_Driver={TWAIN:Xa.TWAIN,ICA:Xa.ICA,SANE:Xa.SANE,TWAIN_AND_ICA:Xa.TWAIN_AND_ICA,TWAIN_AND_TWAIN64:Xa.TWAIN_AND_TWAIN64,TWAIN64:Xa.TWAIN64},rs.EnumDWT_CompressionType={TWCP_NONE:0,TWCP_PACKBITS:1,TWCP_GROUP31D:2,TWCP_GROUP31DEOL:3,TWCP_GROUP32D:4,TWCP_GROUP4:5,TWCP_JPEG:6,TWCP_LZW:7,TWCP_JBIG:8,TWCP_PNG:9,TWCP_RLE4:10,TWCP_RLE8:11,TWCP_BITFIELDS:12,TWCP_ZIP:13,TWCP_JPEG2000:14};var is=function(e){return e.Single=0,e.Multiple=1,e}(is||{});rs.EnumDWT_SelectionMode={Single:is.Single,Multiple:is.Multiple},rs.EnumDWT_ConfirmExitType={Cancel:0,Exit:1,SaveAndExit:2},rs.EnumDWT_WebsocketReadyState={CONNECTING:Za.CONNECTING,OPEN:Za.OPEN,CLOSING:Za.CLOSING,CLOSED:Za.CLOSED};var as=function(e){return e.TwainService=1,e}(as||{});rs.EnumDWT_ServiceType={TwainService:as.TwainService};var ss=function(e){return e["default"]=0,e.standard=1,e.supported=2,e}(ss||{});function us(e){var t=this;t._stwain=e,Lt.attachAxViewerPropertyUI(t),Lt.attachAxViewerFunctions(t),t._thumbnailViewer=null}rs.EnumDWT_ExtImageInfo={"default":ss["default"],standard:ss.standard,supported:ss.supported},Lt.attachAxViewerPropertyUI=function(e){var t=function(t,r){t in e||Object.defineProperty(e,t,r)};t("width",{get:function(){return e._stwain.Width},set:function(t){return e._stwain.Width=t,Lt.checkErrorString(e._stwain)}}),t("height",{get:function(){return e._stwain.Height},set:function(t){return e._stwain.Height=t,Lt.checkErrorString(e._stwain)}}),t("background",{get:function(){return e._stwain.BackgroundColor},set:function(t){return e._stwain.BackgroundColor=t,t}}),t("cursor",{get:function(){return e._stwain.MouseShape?"pointer":"crosshair"},set:function(t){return e._stwain.MouseShape="pointer"==t,t}}),t("showPageNumber",{get:function(){return!1},set:function(e){return!1}}),t("ifAutoScroll",{get:function(){return e._stwain.IfAutoScroll},set:function(t){return e._stwain.IfAutoScroll=t,t}}),t("pageMargin",{get:function(){return e._stwain.ImageMargin},set:function(t){return e._stwain.ImageMargin=t,t}}),t("zoom",{get:function(){return e._stwain.Zoom},set:function(t){return e._stwain.Zoom=t,t}})},Lt.attachAxViewerFunctions=function(e){e.next=function(){return this._stwain.next()},e.previous=function(){return this._stwain.previous()},e.first=function(){return this._stwain.first()},e.last=function(){return this._stwain.last()},e.gotoPage=function(e){var t=this,r=1*e;return Lt.isNaN(r)||!Lt.isNumber(r)?(an(t._stwain),!1):r<0||r>=t._stwain.HowManyImagesInBuffer?(dn(t._stwain),!1):(t._stwain.CurrentImageIndexInBuffer=r,r)},e.setSelectedAreas=function(e){return this._stwain.SetSelectedImageArea(this._stwain.CurrentImageIndexInBuffer,e.left,e.top,e.right,e.bottom)},e.fitWindow=function(e){var t=this;return"height"==e?(t._stwain.IfFitWindow=!0,t._stwain.FitWindowType=ns.enumFitWindowHeight):"width"==e?(t._stwain.IfFitWindow=!0,t._stwain.FitWindowType=ns.enumFitWindowWidth):(t._stwain.IfFitWindow=!0,t._stwain.FitWindowType=ns.enumFitWindow),!0},e.setViewMode=function(e,t){return this._stwain.SetViewMode(e,t)},e.createImageEditor=function(){return this._stwain},e.on=function(e,t){var r,n=this;return""!=(r=n._convertEvtName(e))&&("OnImageAreaSelected"==r?(n.OnImageAreaSelected=function(e,r,n,o,i){t(e,[{x:r,y:n,width:o-r,height:i-n}])},n._stwain.RegisterEvent(r,n.OnImageAreaSelected)):n._stwain.RegisterEvent(r,t))},e.off=function(e,t){var r;return""!=(r=this._convertEvtName(e))&&this._stwain.UnregisterEvent(r,(function(){}))},e.createThumbnailViewer=function(e){var t=this;if(t._thumbnailViewer)tn(t._stwain,-2501,"A ThumbnailViewer already exists.");else{var r=new Lt.UI.ThumbnailViewer(t._stwain,e);t._thumbnailViewer=r.getInstance()}return t._thumbnailViewer},e._convertEvtName=function(e){if(!Lt.isString(e))return"";var t=Lt.trim(e).toLowerCase();return"toppagechanged"==t?"OnTopImageInTheViewChanged":"click"==t?"OnMouseClick":"dblclick"==t?"OnMouseDoubleClick":"mousemove"==t?"OnMouseMove":"rightclick"==t?"OnMouseRightClick":"wheel"==t?"OnMouseWheel":"keydown"==t?"OnKeyDown":"pageareaselected"==t?"OnImageAreaSelected":"pageareaunselected"==t?"OnImageAreaDeSelected":Lt.trim(e)}},us.prototype.getInstance=function(){return this};var cs={showThumbnail:!1,location:"horizontal",sequence:-1,size:"30%",columns:1,rows:3,scrollDirection:"vertical",pageMargin:10,border:"",allowKeyboardControl:!0,allowPageDragging:!0,allowResizing:!1,pageBackground:"transparent",pageBorder:"1px solid rgb(238, 238, 238)",hoverPageBackground:"rgb(239, 246, 253)",hoverPageBorder:"1px solid rgb(238, 238, 238)",placeholderBackground:"rgb(251, 236, 136)",autoChangeIndex:!1};function ls(e,t){var r=this,n=t;if(n){if(n.location)switch(n.location){case"left":default:n.location="horizontal",n.sequence=-1;break;case"right":n.location="horizontal",n.sequence=1;break;case"top":n.location="vertical",n.sequence=-1;break;case"bottom":n.location="vertical",n.sequence=1}else n.location="horizontal",n.sequence=-1;Lt.isUndefined(n.size)&&(n.size=cs.size),Lt.isUndefined(n.columns)&&(n.columns=cs.columns),Lt.isUndefined(n.rows)&&(n.rows=cs.rows),(Lt.isUndefined(n.scrollDirection)||"horizontal"!=n.scrollDirection)&&(n.scrollDirection=cs.scrollDirection),Lt.isUndefined(n.pageMargin)&&(n.pageMargin=cs.pageMargin),Lt.isUndefined(n.allowKeyboardControl)&&(n.allowKeyboardControl=cs.allowKeyboardControl),Lt.isUndefined(n.allowPageDragging)&&(n.allowPageDragging=cs.allowPageDragging),Lt.isUndefined(n.allowResizing)&&(n.allowResizing=cs.allowResizing),Lt.isUndefined(n.border)&&(n.border=cs.border),Lt.isUndefined(n.pageBackground)&&(n.pageBackground=cs.pageBackground),Lt.isUndefined(n.pageBorder)&&(n.pageBorder=cs.pageBorder),Lt.isUndefined(n.hoverPageBackground)&&(n.hoverPageBackground=cs.hoverPageBackground),Lt.isUndefined(n.hoverPageBorder)&&(n.hoverPageBorder=cs.hoverPageBorder),Lt.isUndefined(n.placeholderBackground)&&(n.placeholderBackground=cs.placeholderBackground),Lt.isUndefined(n.autoChangeIndex)&&(n.autoChangeIndex=cs.autoChangeIndex)}else n=cs;r._stwain=e,r._settings=n,Lt.attachViewerPropertyThumbnailUI(r),Lt.attachViewerFunctionsThumbnailUI(r),e.getSWebTwain().SetViewMode(-1,-1),e.getSWebTwain().ShowThumbnail(Lt.stringify(n))}ls.prototype.getInstance=function(){return this},Lt.attachViewerFunctionsThumbnailUI=function(e){e.show=function(){e._stwain?(e._stwain.getSWebTwain().SetViewMode(-1,-1),e._stwain.getSWebTwain().ShowThumbnail('{"mode":"show"}')):yn(e._stwain)},e.hide=function(){e._stwain?e._stwain.getSWebTwain().ShowThumbnail('{"mode":"hide"}'):yn(e._stwain)},e.dispose=function(){e.hide(),e._stwain=null},e.updateViewMode=function(t){if(e._stwain){if(t&&t.columns&&t.rows){if(t.columns<0||t.rows<0)return tn(e._stwain,-2514,"Invalid property value."),!1;e._stwain.getSWebTwain().ShowThumbnail('{"columns":'+t.columns+',"rows":'+t.rows+"}")}}else yn(e._stwain)},e.on=function(t,r){var n=t,o=!1;Lt.isFunction(r)&&("click"==n&&(n="OnMouseClick"),"rightclick"==n&&(n="OnMouseRightClick"),"dblclick"==n&&(n="OnMouseDoubleClick"),"mousemove"==n&&(n="OnMouseMove"),"wheel"==n&&(n="OnMouseWheel"),"keydown"==n&&(n="OnKeyDown"),"toppagechanged"==n&&(n="OnTopImageInTheViewChanged"),"pageareaselected"==n&&(n="OnImageAreaSelected"),"pageareaunselected"==n&&(n="OnImageAreaDeSelected"),"OnMouseClick"==n||"OnMouseDoubleClick"==n||"OnMouseRightClick"==n||"OnMouseMove"==n||"OnMouseWheel"==n||"OnKeyDown"==n||"OnPaintDone"==n||"OnImageAreaDeSelected"==n||"OnTopImageInTheViewChanged"==n?(Lt.isFunction(e._stwain["__"+n])||Lt.isFunction(e._stwain["__"+n+"_Thumbnail"])||(o=!0),e._stwain["__"+n+"_Thumbnail"]=r,o&&e._stwain.getSWebTwain().RegisterEvent(n,(function(t,r){return e._stwain.__OnDispatchThumbnailEvt(n,t,r)}))):"OnImageAreaSelected"==n&&(Lt.isFunction(e._stwain["__"+n])||Lt.isFunction(e._stwain["__"+n+"_Thumbnail"])||(o=!0),e._stwain["__"+n+"_Thumbnail"]=r,o&&e._stwain.getSWebTwain().RegisterEvent(n,e._stwain._OnImageAreaSelected)))},e.off=function(t,r){e._stwain["__"+t+"_Thumbnail"]=""}},Lt.attachViewerPropertyThumbnailUI=function(e){var t=function(t,r){t in e||Object.defineProperty(e,t,r)};t("location",{get:function(){return e._settings.location},set:function(t){e._settings.location=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"location":"'+t+'"}')}}),t("size",{get:function(){return e._settings.size},set:function(t){e._settings.size=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"size":"'+t+'"}')}}),t("pageMargin",{get:function(){return e._settings.pageMargin},set:function(t){e._settings.pageMargin=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"pageMargin":"'+t+'"}')}}),t("background",{get:function(){return e._settings.background},set:function(t){e._settings.background=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"background":"'+t+'"}')}}),t("pageBackground",{get:function(){return e._settings.pageBackground},set:function(t){e._settings.pageBackground=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"pageBackground":"'+t+'"}')}}),t("selectedPageBorder",{get:function(){return e._settings.selectedPageBorder},set:function(t){e._settings.selectedPageBorder=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"selectedPageBorder":"'+t+'"}')}}),t("selectedPageBackground",{get:function(){return e._settings.selectedPageBackground},set:function(t){e._settings.selectedPageBackground=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"selectedPageBackground":"'+t+'"}')}}),t("scrollDirection",{get:function(){return e._settings.scrollDirection},set:function(t){e._settings.scrollDirection=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"scrollDirection":"'+t+'"}')}}),t("showPageNumber",{get:function(){return e._settings.showPageNumber},set:function(t){e._settings.showPageNumber=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"showPageNumber":"'+t+'"}')}}),t("border",{get:function(){return e._settings.border},set:function(t){e._settings.border=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"border":"'+t+'"}')}}),t("pageBorder",{get:function(){return e._settings.pageBorder},set:function(t){e._settings.pageBorder=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"pageBorder":"'+t+'"}')}}),t("hoverPageBackground",{get:function(){return e._settings.hoverPageBackground},set:function(t){e._settings.hoverPageBackground=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"hoverPageBackground":"'+t+'"}')}}),t("hoverPageBorder",{get:function(){return e._settings.hoverPageBorder},set:function(t){e._settings.hoverPageBorder=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"hoverPageBorder":"'+t+'"}')}}),t("placeholderBackground",{get:function(){return e._settings.placeholderBackground},set:function(t){e._settings.placeholderBackground=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"placeholderBackground":"'+t+'"}')}}),t("allowKeyboardControl",{get:function(){return e._settings.allowKeyboardControl},set:function(t){e._settings.allowKeyboardControl=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"allowKeyboardControl":"'+t+'"}')}}),t("allowPageDragging",{get:function(){return e._settings.allowPageDragging},set:function(t){e._settings.allowPageDragging=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"allowPageDragging":"'+t+'"}')}}),t("allowResizing",{get:function(){return e._settings.allowResizing},set:function(t){e._settings.allowResizing=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"allowResizing":"'+t+'"}')}}),t("autoChangeIndex",{get:function(){return e._settings.autoChangeIndex},set:function(t){e._settings.autoChangeIndex=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"autoChangeIndex":"'+t+'"}')}})},Lt.UI=Lt.UI||{},Lt.UI.DWTAxViewer=us,Lt.UI.ThumbnailViewer=ls;var fs=Wt.isString,hs=Wt.isArray,ds=Wt.each;function ps(e,t){if(fs(t))e.push('"'),e.push(t),e.push('"');else if(hs(t)){var r=ur;e.push("["),ds(t,(function(t){r?r=sr:e.push(","),ps(e,t)})),e.push("]")}else t===undefined?e.push('""'):e.push(t)}var gs=1;function ms(e){return ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ms(e)}function Ts(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ys(n.key),n)}}function vs(e,t,r){return(t=ys(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ys(e){var t=function(e,t){if("object"!=ms(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ms(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ms(t)?t:t+""}var bs=function(){return e=function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),vs(this,"m_server",""),vs(this,"m_iUsingTime",0),vs(this,"m_countMap",{}),vs(this,"m_newConsum",!1),vs(this,"m_mapSavedToDb",!1),this.clearData(),this.m_enumInstance=e,e==xt.DWT.EnumInstance.dwt_desktop?(this.m_deploymentType="desktop",this.m_server=t):e==xt.DWT.EnumInstance.dwt_browser?(this.m_deploymentType="browser",this.m_server=t):e==xt.DWT.EnumInstance.dbr&&(this.m_deploymentType="browser",this.m_server="")},(t=[{key:"clearData",value:function(){this.m_iUsingTime=0,this.m_jvUsingTime=Wt.nil,this.m_countMap={},this.m_newConsum=!1,this.m_mapSavedToDb=!1,this.m_minExpiredTime=Wt.nil,this.m_maxExpiredTime=Wt.nil,this.m_cu=Wt.nil,this.m_ar=Wt.nil,this.m_ltsInstance=Wt.nil}},{key:"set_cu",value:function(e){this.m_cu=e}},{key:"get_cu",value:function(){return this.m_cu}},{key:"set_ar",value:function(e){this.m_ar=e}},{key:"get_ar",value:function(){return this.m_ar}},{key:"get_ltsInstance",value:function(e){return this.m_ltsInstance||(this.m_ltsInstance=e(this.m_enumInstance)),this.m_ltsInstance}},{key:"inited_ltsInstance",value:function(){return!!this.m_ltsInstance}},{key:"set_maxExpiredTime",value:function(e){this.m_maxExpiredTime=e}},{key:"get_maxExpiredTime",value:function(){return this.m_maxExpiredTime}},{key:"set_minExpiredTime",value:function(e){this.m_minExpiredTime=e}},{key:"get_minExpiredTime",value:function(){return this.m_minExpiredTime}},{key:"get_deploymentType",value:function(){return this.m_deploymentType}},{key:"get_enumDeploymentType",value:function(){return this.m_enumInstance}}])&&Ts(e.prototype,t),r&&Ts(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function Ss(e){return Ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ss(e)}function _s(){_s=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof T?t:T,a=Object.create(i.prototype),s=new L(n||[]);return o(a,"_invoke",{value:C(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",d="suspendedYield",p="executing",g="completed",m={};function T(){}function v(){}function y(){}var b={};c(b,a,(function(){return this}));var S=Object.getPrototypeOf,_=S&&S(S(D([])));_&&_!==r&&n.call(_,a)&&(b=_);var w=y.prototype=T.prototype=Object.create(b);function I(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(o,i,a,s){var u=f(e[o],e,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==Ss(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function C(t,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var c=f(t,r,n);if("normal"===c.type){if(o=n.done?g:d,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=g,n.method="throw",n.arg=c.arg)}}}function A(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function W(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(W,this),this.reset(!0)}function D(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Ss(t)+" is not iterable")}return v.prototype=y,o(w,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:v,configurable:!0}),v.displayName=c(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},I(E.prototype),c(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},I(w),c(w,u,"Generator"),c(w,a,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function o(){for(;r.length;){var e=r.pop();if(e in t)return o.value=e,o.done=!1,o}return o.done=!0,o}},t.values=D,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:D(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function ws(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function Is(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){ws(i,n,o,a,s,"next",e)}function s(e){ws(i,n,o,a,s,"throw",e)}a(void 0)}))}}var Es=xt.DWT;Es.LTS=Es.LTS||{},Es.licenseException={code:0,message:"",fromLTS:!1},Es.bLTSOnline=!0,Es.axInstance=undefined,Es.lOnUpdateDWObj=[],Es.EnumInstance={dwt_desktop:0,dwt_browser:1,dbr:2};var Cs,As=0,Ws={},Ps=!1,Ls=!1,Ds=!1,Os=!1,xs=!1;function Ns(){var e=nr.handshakeCode;return Wt.isString(e)||(e=""),e}function Rs(){var e=nr.organizationID;return Wt.isNumber(e)?e=""+e:Wt.isString(e)||(e=""),e}function ks(){return Wt.replaceAll(Yt.JSVersion,",",".")}function Fs(e,t){var r=e;return r===Wt.nil&&(r=xt.DWT.lgdt()),r==Es.EnumInstance.dbr?(Es._dbrLicense||(Es._dbrLicense=new bs(r,"")),Es._dbrLicense):(Es._dwtDLicense||(Es._dwtDLicense=new bs(r,"")),Es._dwtDLicense)}Es.lupverfy=function(){Fs(Es.lgdt()).get_ltsInstance(Bs),Fs(Es.EnumInstance.dbr).get_ltsInstance(Bs)};var Ms=Es.EnumInstance.dwt_desktop;Es.lsdt=function(e,t){Ms=e},Es.lgdt=function(e){return Ms},Es.lsmid=function(e,t){Fs(Es.lgdt()).set_cu(e)},Es.lsar=function(e,t){Fs(Es.lgdt()).set_ar(e)},Es.lsmid2b=function(e){Fs(Es.lgdt("")).set_cu(e)},Es.lgar=function(e,t){return Fs(e).get_ar()},Es.laddDWTObj=function(e){var t=!1;Wt.each(Es.lOnUpdateDWObj,(function(r){if(r==e)return t=!0,!1})),t||Es.lOnUpdateDWObj.push(e)},Es.lremoveDWTObj=function(e){Wt.each(Es.lOnUpdateDWObj,(function(t,r){if(t==e)return Es.lOnUpdateDWObj.splice(r,1),!1}))},Es.lsendUpdateEvt=function(e,t){var r=[];if(Wt.each(Es.lOnUpdateDWObj,(function(t){e==Es.EnumInstance.dwt_desktop&&r.push(t)})),0==r.length)return Lt.Promise.resolve();var n,o=r[0];return o._bAx?(Wt.each(r,(function(t){t.SetLTSInfo(Fs(e).get_ar(),Fs(e).get_cu())})),o.GetLicenseInfo().then((function(r){r&&Wt.isArray(r.Detail)&&r.Detail.length>0&&Es.lsexp(e,r.Detail[0].ExpireDate,t)}))):(n=o.SetLTSLicenseAsync(Fs(e).get_ar()).then((function(r){r&&Wt.isArray(r.Detail)&&r.Detail.length>0&&Es.lsexp(e,r.Detail[0].ExpireDate,t)})),Wt.each(r,(function(t,r){0!=r&&t.SetLTSLicenseAsync(Fs(e).get_ar())})),n)},Es.lgcb=function(){var e=[];return K.bChrome?e.push("Chrome"):K.bFirefox?e.push("Firefox"):K.bEdge?e.push("Edge"):K.bIE?e.push("IE"):K.bSafari?e.push("Safari"):K.bOpera?e.push("Opera"):K.b360SE?e.push("360SE"):K.bTencentTraveler?e.push("TencentTraveler"):K.bMaxthon?e.push("Maxthon"):K.bMetaSr?e.push("MetaSr"):K.bTheWorld?e.push("TheWorld"):K.bUC?e.push("UC"):K.bHuaWeiBrowser&&e.push("HuaWeiBrowser"),e.push(K.strBrowserVersion),K.bWin?e.push("Windows"):K.bMac?e.push("Mac"):K.bLinux?e.push("Linux"):K.bAndroid?e.push("Android"):K.bChromeOS?e.push("ChromeOS"):K.bHarmonyOS?e.push("HarmonyOS"):Ta.bMobile?e.push("Mobile OS"):xt.navInfo.bEmbed&&e.push("Embed OS"),e.join(" ")};var Gs={NetworkError:-2440,Timedout:-2441,JsonError:-2442,CorsError:-2443,Expired:-2445,LtsJsLoadError:-2446,UUIDError:-2447};function Bs(e){var t,r,n=nr.licenseServer;if(n&&n.length>0)for(t=0;t<n.length;t++)r=n[t],Wt.endsWith(r,"/")||(n[t]=r+"/");var o=Fs(e),i={bd:Lt.ltsDebug,dm:location.origin?Wt.startsWith(location.origin,"http")?location.origin:"https://localhost":Wt.startsWith(location.href,"http")?location.href:"https://localhost",hs:Lt.product.handshakeCode||"",pd:Es.lgpd(e),vm:Nt,dt:o.get_enumDeploymentType(),btoa:Wt.btoa,atob:Wt.atob,fol:Es.OnFirstOffline,sutlcb:function(){Wt.isFunction(Es.lonsend)&&Es.lonsend()},lf:Lt.localforage,updl:function(t){o.set_ar(t.ar),o.get_cu()||o.set_cu(t.cu),Es.lsendUpdateEvt(e,"")},mnet:function(){return o.get_maxExpiredTime()},mxet:function(){return o.get_minExpiredTime()},dwt:!0};if(e==Es.EnumInstance.dwt_browser||e==Es.EnumInstance.dbr?i.feab=Es.lfeab_wasm:i.feab=Es.lfeab_ax,!K.bIE&&nr.ltsDebug&&(i.log=console.log),xt.LTS&&xt.LTS._)return xt.LTS._.createLtsInstance(i);var a={},s=function(){return Lt.Promise.reject({code:Gs.LtsJsLoadError,message:"The dynamsoft.lts.js load failed."})};return a.i=s,a.s=s,a.u=s,a.caret=s,a}Es.lgpd=function(e){return e==Es.EnumInstance.dwt_desktop?"dwt|dbr|ddv":"dwt|ddv"};var Us,js=!1;function Hs(e,t){return Vs.apply(this,arguments)}function Vs(){return Vs=Is(_s().mark((function e(t,r){var n,o,i,a,s,u,c,l,f,h;return _s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null!=r?r:"",i=Fs(t),a=i.get_enumDeploymentType(),Es.lclex(),!i.get_ar()||!i.get_cu()){e.next=10;break}if(js){e.next=9;break}return o=i.get_ltsInstance(Bs),e.next=8,o.ih();case 8:js=!0;case 9:return e.abrupt("return",Lt.Promise.resolve({ar:i.get_ar(),cu:i.get_cu()}));case 10:if((s={pd:Es.lgpd(t),v:ks(),os:Es.lgcb(),fn:Es.DeviceFriendlyName||"",ls:nr.licenseServer,sp:nr.sessionPassword,l:ea.getLTSLicense(),mnet:function(){return i.get_maxExpiredTime()},mxet:function(){return i.get_minExpiredTime()},fol:Es.OnFirstOffline}).dt=i.get_deploymentType(),a!=Es.EnumInstance.dwt_desktop){e.next=20;break}if(""!=i.get_cu()){e.next=17;break}return un(u={}),e.abrupt("return",Lt.Promise.reject({code:u._errorCode,message:u._errorString}));case 17:s.lsu=i.get_cu(),e.next=21;break;case 20:a==Es.EnumInstance.dbr||(s.dwt=!0,""!=i.get_cu()&&(s.lsu=i.get_cu()),s.updl=function(e){i.set_ar(e.ar),i.get_cu()||i.set_cu(e.cu),Es.lsendUpdateEvt(a,n)});case 21:return e.prev=21,o=i.get_ltsInstance(Bs),e.next=25,o.i(s);case 25:return c=e.sent,i.get_ar()||i.set_ar(c.ar),i.get_cu()||i.set_cu(c.cu),e.abrupt("return",c);case 31:throw e.prev=31,e.t0=e["catch"](21),i.clearData(),Wt.isString(e.t0)?f=e.t0:Wt.isObject(e.t0)&&!Wt.isNumber(e.t0.code)&&(f=e.t0.message),f?(h=Ys(f),Es.lsetException(h,f,!0),l=Es.licenseException):l=e.t0,l;case 37:case 38:case"end":return e.stop()}}),e,null,[[21,31]])}))),Vs.apply(this,arguments)}function Ks(){return Date.now()}function Xs(e){var t=e?new Date(e):new Date,r="yyyy-MM-ddTHH:mm:ss.SSSZ",n={"M+":t.getUTCMonth()+1,"d+":t.getUTCDate(),"H+":t.getUTCHours(),"h+":t.getUTCHours()%12||12,"m+":t.getUTCMinutes(),"s+":t.getUTCSeconds(),"q+":Math.floor((t.getUTCMonth()+3)/3),"S+":t.getUTCMilliseconds()};for(var o in/(y+)/.test(r)&&(r=r.replace(RegExp.$1,(t.getUTCFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+o+")").test(r)&&(r=r.replace(RegExp.$1,1==RegExp.$1.length?n[o]:("000"+n[o]).substr(("000"+n[o]).length-RegExp.$1.length)));return r}function Ys(e){var t=Gs.NetworkError;return e.indexOf("timed out")>-1||e.indexOf("timeout")>-1?t=Gs.Timedout:(e.indexOf("access-control-allow-origin")>-1||e.indexOf("cors")>-1)&&(t=Gs.CorsError),t}function Js(e){var t=this,r=e||{};t._id=r.id,t._containerID=(r.container?r.container.id:r.containerId)||"dwtcontrolContainer",t._containerElement=Lt.get(t._containerID),t._strWidth=r.width||270,t._strHeight=r.height||350,Lt.isString(t._strWidth)&&t._strWidth.indexOf("%")>0||(t._strWidth=[parseInt(t._strWidth),"px"].join("")),Lt.isString(t._strHeight)&&t._strHeight.indexOf("%")>0||(t._strHeight=[parseInt(t._strHeight),"px"].join("")),t._strObjectName=t._containerID+"_Obj",function(e,t){t&&Lt.each(["onAfterOperate","onBeforeOperate","onOperateStatus","onBitmapChanged","onGetFilePath","onImageAreaDeSelected","onImageAreaSelected","onMouseClick","onMouseDoubleClick","onMouseMove","onMouseRightClick","onPreAllTransfers","onPreTransfer","onPostLoad","onPostTransfer","onPostTransferAsync","onPreAllTransfersAsync","onPostAllTransfers","onSourceUIClose","onTopImageInTheViewChanged","onTransferCancelled","onTransferError","onInternetTransferPercentage","onInternetTransferPercentageEx","onRemoteScanStatusAsync","onKeyDown","onMouseWheel"],(function(r){e["__O"+r.substring(1)]=t[r]||""}))}(t,r),t.__OnAxReady=r.onAxReady,t.__OnAxNotInstalled=r.onAxNotInstalled,t.__OnRefreshUI=r.onRefreshUI||"",t._objectWebTwain=null,t._strDWTInnerContainerID=t._containerID+"_CID",t._strDWTNonInstallInnerContainerID=t._containerID+"_NonInstallCID",t.Addon={},t._pdfConvertMode=3,t._pdfOptions={convertMode:3,password:"",renderOptions:{renderAnnotations:!1,resolution:200,maxWidth:0,maxHeight:0,renderGrayscale:!1}},t._bAx=!0,Lt.UI.DWTAxViewer&&(t.Viewer=new Lt.UI.DWTAxViewer(t))}function zs(e){return e&&!Wt.isString(e)?ur:sr}function qs(e){return qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qs(e)}function Qs(){Qs=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof T?t:T,a=Object.create(i.prototype),s=new L(n||[]);return o(a,"_invoke",{value:C(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",d="suspendedYield",p="executing",g="completed",m={};function T(){}function v(){}function y(){}var b={};c(b,a,(function(){return this}));var S=Object.getPrototypeOf,_=S&&S(S(D([])));_&&_!==r&&n.call(_,a)&&(b=_);var w=y.prototype=T.prototype=Object.create(b);function I(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(o,i,a,s){var u=f(e[o],e,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==qs(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function C(t,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var c=f(t,r,n);if("normal"===c.type){if(o=n.done?g:d,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=g,n.method="throw",n.arg=c.arg)}}}function A(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function W(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(W,this),this.reset(!0)}function D(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(qs(t)+" is not iterable")}return v.prototype=y,o(w,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:v,configurable:!0}),v.displayName=c(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},I(E.prototype),c(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},I(w),c(w,u,"Generator"),c(w,a,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function o(){for(;r.length;){var e=r.pop();if(e in t)return o.value=e,o.done=!1,o}return o.done=!0,o}},t.values=D,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:D(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Zs(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}Es.lglic=Hs,Es.lgbuuid=function(){return""},Es.lshow=function(){return{t:Cs,t2:As,m:Wt.stringify(Ws)}},Es.lgct=function(e){switch(e){case 0:return"3011";case 1:return"3012";case 2:return"3014";case 3:return"3013";case 4:return"3015";case 14:return"3016";case 3001:return"3001";case 3002:return"3002";case 3003:return"3003";case 3004:return"3004";case 3005:return"3005";case 3006:return"3006";case 3007:return"3007";case 3008:return"3008";case 3009:return"3009";case 5001:return"5001";case 4001:return"4001";case 4002:return"4002";case 4003:return"4003"}return""},Es.lcvrf=function(e){e&&(e._canConsume&&!e._canConsume()||setTimeout((function(){Es.lcvrf_(e)}),1))},Es.lcvrf_=function(e){var t;t=Es.lgdt();var r,n=Es.DeviceFriendlyName||"",o=Es.lgcb(),i=Fs(t),a={hs:Ns(),og:Rs(),cu:i.get_cu(),fn:n,cw:"",os:o,v:ks(),dt:i.get_deploymentType(),ed:"js"},s=function(e,t){var r,n,o=0;if(Wt.isString(e)&&""!=e&&"{}"!=e&&t&&Wt.isArray(t)&&!(t.length<1)){if(n=Fs(t[0]),r=Wt.parse(e),Es.lclex(),0==As){var i=Ks(),a="";As=i,Cs=Xs(i),Ws={},o=0,Wt.each(r,(function(e,t){(t<o||0==o)&&(o=t,a=e)})),o>0&&n.get_ltsInstance(Bs).s(nr.licenseServer,a,o,!0).then((function(){}),(function(e){}))}Wt.each(r,(function(e,t){var r=!1,i=parseInt(t);i>0&&i!=o&&(i+18e4<Ks()&&(r=!0),n.get_ltsInstance(Bs).s(nr.licenseServer,e,t,r).then((function(){}),(function(e){})))}))}};if(a.pd=Es.lgpd(t),r=Wt.stringify(a),!e._bAx){var u="GetBuffer",c=function(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length>0)if(1===r.length){var o=r[0];e.push("["),ps(e,o),e.push("]")}else if(2===r.length){var i=r[0],a=r[1];e.push("["),ps(e,i),e.push(","),ps(e,a),e.push("]")}else ps(e,Array.prototype.slice.call(r));return e.join("")}(Wt.replaceAll(r,'"','\\"')),l={cmd:u,cmdId:(++gs).toString(),sFun:s,fFun:function(){},params:[t]};return e._innerSendByWS(u,c,l,null,!0)}s(e.GetBuffer(r),[t,""])},Es.lavrf=function(e,t,r,n){var o=1;if(""!=e){t>1&&(o=t);var i=Ks();if(As>0&&As+18e4<i){Ls?(Ws={},Es.lavrf__unload()):Es.lavrf__(!0,r,n);var a=Ks()+1;As=a,Cs=Xs(a),Ws={}}Ps=!0,Ls=!1,Ws[e]?Ws[e]+=o:Ws[e]=o,0==As&&Es.lavrf__(!0,r,n)}},Es.lavrf_=function(e,t,r){if(Ps){var n=1;e&&(n=e),setTimeout((function(){Es.lavrf__(!1,t,r)}),n)}},Es.lavrf__=function(e,t,r){var n,o,i,a=Ks(),s=!1,u=!!e,c=0,l=t;Wt.isUndefined(l)&&(l=Es.lgdt()),i=Fs(l),Ps=!1,0==As&&(s=!0,As=a,Cs=Xs(a)),n=As,o=Cs;var f={};f.ut=o;var h={};if(Wt.each(Ws,(function(e,t){h[t]=e,e>0&&c++})),f.cts=h,u||n+18e4<a){u=!0;var d=Ks()+1;if(As=d,Cs=Xs(d),Ws={},Ls=!1,0==c)return}else{if(0==c)return;Ls=!0}f.dur=s?1:180;var p,g=Es.DeviceFriendlyName||"",m=Es.lgcb(),T={hs:Ns(),og:Rs(),cu:i.get_cu(),fn:g,cw:"",os:m,v:ks(),dt:i.get_deploymentType(),ed:"js",rcs:[f]};T.product=Es.lgpd(t),p=Wt.stringify(T),nr.ltsDebug&&Xs(),Es.lclex(),i.get_ltsInstance(Bs).s(nr.licenseServer,p,""+n,u).then((function(){}),(function(e){}))},Es.lavrf__unload=Is(_s().mark((function bu(){var e,t,r,n,o,i,a;return _s().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(e=Ks(),t=!0,n=!1,o=Fs(Es.lgdt()),i=Fs(Es.EnumInstance.dbr),Ps=!1,0==As&&(As=e,Cs=Xs(e)),r=As,a=Ks()+1,As=a,Cs=Xs(a),Ws={},Ls=!1,r+=1,Es.lclex(),!o.inited_ltsInstance()){s.next=20;break}return s.prev=13,s.next=16,o.get_ltsInstance(Bs).s(nr.licenseServer,n,""+r,t);case 16:s.next=20;break;case 18:s.prev=18,s.t0=s["catch"](13);case 20:if(!i.inited_ltsInstance()){s.next=28;break}return s.prev=21,s.next=24,i.get_ltsInstance(Bs).s(nr.licenseServer,n,""+r,t);case 24:s.next=28;break;case 26:s.prev=26,s.t1=s["catch"](21);case 28:case"end":return s.stop()}}),bu,null,[[13,18],[21,26]])}))),Es.lclex=function(){var e=Es.licenseException;e.code=0,e.message="",e.httpResponse="",e.fromLTS=!1},Es.li=function(e,t){var r;if(e.axInstance&&(Es.axInstance=e.axInstance,Es.axInstance))return r=Es.axInstance.GetUUID(),nr.ltsDebug&&Wt.log("ActiveX cu: "+r),Fs(e.instanceMode).set_cu(r),r;return Fs(e.instanceMode).get_cu()},Es.lfeab_ax=function(e){return new Lt.Promise((function(t,r){var n="";if(Es.axInstance)try{n=Es.axInstance.Encrypt(e,0)}catch(o){}t(n)}))},Es.lfeab_wasm=function(e){return Lt.Promise.resolve("")},Es.lwsproc=function(e,t){try{e=Wt.parse(e)}catch(r){return void(t.fFun&&t.fFun(r))}"GetBuffer"==e.method?t.sFun&&e.result.length>0?t.sFun(e.result[0],t.params):t.sFun("",t.params):t.sFun&&t.sFun(e)},Es.lsexp=function(e,t,r){var n,o=t;if(3==(n=(o=Wt.replaceAll(o,"/","-")).split("-")).length){var i=n[0],a=n[1],s=n[2];a.length<2&&(a=(a="00"+a).substr(a.length-2)),s.length<2&&(s=(s="00"+s).substr(s.length-2)),o=[i,a,s].join("-")}var u=[o,"T23:59:59.999Z"].join("");Fs(e).set_minExpiredTime(u),Fs(e).set_maxExpiredTime(u)},Es.lunload=Is(_s().mark((function Su(){return _s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Es.lavrf__unload();case 2:As=0,Cs=Wt.nil,Ws={},Ls=!1,Ps=!1,Ds=!1,Os=!1,xs=!1,Es.lclex(),Es.bLTSOnline=!0,Es.axInstance=Wt.nil,Es.lOnUpdateDWObj=[];case 14:case"end":return e.stop()}}),Su)}))),Es.lcexp=function(e,t){return Fs(e).get_ltsInstance(Bs).caret().then((function(){return!1}),(function(e){var t=Es.licenseException,r="";return e instanceof Error||"message"in e?r=e.message:Wt.isString(e)&&(r=e),Es.lsetException(Gs.Expired,r,!1),Os||(Os=!0,Wt.error(r),xt.OnLTSLicenseError&&xt.OnLTSLicenseError(ea.getPublicLicenseContent(t.message),t.code)),!0}))},Es.OnLicenseException=function(){var e=Es.licenseException,t=e.message;if(Wt.isString(t)&&(t.indexOf("Error Code")>-1?t=Wt.replaceAll(t,"Error Code","error code"):t.indexOf("Error code")>-1&&(t=Wt.replaceAll(t,"Error code","error code"))),t.indexOf("(https://www.dynamsoft.com/purchase-center/)")>-1&&(t=t.replace("(https://www.dynamsoft.com/purchase-center/)","(https://www.dynamsoft.com/store/dynamic-web-twain/)"),e.message=t),t.indexOf("error code:")>-1){var r=t.substr(0,t.indexOf("message")),n=t.substr(t.indexOf("message"));r.indexOf("{")>-1&&(r=r.substr(r.indexOf("{")+1)),n.indexOf("}")>-1&&(n=n.substr(0,n.indexOf("}"))),r=Wt.replaceAll(r,"error code:",""),n=Wt.replaceAll(n,"message: ",""),Es.lsetException(parseInt(r),n,!0),Wt.error(n),xt.OnLTSLicenseError&&xt.OnLTSLicenseError(ea.getPublicLicenseContent(t),e.code)}else{if(!e.code){var o=Ys(t);Es.lsetException(o,t,!0)}if(Wt.error(e.message),e.code==Gs.LtsJsLoadError)return;xt.OnLTSLicenseError&&xt.OnLTSLicenseError(ea.getPublicLicenseContent(e.message),e.code)}},Es.lol=function(){return Es.bLTSOnline},Es.OnFirstOffline=function(e){Es.bLTSOnline=!1},Es.lpubdlg=function(e,t){if(Wt.isString(e)&&""!=e){if(e=Wt.atob(e),console&&console.warn&&!Ds&&nr.bUseDynamsoftLicenseManager,1==t)return Ds||nr.bUseDynamsoftLicenseManager||(Ds=!0,xt.OnLTSPublicLicenseWarning&&xt.OnLTSPublicLicenseWarning(ea.getPublicLicenseContent(e))),!0;2==t&&(Ds||(Ds=!0))}return!1},Es.lcheckLic=function(e,t,r){var n=!1;if(t){if(Wt.isArray(t.Detail)&&t.Detail.length>0){var o=t.Detail[0].ExpireDate;return Es.lsexp(e,o,r),Es.lcexp(e,r).then((function(e){var r=!1;e?r=!0:1!=t.Trial&&2!=t.Trial||(r=Es.lpubdlg(t.Message,t.Trial)),r||Es.bLTSOnline||xs||(xs=!0,xt.OnLTSConnectionWarning&&xt.OnLTSConnectionWarning())}))}1!=t.Trial&&2!=t.Trial||(n=Es.lpubdlg(t.Message,t.Trial))}return n||Es.bLTSOnline||xs||(xs=!0,xt.OnLTSConnectionWarning&&xt.OnLTSConnectionWarning()),Lt.Promise.resolve()},Es.lisValidID=function(e){if(Wt.isString(e)&&""!=e)return!0;var t,r=Es.licenseException;return Es.lsetException(Gs.UUIDError,"Failed to generate an ID for your device to license it: not enough permission.",!0),Wt.error(r.message),t=r.message,xt.OnLTSLicenseError&&xt.OnLTSLicenseError(t,r.code),!1},Es.lsetException=function(e,t,r){var n=Es.licenseException;n.code=e,n.message=t,r?n.fromLTS=!0:r in n&&delete n.fromLTS},Es.lgcuid=function(e){var t=xt.DWT.li({instanceMode:e},"");return t?Lt.Promise.resolve(t):Fs(e).get_ltsInstance(Bs).u().then((function(e){return xt.DWT.lsmid(e,""),xt.DWT.lsmid2b(e),e}))},(Us=Js.prototype).getSWebTwain=function(){return this._objectWebTwain},Us.getInstance=function(){return!!this._objectWebTwain&&this},Us._createControl=function(){var e,t,r=this,n=r._strWidth,o=r._strHeight;if(Lt.isString(n)&&(n=n.indexOf("%")>0?"100%":parseInt(n)+2+"px"),Lt.isString(o)&&(o=o.indexOf("%")>0?"100%":parseInt(o)+2+"px"),t=['<div id="',r._strDWTInnerContainerID,'" style="width:',n,";height:",o,'">'],K.bIE)xt.DWT.ActiveXInstallWithCAB?t.push('<object id="',r._strObjectName,'" style="width:',r._strWidth,";height:",r._strHeight,';border:1px solid #AAAAAA"',' codebase="',K.bWin64?nr.getActiveXCABx64Path():nr.getActiveXCABx86Path(),"#version=",Yt.ActiveXVersion,'"',' classid="clsid:',nr.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>"):t.push('<object id="',r._strObjectName,'" style="width:',r._strWidth,";height:",r._strHeight,';border:1px solid #AAAAAA"',' classid="clsid:',nr.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>");else{var i=r._strWidth;Lt.isString(i)&&-1==i.indexOf("%")&&(i=parseInt(i)-2+"px"),t.push('<embed id="',r._strObjectName,'" style="display: inline; width:',i,";height:",r._strHeight,'" type="',nr.strMIMEType,'"',' pluginspage="',K.bWin?nr.getMSIPath():nr.getPKGPath(),'"></embed>')}t.push('</div><div id="',r._strDWTNonInstallInnerContainerID,'" style="width: ',n,';display:none"></div>'),(e=r._containerElement)&&(e.innerHTML=t.join("")),r._objectWebTwain=Lt.get(r._strObjectName)},Us._createNonAllowedDivPlugin=function(){var e=this,t=Lt.get(e._strDWTNonInstallInnerContainerID);if(""==t.innerHTML){var r=e._strHeight;Lt.isString(r)&&-1==r.indexOf("%")&&(r=parseInt(r)-10+"px");var n=['<div style="display: block; border:1px solid black; width:',e._strWidth,";height:",r,'">','<div style="margin: 200px 0 0 0; padding: 5px; font-size: 16px;line-height: 30px; ">',"<div>The Component is not allowed to run on this site.</div>",'<div>Please click <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJeSURBVDhPvZRNSxthEMeX0mNpKS09tP04tdBqobT9WCGJ5kU9pIk5xB4KaoJGmoiNMS+IUiqNB08mjUoUN2vU3WyS9d+ZIbvEZREP0j8Mk5ln5sfs7jxRcM/6f8BKpYKZmRlEIhGUSiUYhjE8uV2eQIal0xmobQ3aeQc/CwWUy+Xh6e3yBM7OzuJMbcPs9cUYzNPeRQLc29tDKpVCOBx2LJ3JQDe66Jo9fI3HEY1GnTOurdVqAnBLgFxwcNBAp3N5w0yTJiTTtA5UVXPy9XpDerwkwOnpaZydtWma/p3s8OgYcZraSwIMhULoXFx6NntZvf4XyWRSAG45QO38wrO51x/Asq7F27nbJMBEIoFm8wiLS0uYm0s6j88QfXUF6ucJXNMe2lAWx+qXD3I+KgHu7OwgEAjI/q2vr2N5eUUaebIWwRovFLTG38AaQtlzLPlP4wKyJcB8Pi83IpfLoVqtYmFh0ZnQ0nU0qHn/uSJ+0G7fiPl8VAL0+/20cyZdsTLm57+hdXIqQAdKE+1T869nCnZfK+I5dsNYAgwGg7i8MhwIG8cbG0Wafo1+X6FPk5VfPUDxqSK+r6oCcEuAU1NT0GhhDQLZVtwsIZvNShFPuDX+FqtPFORfPhS/9X5M8m4JkO/pyakKo0uwof3e/SMF3FQg2PfHCgoEMWlS9nbshgqQt755eIwr3RTYOV+vRlMK1j5OIPlIwY93YxgM39mAIBxzns9HJcDt7W3EYjH5OD6fD5OTk7KbrDo99go12TBbDOV8Peuxh5Zl0Z8ATUdFOjWy55jztt1VArw/Af8A9+n0bhYJ0I4AAAAASUVORK5CYII="/>','at the right end of the address bar and click "<b>Always allow plug-ins</b>". Then refresh/restart the browser.</div>',"</div></div>"].join("");t.innerHTML=n;for(var o=window.document,i=0;i<o.links.length;i++)"DWT_CloseNonAllowedDiv"==o.links[i].className&&(o.links[i].onclick=a)}function a(){Lt.get(e._strDWTNonInstallInnerContainerID).style.display="none",Lt.get(e._strDWTInnerContainerID).style.display="inline"}},Us.__unload=Us.dispose=function(){var e,t=this;if(t._containerElement)e=t._containerElement;else{var r=t._containerID;r&&(e=Lt.get(r))}if(e)for(;e.firstChild;)e.removeChild(e.firstChild);this._containerElement=null,delete xt.DWT.ContainerMap[t._containerID],delete xt.DWT.WebTwainIdMap[t._id]},Us._getErrorString=function(){return this._errorString},Lt.detect._controlDetect=function(){var e=Lt.detect.arySTwains,t=e[0],r=t&&t._objectWebTwain;if(r){var n,o=!1;if(K.bIE)n=!xt.navInfo.bOSx64||xt.navInfo.bWOW64?"DynamicPdfCore_"+Yt.ActiveXPdfVersion+".dll":"DynamicPdfCorex64_"+Yt.ActiveXPdfVersion+".dll",0==r.ErrorCode&&""!=r.GetAddOnVersion("pdf",n)&&(o=!0);else 0==r.ErrorCode&&(o=!0);if(o){clearInterval(Lt.detect._varSeed);var i=function(t,r,n){var o,i;for(o=0;o<e.length;o++)i=e[o],Lt.attachProperty(i),Lt.attachMethod(i),i._attachEvents(),Lt.detect.ssl&&(i.IfSSL=!0,i.HTTPPort=443),0==t?i.GetLicenseInfo(r).then((function(e){e&&i._setConvertMode(i._pdfConvertMode)})):(i._blts=!0,""!=r&&""!=n?(i.SetLTSInfo(r,n),i.GetLicenseInfo().then((function(e){return e&&i._setConvertMode(i._pdfConvertMode),xt.DWT.lcheckLic(xt.DWT.EnumInstance.dwt_desktop,e,"")}))):i.__licenseInfo={LTS:!0,Detail:[]},xt.DWT.laddDWTObj(i)),Lt.attachAddon(i),i._objectWebTwain.BrokerProcessType=nr._iBrokerProcessType,K.bWin||(i._objectWebTwain.ImageCaptureDriverType=nr._iImageCaptureDriverType),Lt.isFunction(i.__OnAxReady)&&i.__OnAxReady()};if(Zr()){var a=xt.DWT.li({instanceMode:xt.DWT.EnumInstance.dwt_desktop,axInstance:r},"");if(!xt.DWT.lisValidID(a))return void i(1,"","");Hs(xt.DWT.EnumInstance.dwt_desktop,"").then((function(e){i(1,e.ar,e.cu)}),(function(e){e&&(xt.DWT.lsetException(e.code||e.ltsErrorCode,e.message,!0),xt.DWT.OnLicenseException()),i(1,"","")}))}else i(0,xt.DWT.ProductKey,"")}else Lt.detect.bNoControlEvent||(Lt.noControl(t),Lt.detect.bNoControlEvent=!0),Lt.isFunction(t.__OnAxNotInstalled)&&t.__OnAxNotInstalled()}else clearInterval(Lt.detect._varSeed)},Lt.ie={},Lt.ie.DynamicWebTwain=function(e){var t=new Js(e);return t._createControl(),Lt.detect.arySTwains.push(t),t},Lt.ie.closeAll=function(){var e,t,r,n=Lt.detect.arySTwains;for(e=0;e<n.length;e++)(t=n[e])&&t._objectWebTwain&&(r=t._objectWebTwain)&&0==r.ErrorCode&&r.RemoveAllImages();Lt.detect.arySTwains=[]},Lt.closeAll=Lt.ie.closeAll,xt.DWT.RemoveAllAuthorizations=function(){return!1},xt.DWT.GetWebTwain=xt.DWT.GetWebTwainEx=function(e){var t=e,r=xt.DWT.WebTwainIdMap;if(!t){var n=Object.keys(r);return n.length>0?r[t=n[0]]:void 0}if(t in r)return r[t];var o=xt.DWT.ContainerMap;return t in o?o[t]:void 0};var $s=!1;function eu(e,t){return tu.apply(this,arguments)}function tu(){var e;return e=Qs().mark((function t(e,r){var n,o;return Qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r&&Wi(Pi),t.next=3,ea.preParseProductKey(r);case 3:if(!nr.bUseDynamsoftLicenseManager){t.next=6;break}return t.next=6,ea.initLicenseFromDynamsoftCore();case 6:if(0==(n=xt.DWT.licenseException).code){t.next=10;break}throw e&&na(n),{code:n.code,message:n.message};case 10:if($s){t.next=18;break}if(o=!1,K.bIE&&(o=K.IEVersion<=7),o||!Zr()){t.next=18;break}if(xt.DWT.IfLoadResources){t.next=17;break}return $s=!0,t.abrupt("return");case 17:return t.abrupt("return",new Lt.Promise((function(e,t){var r=xt.DWT.ResourcesPath,n="";!K.bFileSystem&&xt.DWT.IfResourcesAddTimestamp&&(n=Lt.timestamp),Wt.addScript([r,"/src/dynamsoft.lts.js",n].join(""),!0,!1,(function(r){if(xt.LTS&&xt.LTS._)return $s=!0,void e();if(r){if(K.bIE)return void t({code:-2822,message:"The WebTwain JavaScript lts.js load failed."});if("error"==r.type)return void t({code:-2822,message:"The WebTwain JavaScript lts.js load failed."})}$s=!0,e()}))})));case 18:case"end":return t.stop()}}),t)})),tu=function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Zs(i,n,o,a,s,"next",e)}function s(e){Zs(i,n,o,a,s,"throw",e)}a(void 0)}))},tu.apply(this,arguments)}function ru(e){return ru="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ru(e)}function nu(){nu=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof T?t:T,a=Object.create(i.prototype),s=new L(n||[]);return o(a,"_invoke",{value:C(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",d="suspendedYield",p="executing",g="completed",m={};function T(){}function v(){}function y(){}var b={};c(b,a,(function(){return this}));var S=Object.getPrototypeOf,_=S&&S(S(D([])));_&&_!==r&&n.call(_,a)&&(b=_);var w=y.prototype=T.prototype=Object.create(b);function I(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(o,i,a,s){var u=f(e[o],e,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==ru(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function C(t,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var c=f(t,r,n);if("normal"===c.type){if(o=n.done?g:d,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=g,n.method="throw",n.arg=c.arg)}}}function A(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function W(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(W,this),this.reset(!0)}function D(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(ru(t)+" is not iterable")}return v.prototype=y,o(w,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:v,configurable:!0}),v.displayName=c(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},I(E.prototype),c(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},I(w),c(w,u,"Generator"),c(w,a,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function o(){for(;r.length;){var e=r.pop();if(e in t)return o.value=e,o.done=!1,o}return o.done=!0,o}},t.values=D,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:D(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function ou(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function iu(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){ou(i,n,o,a,s,"next",e)}function s(e){ou(i,n,o,a,s,"throw",e)}a(void 0)}))}}var au,su=window;su.console=su.console||((au={}).log=au.warn=au.debug=au.info=au.error=au.time=au.dir=au.profile=au.clear=au.exception=au.trace=au.assert=function(){},au),xt.DWT.OnBeforeUnload=function(e){Lt.page.bUnload=!0,xt.DWT.Unload(e)},su.addEventListener("beforeunload",(function(e){if(Lt.isFunction(xt.DWT.OnBeforeUnload))return xt.DWT.OnBeforeUnload(e)}));var uu,cu,lu=function(e){var t=e.VersionInfo;if(!Lt.detect.bNeedUpgradeEvent&&!function(e){if(Wt.isUndefined(e))return ir;var t,r,n=ar(e.toString().toLowerCase());t=nr.bActiveXEdition?Yt.ActiveXVersion:nr.getServerVersionInfo(!0),r=(t=Wt.replaceAll(String(t),"[.]",",")).split(",");for(var o=n.length>r.length?n.length:r.length,i=0;i<o;i++){if(null==n[i]&&(n[i]=0),null==r[i]&&(r[i]=0),parseInt(n[i])<parseInt(r[i]))return ir;if(parseInt(n[i])>parseInt(r[i]))return or}return or}(t)){if(Lt.detect.bNeedUpgradeEvent=ur,Lt.isFunction(xt.DWT.OnWebTwainNeedUpgrade)&&xt.DWT.OnWebTwainNeedUpgrade())return;var r=e._containerElement;r&&(Lt.one(r).before(Lt.install._strNonInstallDIV),Lt.show(Lt.install._divDWTNonInstallContainerID),Lt.hide(r)),""!=Lt.install._divDWTemessageContainer&&Lt.hide(Lt.install._divDWTemessageContainer),function(e,t){if(Lt.isFunction(xt.OnWebTwainNeedUpgradeCallback)){var r,n,o={};K.bWin&&(n=K.bIE||Lt.product.bHTML5Edition?Qt.getDSPath():Lt.product.getMSIPath(),r=zt.enumWindow),o["default"]=n;var i=Lt.one(".dynamsoft-dialog-license");i&&i.getEL()&&(i.getEL().style.display="none"),Lt.detect.needUpgrade=ur,xt.OnWebTwainNeedUpgradeCallback(Lt.product.name,o,Lt.product.bHTML5Edition,r,K.bIE,K.bSafari,Lt.detect.ssl,Ta.strIEVersion,Lt.detect.bPromptJSOrServerOutdated,e,t)}}()}};function fu(e){var t=!0,r="";e.__licenseInfo&&(t=e.__licenseInfo.bTrial,e.__licenseInfo.ExpireDate&&(r=e.__licenseInfo.ExpireDate));var n=function(e){if(""==e)return 65536;var t=ta(e),r=(new Date).getTime(),n=(t.getTime()-r)/864e5;return t.getTime()<r?0:Math.ceil(n)}(r);n<=0&&(t||Xt(e._getErrorString()),Wt.isFunction(xt.OnLicenseExpiredWarning)&&xt.OnLicenseExpiredWarning(r,n,t))}function hu(){var e,t,r,n,o,i=xt.DWT.Containers,a=xt.DWT.licenseException;if(i&&i.length>0){for(0==a.code?su.DCP_DWT_OnClickCloseInstall&&su.DCP_DWT_OnClickCloseInstall(!1,!0):Lt.error(a.message),t=0;t<i.length;t++)if(i[t].Container?n=i[t].Container:i[t].ContainerId&&(n=Lt.get(i[t].ContainerId)),zs(n)&&n.id){if(o=xt.DWT.ContainerMap[n.id])break;if(r=i[t].WebTwainId,o=xt.DWT.WebTwainIdMap[r])break}o&&lu(o)}var s=!1,u=!1;for(Zr()&&Lt.isNumber(a.code)&&0!==a.code&&!0===a.fromLTS&&(s=!0),t=0;t<i.length;t++)r=i[t].ContainerId,(e=xt.DWT.ContainerMap[r])||(r=i[t].WebTwainId,e=xt.DWT.WebTwainIdMap[r]),e&&(s?Lt.hide(e._containerElement):(e.IfAllowLocalCache=!0,e.IfShowFileDialog=!0,e.IfDisableSourceAfterAcquire=!0,e.BrokerProcessType=Lt.product._iBrokerProcessType,0==t&&e.__licenseInfo&&(ea.checkProductKey(e,{Core:!0})||K.bWin&&ea.checkProductKey(e,{Webcam:!0},!0)||(u?Lt.hide(e._containerElement):ea.checkProductKey(e,{Core:!0},!1)||(Lt.hide(e._containerElement),o=e,u=!0))))),e=null;i=null,u&&(o._errorCode==en.LicenseExpired?fu(o):oa(o)),s?(xt.DWT.WebTwainIdMap={},xt.DWT.ContainerMap={},Lt.detect.arySTwains.splice(0)):setTimeout((function(){try{Lt.isFunction(xt.DWT.OnWebTwainReady)?xt.DWT.OnWebTwainReady():Lt.isFunction(su.Dynamsoft_OnReady)&&su.Dynamsoft_OnReady()}catch(e){Xt(e)}}),100)}function du(e,t,r){var n,o,i,a,s,u={id:e.WebTwainId,width:e.Width,height:e.Height};if(e.ContainerId?(u.container=Lt.get(e.ContainerId),u.containerId=e.ContainerId):e.Container&&(u.container=e.Container,u.containerId=e.Container.id),(""==(n=u.id)||!Wt.isString(n)&&!Wt.isNumber(n)?sr:ur)||(u.id=["dwt_",Wt.getRandom()].join("")),function(e){var t=e||{};t.basePath&&(Ta.basePath=t.basePath),t.pathType&&(Ta.pathType=t.pathType),Wt.isUndefined(t.bDiscardBlankImage)||(Ta.bDiscardBlankImage=t.bDiscardBlankImage),t.msgPrefix&&t.msgPrefix,t.msgSuffix&&t.msgSuffix,t.detectType&&(Lt.detect.detectType=t.detectType),t.tryTimes&&(Lt.detect.tryTimes=t.tryTimes);var r=xt.DWT.RemoteScanConfig;r||(r={sessionTimeout:300,keepAwake:!0},xt.DWT.RemoteScanConfig=r),r.keepAwake===undefined&&(r.keepAwake=!0)}(u),u.onAxReady=function(){if(xt.DWT.ContainerMap[u.containerId]=o.getInstance(),xt.DWT.WebTwainIdMap[u.id]=o.getInstance(),Lt.isFunction(t)){var e={stwain:o.getInstance(),bError:!1};t(e)}},u.onAxNotInstalled=function(){var e={};!function(e){tn(e,-2800,Qr.ErrStr_Service_NOT_INSTALLED)}(e),Lt.isFunction(r)&&r({code:e._errorCode,message:e._errorString})},o=new Lt.ie.DynamicWebTwain(u),a=0,s=xt.DWT.Containers)for(i=s.length-1;i>=0;i--){var c=s[i];c.Container?zs(c.Container)&&a++:c.ContainerId&&zs(Lt.get(c.ContainerId))&&a++}return Lt.detect.arySTwains.length==a&&(Lt.detect._varSeed=setInterval(Lt.detect._controlDetect,200)),o}function pu(){if(!Lt.detect.axAutoLoadDone){var e,t=xt.DWT.Containers;if(t)for(e=0;e<t.length;e++){var r=void 0;if(zs(Lt.get(t[e].ContainerId))&&(r=t[e].ContainerId),r)if(!xt.DWT.ContainerMap[r])return void setTimeout(pu,200)}t=null,hu(),Lt.detect.axAutoLoadDone=!0,uu()}}xt.DWT._innerLoad=iu(nu().mark((function _u(){var e,t,r,n;return nu().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return Lt.page.bUnload=sr,o.next=3,eu(!0,!1);case 3:if(e=xt.DWT.Containers,t=ur,e&&0!==e.length){o.next=7;break}return Lt.log("Dynamsoft.DWT.Containers was not set."),o.abrupt("return",sr);case 7:for(r=0;r<e.length;r++)n=e[r],!Lt.isString(n.WebTwainId)||Lt.isString(n.ContainerId)&&""!=n.ContainerId||(n.ContainerId=n.WebTwainId),a=void 0,s=void 0,(i=n).ContainerId?a=i.ContainerId:i.Container&&(a=i.Container.id),(zs(Lt.get(a))?((s=xt.DWT.ContainerMap[a])||Lt.isString(i.WebTwainId)&&(s=xt.DWT.WebTwainIdMap[i.WebTwainId]),s?sr:ur):sr)&&du(n,(function(){}),(function(e){t&&(ra(e),t=!1),cu(e),Lt.detect.axAutoLoadDone=!0}));return o.abrupt("return",Lt.detect.axAutoLoadDone?Lt.Promise.resolve():new Lt.Promise((function(e,t){uu=e,cu=t,setTimeout(pu,200)})));case 9:case"end":return o.stop()}var i,a,s}),_u)})));var gu=xt.DWT.ShowMessage;xt.DWT.ShowMessage=function(e,t){var r=gu(e,t),n=document.createElement("iframe");n.frameborder="0",n.marginheight="0",n.marginwidth="0",n.style.border="0",n.style.backgroundColor="transparent",n.style.position="absolute",n.style.left=0,n.style.top=0,n.style.width="100%",n.style.height=document.body.clientHeight+"px",n.style.margin="0 auto",n.style.zIndex="10000",n.src=["javas","cript:",'""'].join("");var o=xt.Lib.one(".dynamsoft-backdrop");if(o&&o.length>0){for(var i=o[0];i.firstChild;)i.removeChild(i.firstChild);i.style.zIndex="10000",i.appendChild(n)}return r}}({});
